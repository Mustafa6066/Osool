<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أصول - Osool | منصة عقارية ذكية مع مستشار AI في مصر</title>

    <!-- SEO Meta Tags -->
    <meta name="description"
        content="ابحث عن عقارك المثالي في مصر مع مستشار عقاري ذكي AI. شقق، فيلا، تاون هاوس في التجمع الخامس، القاهرة الجديدة. استشارات فورية، بحث ذكي، أسعار حقيقية من المطورين.">
    <meta name="keywords"
        content="عقارات مصر, شقق للبيع التجمع الخامس, فيلا القاهرة الجديدة, مستشار عقاري AI, أصول العقارية, Osool Real Estate, New Cairo apartments, 5th Settlement villas">
    <meta name="author" content="Osool Real Estate Platform">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Arabic">
    <meta name="revisit-after" content="7 days">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://osool.com">
    <meta property="og:title" content="أصول - Osool | منصة عقارية ذكية مع مستشار AI">
    <meta property="og:description"
        content="ابحث عن عقارك المثالي في مصر مع مستشار عقاري ذكي. شقق، فيلا، تاون هاوس بأفضل الأسعار من المطورين الكبار.">
    <meta property="og:image" content="https://osool.com/og-image.jpg">
    <meta property="og:locale" content="ar_EG">
    <meta property="og:locale:alternate" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://osool.com">
    <meta name="twitter:title" content="أصول - Osool | منصة عقارية ذكية">
    <meta name="twitter:description" content="ابحث عن عقارك المثالي في مصر مع مستشار عقاري ذكي AI">
    <meta name="twitter:image" content="https://osool.com/twitter-image.jpg">

    <!-- Mobile Web App -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="أصول Osool">
    <meta name="theme-color" content="#059669">

    <!-- Schema.org Markup -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "RealEstateAgent",
        "name": "أصول - Osool Real Estate",
        "description": "AI-powered real estate platform in Egypt",
        "url": "https://osool.com",
        "logo": "https://osool.com/logo.png",
        "sameAs": [
            "https://facebook.com/osool",
            "https://instagram.com/osool",
            "https://linkedin.com/company/osool"
        ],
        "contactPoint": {
            "@type": "ContactPoint",
            "telephone": "+20-xxx-xxx-xxxx",
            "contactType": "Customer Service",
            "areaServed": "EG",
            "availableLanguage": ["Arabic", "English"]
        },
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://osool.com/search?q={search_term}",
            "query-input": "required name=search_term"
        }
    }
    </script>
    <!-- Favicon - Osool Brand Icon -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23059669'/%3E%3Cstop offset='100%25' style='stop-color:%230d9488'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='14' fill='url(%23grad)'/%3E%3Cpath d='M32 12L12 28v24h16V38h8v14h16V28L32 12z' fill='white' opacity='0.95'/%3E%3Ccircle cx='32' cy='28' r='6' fill='url(%23grad)'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23059669'/%3E%3Cstop offset='100%25' style='stop-color:%230d9488'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='14' fill='url(%23grad)'/%3E%3Cpath d='M32 12L12 28v24h16V38h8v14h16V28L32 12z' fill='white' opacity='0.95'/%3E%3Ccircle cx='32' cy='28' r='6' fill='url(%23grad)'/%3E%3C/svg%3E">

    <!-- Premium Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900&family=Inter:wght@100;200;300;400;500;600;700;800;900&family=Amiri:ital,wght@0,400;0,700&display=swap"
        rel="stylesheet">

    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- Font Awesome Icons (Professional) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Google Analytics 4 -->
    <!-- Replace G-XXXXXXXXXX with your actual GA4 Measurement ID -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        // Initialize GA4
        gtag('config', 'G-XXXXXXXXXX', {
            'send_page_view': true,
            'page_title': 'Osool Real Estate Platform',
            'page_location': window.location.href,
            'user_properties': {
                'platform': 'web',
                'language': 'ar'
            }
        });

        // Track initial page load
        gtag('event', 'page_view', {
            'page_title': 'Osool Platform',
            'page_location': window.location.href
        });

        console.log('✅ Google Analytics 4 initialized');
    </script>

    <!-- Chart.js for ROI Visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Unsplash API for high-quality property images -->


    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Premium Font Families */
            --font-display: 'Inter', 'Amiri', sans-serif;
            /* Cosmic Minimal */
            --font-body: 'Inter', 'Amiri', system-ui, sans-serif;
            --font-accent: 'Playfair Display', 'Amiri', serif;

            /* Cosmic Smart Classy Palette */
            --primary: #0F172A;
            /* Smart Deep Navy */
            --secondary: #d4af37;
            /* Electric Gold */
            --background: #F8FAFC;
            /* Porcelain White */
            --surface: rgba(255, 255, 255, 0.65);

            /* Smart Gradients */
            --gradient-aurora: linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 50%, #F1F5F9 100%);
            --gradient-glass: linear-gradient(120deg, rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0.2) 100%);
            --gradient-border: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0.95) 100%);

            /* Enhanced Glass & Effects */
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border-color: rgba(255, 255, 255, 0.6);
            --glass-shadow: 0 20px 50px 0 rgba(15, 23, 42, 0.1);
            --glass-highlight: rgba(255, 255, 255, 0.9);
            --blur: blur(50px);

            /* Organic Shapes */
            --radius-sm: 20px;
            --radius-md: 40px;
            /* Large Organic Curve */
            --radius-lg: 60px;
            /* Capsule */
            --radius-xl: 100px;
            /* Full Circle */

            /* Gradients */
            --gradient-primary: linear-gradient(135deg, #2C3E50 0%, #1a1a1a 100%);
            --gradient-gold: linear-gradient(135deg, #D4C5B0 0%, #C4B5A0 100%);
            --gradient-soft: linear-gradient(180deg, #E6DED6 0%, #F5F1ED 100%);

            /* Layout */
            --sidebar-width: 420px;
            /* Slightly wider for modern feel */
            --header-height: 90px;

            /* Transition */
            --transition: all 0.6s cubic-bezier(0.22, 1, 0.36, 1);
            /* Elegant easing */
            --transition-bounce: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* Dark Mode - Cosmic Deep */
        [data-theme="dark"] {
            --primary: #F5F1ED;
            --secondary: #D4C5B0;
            --background: #1a1a1a;
            --surface: #2d2d2d;

            --text-primary: #F5F5F5;
            --text-secondary: #B0B0B0;
            --text-muted: #666666;

            --glass-bg: rgba(20, 20, 20, 0.6);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-shadow: 0 15px 40px 0 rgba(0, 0, 0, 0.4);

            --gradient-primary: linear-gradient(135deg, #FDFBF7 0%, #E0E0E0 100%);
            --gradient-soft: linear-gradient(180deg, #121212 0%, #1E1E1E 100%);
        }

        /* Language Direction Support */
        [dir="ltr"] {
            text-align: left;
        }

        [dir="ltr"] .hero-content {
            animation: slideInLeft 0.8s ease-out;
        }

        [dir="ltr"] .floating-panel {
            animation: slideInRight 0.8s ease-out;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Advanced Liquid Glass Animations */
        @keyframes liquidRotate {
            0% {
                transform: rotate(0deg) scale(1);
                filter: blur(0px) hue-rotate(0deg);
            }

            25% {
                transform: rotate(90deg) scale(1.1);
                filter: blur(2px) hue-rotate(90deg);
            }

            50% {
                transform: rotate(180deg) scale(1);
                filter: blur(0px) hue-rotate(180deg);
            }

            75% {
                transform: rotate(270deg) scale(1.1);
                filter: blur(2px) hue-rotate(270deg);
            }

            100% {
                transform: rotate(360deg) scale(1);
                filter: blur(0px) hue-rotate(360deg);
            }
        }

        @keyframes shimmer {

            0%,
            100% {
                transform: translateX(-100%);
                opacity: 0;
            }

            50% {
                transform: translateX(100%);
                opacity: 1;
            }
        }

        @keyframes blobFloat {

            0%,
            100% {
                transform: translateY(0px) rotate(0deg) scale(1);
                border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
            }

            25% {
                transform: translateY(-20px) rotate(90deg) scale(1.1);
                border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%;
            }

            50% {
                transform: translateY(-10px) rotate(180deg) scale(1);
                border-radius: 50% 60% 30% 60% / 60% 40% 60% 30%;
            }

            75% {
                transform: translateY(-30px) rotate(270deg) scale(1.1);
                border-radius: 60% 30% 70% 40% / 30% 70% 40% 60%;
            }
        }

        /* Global Styles with Liquid Glass Background */
        /* Cosmic Typography */
        /* Cosmic Typography */
        body {
            font-family: var(--font-body);
            color: var(--primary);
            background-color: var(--background);
            transition: var(--transition);
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
            font-weight: 400;
            line-height: 1.7;
            letter-spacing: -0.01em;
            transition: var(--transition-smooth);
            display: grid;
            grid-template-columns: 1fr var(--sidebar-width);
            gap: 0;
            margin: 0;
            padding: 0;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: var(--font-display);
            font-weight: 800;
            letter-spacing: -0.04em;
            line-height: 1.1;
            margin-bottom: 0.5em;
        }

        h1 {
            font-size: clamp(3rem, 5vw, 6rem);
            background: var(--gradient-primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Large Number Accents */
        .display-number {
            font-family: var(--font-display);
            font-size: 10rem;
            font-weight: 900;
            line-height: 0.8;
            opacity: 0.05;
            position: absolute;
            z-index: -1;
            pointer-events: none;
            color: var(--primary);
        }

        /* Main Content Area */
        main.content-area {
            height: 100vh;
            overflow-y: auto;
            position: relative;
            z-index: 10;
            padding-right: 20px;
            /* Space for scrollbar */
        }

        /* AI Sidebar - Persistent & Premium */
        /* AI Sidebar - Persistent & Premium */
        aside.ai-sidebar {
            height: 100vh;
            background: rgba(255, 255, 255, 0.3);
            /* Slightly more opaque for readability */
            -webkit-backdrop-filter: blur(50px);
            backdrop-filter: blur(50px);
            border-left: 1px solid var(--glass-border-color);
            position: sticky;
            top: 0;
            width: var(--sidebar-width);
            z-index: 100;
            display: flex;
            flex-direction: column;
            box-shadow: -10px 0 50px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
        }

        /* Responsive Adjustments for Mobile */
        @media (max-width: 1024px) {
            body {
                grid-template-columns: 1fr;
                /* Single column on mobile */
            }

            aside.ai-sidebar {
                /* Revert to fixed for mobile drawer behavior */
                position: fixed;
                top: 0;
                right: 0;
                transform: translateX(100%);
                /* Hide by default */
                width: 100%;
                max-width: 450px;
                background: var(--surface);
            }

            aside.ai-sidebar.active {
                transform: translateX(0);
            }

            main.content-area {
                padding-right: 0;
            }
        }

        /* Advanced Liquid Glass Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                linear-gradient(135deg,
                    rgba(255, 255, 255, 0.9) 0%,
                    rgba(245, 242, 237, 0.85) 100%),
                url('https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            opacity: 0.25;
            animation: architecturalShift 40s ease-in-out infinite;
            pointer-events: none;
            z-index: -3;
        }

        /* Animated Liquid Blobs */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 80%, rgba(60, 69, 88, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(245, 242, 237, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(60, 69, 88, 0.08) 0%, transparent 50%);
            animation: var(--blob-float);
            pointer-events: none;
            z-index: -2;
        }

        /* Additional Liquid Blob Layers */
        .liquid-blob-1,
        .liquid-blob-2,
        .liquid-blob-3 {
            position: fixed;
            pointer-events: none;
            z-index: -1;
            opacity: 0.6;
        }

        .liquid-blob-1 {
            top: 10%;
            left: 10%;
            width: 200px;
            height: 200px;
            background: var(--gradient-liquid);
            animation: var(--blob-float), var(--liquid-rotation);
            filter: blur(40px);
        }

        .liquid-blob-2 {
            top: 60%;
            right: 15%;
            width: 300px;
            height: 300px;
            background: linear-gradient(45deg,
                    rgba(245, 242, 237, 0.2) 0%,
                    rgba(60, 69, 88, 0.1) 50%,
                    rgba(245, 242, 237, 0.2) 100%);
            animation: var(--blob-float) 18s ease-in-out infinite reverse,
                var(--liquid-rotation) 25s linear infinite reverse;
            filter: blur(50px);
        }

        .liquid-blob-3 {
            bottom: 20%;
            left: 50%;
            transform: translateX(-50%);
            width: 250px;
            height: 250px;
            background: radial-gradient(circle,
                    rgba(60, 69, 88, 0.1) 0%,
                    rgba(245, 242, 237, 0.2) 50%,
                    transparent 100%);
            animation: var(--blob-float) 22s ease-in-out infinite,
                var(--liquid-rotation) 30s linear infinite;
            filter: blur(45px);
        }

        @keyframes architecturalShift {

            0%,
            100% {
                transform: translateX(0) translateY(0) scale(1.02);
                opacity: 0.3;
            }

            25% {
                transform: translateX(-2px) translateY(-1px) scale(1.025);
                opacity: 0.25;
            }

            50% {
                transform: translateX(1px) translateY(2px) scale(1.03);
                opacity: 0.35;
            }

            75% {
                transform: translateX(2px) translateY(-1px) scale(1.02);
                opacity: 0.28;
            }
        }

        @keyframes blueprintFloat {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.6;
            }

            50% {
                transform: translateY(-5px) rotate(0.5deg);
                opacity: 0.8;
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes pulse-glow {

            0%,
            100% {
                box-shadow: 0 0 20px rgba(224, 192, 151, 0.2);
            }

            50% {
                box-shadow: 0 0 40px rgba(224, 192, 151, 0.5);
            }
        }

        /* Advanced Liquid Glass Card Component */
        .glass-card {
            background: var(--glass-bg);
            -webkit-backdrop-filter: var(--blur);
            backdrop-filter: var(--blur);
            border: 1px solid var(--glass-border-color);
            border-radius: var(--radius-md);
            box-shadow:
                var(--glass-shadow),
                inset 0 0 0 1px var(--glass-highlight);
            transition: var(--transition-bounce);
            position: relative;
            overflow: hidden;
        }

        /* Iridescent Border Shimmer */
        .glass-card::before {
            content: '';
            position: absolute;
            inset: -1px;
            z-index: -1;
            background: var(--gradient-border);
            border-radius: inherit;
            opacity: 0.5;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            -webkit-mask-composite: xor;
            pointer-events: none;
        }

        /* Hover Float Effect */
        .glass-card:hover {
            transform: translateY(-8px) scale(1.01);
            background: rgba(255, 255, 255, 0.15);
            box-shadow:
                0 30px 60px rgba(0, 0, 0, 0.12),
                inset 0 0 0 1px rgba(255, 255, 255, 0.6),
                0 0 40px rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.8);
        }

        /* Floating Capsule Navigation */
        /* Smart Header Redesign */
        .navigation {
            position: sticky;
            top: 20px;
            z-index: 1000;
            margin: 0 auto;
            padding: 10px 24px;
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 100px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.05);
            max-width: 1200px;
            width: calc(100% - 40px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(0);
        }

        .navigation.nav-hidden {
            transform: translateY(-150%);
        }

        .navigation.nav-scrolled {
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            padding: 8px 24px;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .nav-menu {
            display: flex;
            gap: 6px;
            background: rgba(0, 0, 0, 0.04);
            padding: 4px;
            border-radius: 100px;
            margin: 0 16px;
        }

        @media (max-width: 900px) {
            .nav-menu {
                display: none;
            }

            .mobile-toggle {
                display: block !important;
            }
        }

        .nav-item {
            background: transparent;
            border: none;
            padding: 10px 24px;
            border-radius: 100px;
            font-family: var(--font-body);
            font-weight: 500;
            font-size: 15px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-item:hover {
            color: var(--navy-primary);
            background: rgba(255, 255, 255, 0.6);
        }

        .nav-item.active {
            background: white;
            color: var(--navy-primary);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            font-weight: 600;
        }

        .logo-wrapper {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            cursor: pointer;
        }

        .logo-icon {
            width: 42px;
            height: 42px;
            background: var(--gradient-premium);
            border-radius: 14px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 22px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .logo-text {
            font-family: var(--font-display);
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
            letter-spacing: -0.02em;
        }

        .nav-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theme-toggle,
        .language-toggle {
            height: 42px;
            border-radius: 100px;
            border: 1px solid rgba(0, 0, 0, 0.08);
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
            font-weight: 500;
        }

        .theme-toggle {
            width: 42px;
        }

        .language-toggle {
            padding: 0 20px;
        }

        .theme-toggle:hover,
        .language-toggle:hover {
            background: var(--background-beige);
            transform: translateY(-2px);
            border-color: rgba(0, 0, 0, 0.15);
        }

        .btn-glass {
            background: var(--primary);
            color: white;
            border: none;
            height: 42px;
            padding: 0 28px;
            border-radius: 100px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-glass:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        /* Language Toggle */
        .language-toggle {
            padding: 8px 16px;
            background: rgba(60, 69, 88, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .language-toggle:hover {
            background: var(--glass-beige);
            color: var(--text-primary);
        }

        @keyframes logoFloat {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        .logo-text {
            font-family: var(--font-display);
            font-size: 22px;
            font-weight: 700;
            background: var(--gradient-premium);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.02em;
        }

        .nav-menu {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .nav-item {
            padding: 10px 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 12px;
            transition: var(--transition-smooth);
            font-family: var(--font-body);
            font-size: 15px;
            font-weight: 500;
            position: relative;
            letter-spacing: -0.01em;
        }

        .nav-item:hover {
            color: var(--text-primary);
            background: var(--glass-beige);
        }

        .nav-item.active {
            color: var(--navy-primary);
            background: rgba(60, 69, 88, 0.1);
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 20%;
            right: 20%;
            height: 2px;
            background: var(--gradient-premium);
            border-radius: 2px;
        }

        /* Hero Section with Floating Panel */
        .hero-section {
            padding: 120px 40px 60px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            position: relative;
        }

        .hero-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
        }

        .hero-content {
            animation: slideInRight 0.8s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(60, 69, 88, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            margin-bottom: 24px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .hero-badge i {
            color: var(--success);
            font-size: 18px;
            animation: sparkle 1.5s infinite;
        }

        @keyframes sparkle {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.2);
                opacity: 0.7;
            }
        }

        .badge-dot {
            display: none;
            /* Hide the old dot */
        }

        .hero-title {
            font-family: var(--font-display);
            font-size: 64px;
            /* Larger for impact */
            font-weight: 700;
            margin-bottom: 24px;
            line-height: 1.1;
            letter-spacing: -0.03em;
        }

        .gradient-text {
            background: var(--gradient-navy-beige);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-description {
            font-family: var(--font-accent);
            font-size: 19px;
            color: var(--text-secondary);
            line-height: 1.65;
            margin-bottom: 32px;
            letter-spacing: -0.005em;
        }

        .cta-group {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 32px;
        }

        /* Trust Bar Styles */
        .trust-bar {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 24px 0;
            padding: 20px;
            background: rgba(60, 69, 88, 0.05);
            border-radius: 16px;
            border: 1px solid var(--glass-border);
        }

        .trust-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .trust-icon {
            color: var(--success);
            font-size: 18px;
        }

        /* Humor Quotes Styles */
        .humor-quotes {
            margin-top: 32px;
            padding: 20px;
            background: rgba(245, 242, 237, 0.1);
            border-radius: 16px;
            border-left: 4px solid var(--navy-primary);
        }

        .quote-text {
            font-style: italic;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-size: 16px;
        }

        .quote-author {
            font-size: 14px;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Enhanced button animations */
        @keyframes blink {

            0%,
            50% {
                opacity: 1;
            }

            51%,
            100% {
                opacity: 0.3;
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        /* Property card enhancements */
        .property-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-liquid);
            opacity: 0;
            transition: var(--transition-liquid);
            z-index: -1;
        }

        .property-card:hover::before {
            opacity: 0.1;
        }

        /* AI Chat Panel - Minimal & Soft */
        .ai-chat-panel {
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 380px;
            /* Slightly narrower for elegance */
            height: 600px;
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            box-shadow:
                0 10px 40px var(--glass-shadow),
                0 0 0 1px rgba(255, 255, 255, 0.1);
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: slideUpFade 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 9999;
            /* Ensure on top */
        }

        .ai-chat-panel.active {
            display: flex;
        }

        @keyframes slideUpFade {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.98);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .btn {
            padding: 16px 32px;
            border-radius: var(--radius-lg);
            /* Capsule */
            font-family: var(--font-body);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-bounce);
            border: none;
            font-size: 16px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            letter-spacing: -0.01em;
            position: relative;
            overflow: hidden;
        }

        /* Button Shimmer */
        .btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transform: translateX(-100%);
            transition: 0.5s;
        }

        .btn:hover::after {
            transform: translateX(100%);
        }

        .btn-primary {
            background: var(--gradient-premium);
            color: var(--beige-light);
            box-shadow: 0 10px 30px rgba(44, 62, 80, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 15px 40px rgba(44, 62, 80, 0.4);
        }

        .btn-glass {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .btn-glass:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.8);
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        /* Floating Search Panel */
        .floating-panel {
            animation: slideInLeft 0.8s ease-out;
            position: relative;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(30px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .search-panel {
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(30px);
            backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 20px 60px var(--glass-shadow);
            position: relative;
            overflow: hidden;
        }

        .search-panel::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(60, 69, 88, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .search-tabs {
            display: flex;
            gap: 4px;
            background: rgba(60, 69, 88, 0.2);
            padding: 4px;
            border-radius: 12px;
            margin-bottom: 24px;
            position: relative;
            z-index: 1;
        }

        .search-tab {
            flex: 1;
            padding: 10px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 8px;
            transition: var(--transition-smooth);
            font-weight: 500;
        }

        .search-tab.active {
            background: var(--glass-beige);
            color: var(--text-primary);
            box-shadow: 0 2px 10px rgba(60, 69, 88, 0.1);
        }

        .search-fields {
            display: flex;
            flex-direction: column;
            gap: 16px;
            position: relative;
            z-index: 1;
        }

        .input-group {
            position: relative;
        }

        .input-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 20px;
        }

        .input-field {
            width: 100%;
            padding: 14px 44px 14px 16px;
            background: rgba(60, 69, 88, 0.1);
            border: 1px solid transparent;
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 15px;
            transition: var(--transition-smooth);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--navy-primary);
            background: rgba(60, 69, 88, 0.15);
            box-shadow: 0 0 0 3px rgba(60, 69, 88, 0.1);
        }

        .input-field::placeholder {
            color: var(--text-muted);
        }

        .search-button {
            width: 100%;
            margin-top: 16px;
        }

        .filter-chips {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 16px;
        }

        .chip {
            padding: 6px 12px;
            background: rgba(60, 69, 88, 0.1);
            border: 1px solid rgba(60, 69, 88, 0.3);
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .chip:hover {
            background: rgba(60, 69, 88, 0.2);
            transform: scale(1.05);
        }

        .chip.active {
            background: var(--gradient-premium);
            color: var(--beige-light);
            border-color: transparent;
        }

        /* Stats Section */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--navy-primary);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Advanced AI Orb with Liquid Effects */
        .ai-orb {
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 80px;
            height: 80px;
            background: var(--gradient-premium);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow:
                0 8px 25px var(--glass-shadow),
                0 0 20px rgba(60, 69, 88, 0.2);
            transition: var(--transition-liquid);
            z-index: 999;
            border: 2px solid var(--glass-highlight);
            font-size: 32px;
            color: var(--beige-light);
            overflow: hidden;
        }

        /* Orb ripple effects */
        .ai-orb::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--gradient-premium);
            border-radius: 50%;
            animation: orbPulse 2s infinite;
            opacity: 0.3;
            z-index: -1;
        }

        .ai-orb::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg,
                    transparent 30%,
                    rgba(255, 255, 255, 0.3) 50%,
                    transparent 70%);
            border-radius: 50%;
            animation: var(--shimmer-effect);
            z-index: 1;
        }

        .ai-orb:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow:
                0 12px 35px var(--glass-shadow),
                0 0 30px rgba(60, 69, 88, 0.3);
        }

        @keyframes orbPulse {
            0% {
                transform: scale(1);
                opacity: 0.3;
            }

            50% {
                transform: scale(1.3);
                opacity: 0.1;
            }

            100% {
                transform: scale(1.6);
                opacity: 0;
            }
        }

        /* AI Chat Panel - Expanded Orb */
        .ai-chat-panel {
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 420px;
            height: 600px;
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(35px);
            backdrop-filter: blur(35px);
            border: 1px solid var(--glass-border);
            border-radius: 28px;
            box-shadow:
                0 25px 70px var(--glass-shadow),
                inset 0 0 0 1px var(--glass-highlight);
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: orbExpand 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 998;
        }

        .ai-chat-panel.active {
            display: flex;
        }

        @keyframes orbExpand {
            0% {
                width: 80px;
                height: 80px;
                border-radius: 50%;
                opacity: 0.5;
            }

            50% {
                width: 200px;
                height: 200px;
                border-radius: 30%;
                opacity: 0.7;
            }

            100% {
                width: 420px;
                height: 600px;
                border-radius: 28px;
                opacity: 1;
            }
        }

        /* Property Cards Grid */
        .properties-section {
            padding: 80px 40px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .section-subtitle {
            color: var(--accent-tan);
            font-family: var(--font-body);
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 16px;
        }

        .section-title {
            font-family: var(--font-display);
            font-size: 48px;
            /* Larger section titles */
            font-weight: 700;
            margin-bottom: 16px;
            letter-spacing: -0.02em;
            line-height: 1.2;
        }

        .section-description {
            font-family: var(--font-accent);
            color: var(--text-secondary);
            font-size: 18px;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
            letter-spacing: -0.005em;
        }

        .properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
        }

        /* Enhanced Property Cards with Unsplash Images */
        .property-card {
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            overflow: hidden;
            transition: var(--transition-liquid);
            cursor: pointer;
            position: relative;
        }

        .property-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow:
                0 25px 70px var(--glass-shadow),
                0 0 20px rgba(60, 69, 88, 0.1);
        }

        .property-image {
            height: 240px;
            position: relative;
            overflow: hidden;
        }

        .property-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }

        .property-card:hover .property-image img {
            transform: scale(1.05);
        }

        .property-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg,
                    transparent 0%,
                    rgba(0, 0, 0, 0.1) 50%,
                    rgba(0, 0, 0, 0.7) 100%);
            z-index: 1;
        }

        .property-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            padding: 8px 16px;
            background: var(--gradient-premium);
            color: var(--beige-light);
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(60, 69, 88, 0.3);
            z-index: 2;
        }

        .roi-badge {
            position: absolute;
            bottom: 16px;
            left: 16px;
            padding: 6px 12px;
            background: var(--success);
            color: white;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
        }

        .property-content {
            padding: 24px;
            position: relative;
        }

        .property-title {
            font-family: var(--font-display);
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: -0.01em;
            line-height: 1.3;
        }

        .property-location {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .property-features {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-muted);
            font-size: 14px;
        }

        .property-price {
            font-size: 26px;
            font-weight: 700;
            color: var(--navy-primary);
            margin-bottom: 4px;
        }

        .property-monthly {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Property Image Sources - Handled by JS now */

        /* Chat Window (Refined) */
        .chat-window {
            position: fixed;
            bottom: 100px;
            /* Raised slightly */
            left: 30px;
            width: 380px;
            /* Slightly narrower */
            height: 550px;
            /* Slightly shorter */
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(30px);
            backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            box-shadow: 0 20px 60px var(--glass-shadow);
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: slideUp 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px) scale(0.95);
                opacity: 0;
            }

            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .chat-window.active {
            display: flex;
        }

        .chat-header {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            padding: 20px;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-avatar {
            width: 44px;
            height: 44px;
            background: var(--gradient-premium);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: var(--beige-light);
        }

        .chat-info {
            flex: 1;
            margin: 0 16px;
        }

        .chat-name {
            font-family: var(--font-display);
            font-weight: 600;
            margin-bottom: 4px;
            letter-spacing: -0.01em;
        }

        .chat-status {
            font-family: var(--font-body);
            font-size: 12px;
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 6px;
            letter-spacing: 0.02em;
        }

        .status-indicator {
            width: 6px;
            height: 6px;
            background: var(--success);
            border-radius: 50%;
            animation: blink 2s infinite;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .settings-btn {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-smooth);
            margin-right: 8px;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .ai-settings-panel {
            padding: 20px;
            background: var(--glass-beige);
            border-bottom: 1px solid var(--glass-border);
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .api-key-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            background: var(--background-light);
            color: var(--text-primary);
            font-size: 14px;
            font-family: monospace;
        }

        .api-key-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .message {
            animation: messageSlide 0.3s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-ai {
            align-self: flex-start;
            max-width: 80%;
        }

        .message-user {
            align-self: flex-end;
            max-width: 80%;
        }

        .message-bubble {
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .message-ai .message-bubble {
            background: rgba(230, 221, 212, 0.15);
            border: 1px solid var(--glass-border);
            border-bottom-right-radius: 4px;
            text-align: right;
            direction: rtl;
        }

        .message-user .message-bubble {
            background: var(--gradient-premium);
            color: var(--beige-light);
            border-bottom-left-radius: 4px;
        }

        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--text-muted);
            border-radius: 50%;
            animation: typingAnimation 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {

            0%,
            60%,
            100% {
                transform: translateY(0);
                opacity: 0.5;
            }

            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        .chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--glass-border);
            display: flex;
            gap: 12px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            background: rgba(60, 69, 88, 0.1);
            border: 1px solid transparent;
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 14px;
            transition: var(--transition-smooth);
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--navy-primary);
            background: rgba(60, 69, 88, 0.15);
        }

        .send-btn {
            width: 44px;
            height: 44px;
            background: var(--gradient-premium);
            border: none;
            border-radius: 12px;
            color: var(--beige-light);
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .send-btn:hover {
            transform: scale(1.1);
        }

        /* Quick Action Buttons */
        .quick-actions {
            padding: 16px 20px;
            border-top: 1px solid var(--glass-border);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .quick-btn {
            padding: 8px 12px;
            background: rgba(60, 69, 88, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            color: var(--text-primary);
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-family: var(--font-body);
        }

        .quick-btn:hover {
            background: var(--gradient-premium);
            color: var(--beige-light);
            transform: scale(1.05);
        }

        /* Visual Agent: Chat Property Carousel */
        .chat-carousel {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding: 12px 4px;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            margin: 8px 0;
        }

        .chat-carousel::-webkit-scrollbar {
            display: none;
        }

        .chat-property-card {
            flex: 0 0 200px;
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            scroll-snap-align: start;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.06);
        }

        .chat-property-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .chat-card-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
            background: linear-gradient(135deg, #f0f0f0 0%, #e0e0e0 100%);
        }

        .chat-card-body {
            padding: 12px;
        }

        .chat-card-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .chat-card-price {
            font-size: 15px;
            font-weight: 700;
            color: var(--navy-primary);
            margin-bottom: 8px;
        }

        .chat-card-meta {
            display: flex;
            gap: 8px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .chat-card-actions {
            display: flex;
            gap: 6px;
            margin-top: 10px;
        }

        .chat-card-btn {
            flex: 1;
            padding: 8px 10px;
            font-size: 11px;
            font-weight: 600;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chat-card-btn.primary {
            background: var(--primary);
            color: white;
        }

        .chat-card-btn.primary:hover {
            opacity: 0.9;
        }

        .chat-card-btn.secondary {
            background: rgba(0, 0, 0, 0.05);
            color: var(--text-primary);
        }

        .chat-card-btn.secondary:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        /* Visual Agent: Thinking Badge */
        .thinking-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: linear-gradient(135deg, rgba(60, 69, 88, 0.08) 0%, rgba(60, 69, 88, 0.04) 100%);
            border-radius: 100px;
            font-size: 13px;
            color: var(--text-secondary);
            animation: pulse-thinking 1.5s ease-in-out infinite;
            margin-bottom: 8px;
        }

        .thinking-badge .dot {
            width: 8px;
            height: 8px;
            background: var(--navy-primary);
            border-radius: 50%;
            animation: dot-pulse 1s ease-in-out infinite;
        }

        @keyframes pulse-thinking {

            0%,
            100% {
                opacity: 0.7;
            }

            50% {
                opacity: 1;
            }
        }

        @keyframes dot-pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.3);
            }
        }

        /* Phase 3: Action Taker - Comparison Table */
        .comparison-table-wrapper {
            overflow-x: auto;
            margin: 12px 0;
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.08);
            background: white;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .comparison-table th {
            background: var(--primary);
            color: white;
            padding: 12px 16px;
            text-align: center;
            font-weight: 600;
        }

        .comparison-table th:first-child {
            text-align: right;
            background: rgba(0, 0, 0, 0.04);
            color: var(--text-primary);
        }

        .comparison-table td {
            padding: 10px 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
            text-align: center;
        }

        .comparison-table td:first-child {
            text-align: right;
            font-weight: 600;
            color: var(--text-secondary);
            background: rgba(0, 0, 0, 0.02);
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        .comparison-table .highlight {
            background: rgba(212, 175, 55, 0.1);
            color: var(--navy-primary);
            font-weight: 700;
        }

        /* Phase 3: Schedule Modal */
        .schedule-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .schedule-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .schedule-modal {
            background: white;
            border-radius: 20px;
            max-width: 450px;
            width: 90%;
            padding: 32px;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        .schedule-modal-overlay.active .schedule-modal {
            transform: scale(1);
        }

        .schedule-modal h3 {
            font-size: 20px;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .schedule-modal p {
            color: var(--text-secondary);
            margin-bottom: 24px;
        }

        .schedule-form-group {
            margin-bottom: 16px;
        }

        .schedule-form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .schedule-form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            font-size: 15px;
        }

        .schedule-form-group input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .schedule-btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .schedule-btn {
            flex: 1;
            padding: 14px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .schedule-btn.primary {
            background: var(--primary);
            color: white;
        }

        .schedule-btn.secondary {
            background: rgba(0, 0, 0, 0.05);
            color: var(--text-primary);
        }

        /* Phase 3: Inquiry Draft Card */
        .inquiry-card {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            border-radius: 16px;
            padding: 20px;
            margin: 12px 0;
            color: white;
        }

        .inquiry-card h4 {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .inquiry-card .message-preview {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 14px;
            font-size: 13px;
            line-height: 1.6;
            margin-bottom: 16px;
            white-space: pre-wrap;
        }

        .inquiry-card .action-btns {
            display: flex;
            gap: 10px;
        }

        .inquiry-card .action-btn {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
        }

        .inquiry-card .action-btn.whatsapp {
            background: white;
            color: #25D366;
        }

        .inquiry-card .action-btn.copy {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* ROI Visualization Section */
        .roi-section {
            padding: 100px 40px;
            background: var(--gradient-beige);
            position: relative;
            overflow: hidden;
        }

        .roi-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
        }

        .roi-content {
            z-index: 2;
            position: relative;
        }

        .roi-title {
            font-family: var(--font-display);
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 24px;
            background: var(--gradient-navy-beige);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .roi-description {
            font-size: 18px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 32px;
        }

        /* ROI Calculator */
        .roi-calculator {
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(25px);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 32px;
            margin-bottom: 32px;
        }

        .calc-input {
            width: 100%;
            padding: 16px;
            background: rgba(60, 69, 88, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 16px;
            margin-bottom: 16px;
            transition: var(--transition-smooth);
        }

        .calc-input:focus {
            outline: none;
            border-color: var(--navy-primary);
            box-shadow: 0 0 0 3px rgba(60, 69, 88, 0.1);
        }

        .calc-result {
            background: var(--gradient-premium);
            color: var(--beige-light);
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            font-size: 24px;
            font-weight: 700;
            margin-top: 20px;
        }

        /* Chart Container */
        .chart-container {
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(25px);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 32px;
            position: relative;
            overflow: hidden;
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-liquid);
            opacity: 0.1;
            animation: var(--liquid-rotation);
        }

        .chart-wrapper {
            position: relative;
            z-index: 2;
            height: 400px;
        }

        /* Chart Controls */
        .chart-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            justify-content: center;
        }

        .chart-btn {
            padding: 8px 16px;
            background: rgba(60, 69, 88, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .chart-btn.active {
            background: var(--gradient-premium);
            color: var(--beige-light);
        }

        .quick-stats {
            padding: 60px 40px;
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
        }

        .stat-card {
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: var(--transition-smooth);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(60, 69, 88, 0.2);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, rgba(60, 69, 88, 0.2) 0%, rgba(60, 69, 88, 0.1) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .stat-info {
            flex: 1;
        }

        .stat-number {
            font-family: var(--font-display);
            font-size: 30px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
            letter-spacing: -0.02em;
        }

        .stat-desc {
            font-family: var(--font-body);
            font-size: 13px;
            color: var(--text-secondary);
            letter-spacing: 0.01em;
        }

        .stat-trend {
            font-family: var(--font-body);
            color: var(--success);
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            font-weight: 500;
            letter-spacing: 0.02em;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .navigation {
                top: 10px;
                width: calc(100% - 40px);
                padding: 12px 20px;
            }

            .hero-container {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .hero-title {
                font-size: 36px;
                line-height: 1.2;
            }

            .floating-panel {
                margin-top: 40px;
            }

            .chat-window {
                width: calc(100% - 60px);
                right: 30px;
                left: 30px;
            }

            .properties-grid {
                grid-template-columns: 1fr;
            }

            .quick-stats {
                grid-template-columns: 1fr;
            }

            .stats-row {
                grid-template-columns: 1fr;
                gap: 12px;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(212, 175, 55, 0.3);
            border-radius: 8px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(212, 175, 55, 0.5);
        }

        /* Selection Color */
        ::selection {
            background: rgba(212, 175, 55, 0.3);
            color: var(--text-primary);
        }

        /* Features Section Styles */
        .features-section {
            padding: 80px 40px;
            background: var(--background-light);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 32px;
            max-width: 1400px;
            margin: 0 auto;
            margin-top: 60px;
        }

        .feature-card {
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 40px 32px;
            text-align: center;
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-premium);
            transform: scaleX(0);
            transition: var(--transition-smooth);
        }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(60, 69, 88, 0.25);
        }

        .feature-card:hover::before {
            transform: scaleX(1);
        }

        .feature-icon {
            font-size: 48px;
            margin-bottom: 24px;
        }

        .feature-title {
            font-family: var(--font-display);
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .feature-description {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .feature-stats {
            display: flex;
            gap: 16px;
            justify-content: center;
        }

        .feature-stat {
            background: rgba(60, 69, 88, 0.1);
            color: var(--navy-primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        /* Market Insights Styles */
        .market-insights {
            padding: 80px 40px;
            background: var(--background-beige);
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 32px;
            max-width: 1200px;
            margin: 60px auto 0;
        }

        .insight-card {
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 32px;
            transition: var(--transition-smooth);
        }

        .insight-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(60, 69, 88, 0.2);
        }

        .insight-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .insight-header h3 {
            font-family: var(--font-display);
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .trend-up {
            background: var(--success);
            color: white;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
        }

        .price-range {
            font-size: 24px;
            font-weight: 700;
            color: var(--navy-primary);
            margin-bottom: 24px;
        }

        .insight-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .insight-stats .stat-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-muted);
        }

        .stat-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .trend-positive {
            color: var(--success) !important;
        }

        /* Services Section Styles */
        .services-section {
            padding: 80px 40px;
            background: var(--background-light);
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 32px;
            max-width: 1200px;
            margin: 60px auto 0;
        }

        .service-item {
            display: flex;
            gap: 24px;
            padding: 32px;
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            transition: var(--transition-smooth);
        }

        .service-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(60, 69, 88, 0.2);
        }

        .service-icon {
            font-size: 32px;
            min-width: 50px;
        }

        .service-content h3 {
            font-family: var(--font-display);
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .service-content p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Testimonials Section Styles */
        .testimonials-section {
            padding: 80px 40px;
            background: var(--background-beige);
        }

        .testimonials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 32px;
            max-width: 1200px;
            margin: 60px auto 0;
        }

        .testimonial-card {
            background: var(--glass-beige);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 32px;
            transition: var(--transition-smooth);
            position: relative;
        }

        .testimonial-card::before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 20px;
            font-size: 60px;
            color: var(--navy-primary);
            opacity: 0.2;
            font-family: var(--font-display);
        }

        .testimonial-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(60, 69, 88, 0.2);
        }

        .testimonial-rating {
            margin-bottom: 20px;
            font-size: 20px;
        }

        .testimonial-text {
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 24px;
            font-style: italic;
        }

        .testimonial-author {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .author-avatar {
            width: 50px;
            height: 50px;
            background: var(--gradient-premium);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .author-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .author-title {
            font-size: 14px;
            color: var(--text-muted);
        }

        /* CTA Section Styles */
        .cta-section {
            padding: 100px 40px;
            background: var(--gradient-premium);
            color: white;
            text-align: center;
        }

        .cta-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .cta-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            margin-bottom: 24px;
            font-size: 14px;
        }

        .cta-title {
            font-family: var(--font-display);
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 24px;
            line-height: 1.2;
        }

        .cta-description {
            font-size: 20px;
            opacity: 0.9;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 40px;
        }

        .cta-buttons .btn {
            background: white;
            color: var(--navy-primary);
            border: none;
        }

        .cta-buttons .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .cta-features {
            display: flex;
            gap: 32px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .cta-feature {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .cta-feature .feature-icon {
            font-size: 20px;
        }

        /* Footer Styles */
        .footer {
            background: rgba(26, 26, 26, 0.9);
            /* Cosmic Dark */
            color: #dcd5cc;
            /* Cosmic Sand */
            padding: 60px 40px 40px;
            margin: 40px auto 40px;
            /* Floating Island */
            width: calc(100% - 60px);
            max-width: 1300px;
            border-radius: var(--radius-lg);
            backdrop-filter: blur(50px);
            -webkit-backdrop-filter: blur(50px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 60px;
            margin-bottom: 40px;
        }

        .footer-brand .logo-wrapper {
            margin-bottom: 24px;
        }

        .footer-brand .logo-icon {
            background: var(--beige-primary);
            color: var(--navy-primary);
        }

        .footer-brand .logo-text {
            color: var(--beige-light);
        }

        .footer-description {
            color: var(--beige-primary);
            line-height: 1.6;
            margin-bottom: 32px;
            opacity: 0.9;
        }

        .social-links {
            display: flex;
            gap: 16px;
        }

        .social-link {
            width: 50px;
            height: 50px;
            background: rgba(230, 221, 212, 0.1);
            border: 1px solid rgba(230, 221, 212, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            font-size: 20px;
            transition: var(--transition-smooth);
        }

        .social-link:hover {
            background: var(--beige-primary);
            color: var(--navy-primary);
            transform: translateY(-2px);
        }

        .footer-links {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 40px;
        }

        .footer-column h4 {
            font-family: var(--font-display);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--beige-light);
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 12px;
        }

        .footer-column ul li a {
            color: var(--beige-primary);
            text-decoration: none;
            transition: var(--transition-smooth);
            opacity: 0.8;
        }

        .footer-column ul li a:hover {
            opacity: 1;
            color: var(--beige-light);
        }

        .footer-bottom {
            border-top: 1px solid rgba(230, 221, 212, 0.2);
            padding: 32px 0;
        }

        .footer-bottom-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .footer-bottom-links {
            display: flex;
            gap: 24px;
        }

        .footer-bottom-links a {
            color: var(--beige-primary);
            text-decoration: none;
            font-size: 14px;
            opacity: 0.8;
            transition: var(--transition-smooth);
        }

        .footer-bottom-links a:hover {
            opacity: 1;
        }

        /* Enhanced Mobile Responsiveness */
        @media (max-width: 768px) {
            .hero-container {
                grid-template-columns: 1fr;
                gap: 40px;
                text-align: center;
            }

            .nav-menu {
                display: none;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }

            .services-grid {
                grid-template-columns: 1fr;
            }

            .testimonials-grid {
                grid-template-columns: 1fr;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .footer-links {
                grid-template-columns: repeat(2, 1fr);
                gap: 30px;
            }

            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }

            .cta-features {
                flex-direction: column;
                align-items: center;
            }

            .footer-bottom-content {
                flex-direction: column;
                text-align: center;
            }

            .service-item {
                flex-direction: column;
                text-align: center;
            }

            .insight-stats {
                grid-template-columns: 1fr;
            }

            .cta-title {
                font-size: 36px;
            }

            .section-title {
                font-size: 36px;
            }

            .hero-title {
                font-size: 48px;
            }
        }
    </style>
</head>

<body>
    <!-- Liquid Glass Blobs -->
    <div class="liquid-blob-1"></div>
    <div class="liquid-blob-2"></div>
    <div class="liquid-blob-3"></div>

    <!-- Premium Navigation -->
    <main class="content-area">
        <nav class="navigation">
            <div class="nav-container">
                <div class="logo-wrapper">
                    <div class="logo-icon">أ</div>
                    <div class="logo-text" data-translate="logo-text">Osool (أصول)</div>
                </div>
                <button class="mobile-toggle" onclick="toggleMobileSidebar()"
                    style="display: none; background: transparent; border: none; font-size: 24px; color: var(--primary);">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="nav-menu">
                    <button class="nav-item active" data-translate="home">الرئيسية</button>
                    <button class="nav-item" data-translate="properties">العقارات</button>
                    <button class="nav-item" data-translate="investment">الاستثمار</button>
                    <button class="nav-item" data-translate="analytics">التحليلات</button>
                    <button class="nav-item" data-translate="about">من نحن</button>
                </div>
                <div class="nav-controls">
                    <button class="theme-toggle" onclick="toggleTheme()" title="تبديل الوضع">
                        <i class="fas fa-moon" id="themeIcon"></i>
                    </button>
                    <button class="language-toggle" onclick="toggleLanguage()" id="langToggle">
                        English
                    </button>
                    <button class="btn btn-glass" data-translate="login">تسجيل الدخول</button>
                </div>
            </div>
        </nav>

        <!-- Hero Section with Floating Panel -->
        <section class="hero-section">
            <div class="hero-container">
                <div class="hero-content">
                    <div class="hero-badge">
                        <span class="badge-dot"></span>
                        <span>عمرو نشط الآن • +500 ألف عائلة مصرية سعيدة • شهادة حكومية</span>
                    </div>
                    <h1 class="hero-title">
                        أهلاً وسهلاً، أنا عمرو
                        <br>
                        <span class="gradient-text">خبيرك العقاري المصري الأول</span>
                    </h1>
                    <p class="hero-description">
                        "في مصر، العقار مش مجرد استثمار... ده تأمين للمستقبل وكرامة للعائلة" 😉<br>
                        15 سنة خبرة • 1000+ صفقة ناجحة • خبير معتمد في السوق المصري<br>
                        من التجمع الخامس للعاصمة الإدارية، ومن 6 أكتوبر لمدينتي... معايا هتلاقي البيت اللي يليق بيك<br>
                        <strong>مش بس هشوفلك عقار... هعملك consultation كامل مجاناً! 🤩</strong>
                    </p>

                    <!-- Enhanced Trust Indicators -->
                    <div class="trust-bar">
                        <div class="trust-item">
                            <span class="trust-icon"><i class="fas fa-trophy"></i></span>
                            <span>مرخص من الحكومة المصرية</span>
                        </div>
                        <div class="trust-item">
                            <span class="trust-icon"><i class="fas fa-shield-alt"></i></span>
                            <span>ضمان استرداد 30 يوم</span>
                        </div>
                        <div class="trust-item">
                            <span class="trust-icon"><i class="fas fa-check-circle"></i></span>
                            <span>1000+ عائلة سعيدة</span>
                        </div>
                        <div class="trust-item">
                            <span class="trust-icon"><i class="fas fa-chart-line"></i></span>
                            <span>عائد استثماري مضمون</span>
                        </div>
                    </div>

                    <div class="cta-group">
                        <button class="btn btn-primary" onclick="openChat()">
                            <i class="fas fa-comments"></i>
                            استشارة مجانية مع عمرو
                        </button>
                        <button class="btn btn-glass">
                            <i class="fab fa-whatsapp"></i>
                            واتساب: 01001234567
                        </button>
                    </div>

                    <!-- Enhanced Egyptian Wisdom -->
                    <div class="humor-quotes">
                        <p class="quote-text">"زي ما قال أبوي: 'اللي يشتري أرض يشتري كرامة!' وأنا هخليك تشتري بذكاء كمان
                            😉"
                        </p>
                        <p class="quote-author">- عمرو، مستشارك العقاري اللي بيفهم السوق والناس</p>
                    </div>
                </div>

                <!-- Floating Search Panel -->
                <div class="floating-panel">
                    <div class="search-panel">
                        <div class="search-tabs">
                            <button class="search-tab active" data-translate="buy">شراء</button>
                            <button class="search-tab" data-translate="rent">إيجار</button>
                            <button class="search-tab" data-translate="invest">استثمار</button>
                        </div>

                        <div class="search-fields">
                            <div class="input-group">
                                <input type="text" class="input-field" placeholder="ابحث عن موقع أو مشروع..."
                                    data-translate-placeholder="search-location">
                                <span class="input-icon"><i class="fas fa-map-marker-alt"></i></span>
                            </div>

                            <div class="input-group">
                                <input type="text" class="input-field" placeholder="نطاق السعر"
                                    data-translate-placeholder="price-range">
                                <span class="input-icon"><i class="fas fa-dollar-sign"></i></span>
                            </div>

                            <div class="input-group">
                                <input type="text" class="input-field" placeholder="نوع العقار"
                                    data-translate-placeholder="property-type">
                                <span class="input-icon"><i class="fas fa-envelope"></i></span>
                            </div>

                            <button class="btn btn-primary search-button" data-translate="advanced-search">
                                بحث متقدم بالذكاء الاصطناعي
                            </button>
                        </div>

                        <div class="filter-chips">
                            <span class="chip active" data-translate="chip-tagamo">التجمع الخامس</span>
                            <span class="chip" data-translate="chip-october">6 أكتوبر</span>
                            <span class="chip" data-translate="chip-new-capital">العاصمة الجديدة</span>
                            <span class="chip" data-translate="chip-madinaty">مدينتي</span>
                            <span class="chip" data-translate="chip-more">+12</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Stats -->
        <section class="quick-stats">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-building"></i></div>
                <div class="stat-info">
                    <div class="stat-number">15,642</div>
                    <div class="stat-desc" data-translate="stat-properties-egypt">عقار في مصر</div>
                    <div class="stat-trend" data-translate="stat-trend-yesterday">↑ 25% من امبارح</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">💰</div>
                <div class="stat-info">
                    <div class="stat-number">3.8 مليون</div>
                    <div class="stat-desc" data-translate="stat-avg-price">متوسط السعر (جنيه)</div>
                    <div class="stat-trend" data-translate="stat-trend-last-year">↑ 12% من السنة اللي فاتت</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                <div class="stat-info">
                    <div class="stat-number">15 ثانية</div>
                    <div class="stat-desc" data-translate="stat-amr-response">عمرو يرد عليك في</div>
                    <div class="stat-trend" data-translate="stat-fastest">الأسرع في مصر!</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-trophy"></i></div>
                <div class="stat-info">
                    <div class="stat-number">500+ ألف</div>
                    <div class="stat-desc" data-translate="stat-happy-families-count">عائلة مصرية سعيدة</div>
                    <div class="stat-trend" data-translate="stat-alhamdulillah">الحمد لله!</div>
                </div>
            </div>
        </section>

        <!-- ROI Visualization Section -->
        <section class="roi-section">
            <div class="roi-container">
                <div class="calculator-header">
                    <div>
                        <h2 class="section-title" style="text-align: right;" data-translate="roi-title">احسب عائد
                            استثمارك بالذكاء الاصطناعي</h2>
                        <p style="color: var(--text-secondary); margin-top: 8px;" data-translate="roi-desc">
                            أداة ذكية لحساب العائد المتوقع على الاستثمار العقاري مع تحليل شامل للسوق المصري
                        </p>
                    </div>
                </div>
                <div class="roi-calculator">
                    <h3 data-translate="calc-title">حاسبة العائد السريعة</h3>
                    <input type="number" class="calc-input" id="propertyPrice" placeholder="سعر العقار (جنيه مصري)"
                        data-translate-placeholder="property-price">
                    <input type="number" class="calc-input" id="monthlyRent" placeholder="الإيجار الشهري المتوقع"
                        data-translate-placeholder="monthly-rent">
                    <input type="number" class="calc-input" id="yearlyAppreciation" placeholder="نسبة الزيادة السنوية %"
                        data-translate-placeholder="yearly-appreciation" value="15">
                    <div class="calc-result" id="roiResult">
                        <span data-translate="enter-values">أدخل البيانات لحساب العائد</span>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-controls">
                        <button class="chart-btn active" onclick="showChart('growth')" data-translate="growth-chart">نمو
                            القيمة</button>
                        <button class="chart-btn" onclick="showChart('roi')" data-translate="roi-chart">العائد
                            السنوي</button>
                        <button class="chart-btn" onclick="showChart('comparison')"
                            data-translate="comparison-chart">مقارنة
                            المناطق</button>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="roiChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Properties Section -->
        <section class="properties-section">
            <div class="section-header">
                <div class="section-subtitle" data-translate="properties-subtitle">مختارة بعناية</div>
                <h2 class="section-title gradient-text" data-translate="properties-title">عقارات استثنائية</h2>
                <p class="section-description" data-translate="properties-desc">
                    اكتشف مجموعة مختارة من أفضل العقارات المتاحة،
                    محللة بواسطة الذكاء الاصطناعي لتناسب احتياجاتك
                </p>
            </div>

            <div id="propertyGrid" class="properties-grid">
                <!-- Properties will be loaded here dynamically by JS -->
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section">
            <div class="section-header">
                <div class="section-subtitle" data-translate="features-subtitle">ليه تختار عمرو؟</div>
                <h2 class="section-title gradient-text" data-translate="features-title">الخبرة المصرية الأصيلة +
                    التكنولوجيا المتطورة</h2>
                <p class="section-description" data-translate="features-desc">
                    مش مجرد موقع عقارات... ده مستشار شخصي فاهم السوق المصري وعارف احتياجاتك قبل ما تقولها
                </p>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">🤖</div>
                    <h3 class="feature-title" data-translate="feat-ai-title">ذكاء اصطناعي بطعم مصري</h3>
                    <p class="feature-description" data-translate="feat-ai-desc">
                        عمرو مش مجرد chatbot... ده AI متدرب على السوق المصري، فاهم الثقافة، وعارف إزاي يساعدك تاخد
                        القرار
                        الصح
                    </p>
                    <div class="feature-stats">
                        <span class="feature-stat" data-translate="feat-ai-stat1">خبرة 15 سنة</span>
                        <span class="feature-stat" data-translate="feat-ai-stat2">استجابة فورية</span>
                    </div>
                </div>

                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-chart-bar"></i></div>
                    <h3 class="feature-title" data-translate="feat-market-title">تحليل السوق المصري العميق</h3>
                    <p class="feature-description" data-translate="feat-market-desc">
                        بيانات حقيقية من التجمع والعاصمة و6 أكتوبر، مع توقعات دقيقة للأسعار وأحسن فرص الاستثمار
                    </p>
                    <div class="feature-stats">
                        <span class="feature-stat" data-translate="feat-market-stat1">20+ منطقة</span>
                        <span class="feature-stat" data-translate="feat-market-stat2">تحديث يومي</span>
                    </div>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">🚗</div>
                    <h3 class="feature-title" data-translate="feat-tours-title">جولات وزيارات مجانية</h3>
                    <p class="feature-description" data-translate="feat-tours-desc">
                        هوديك بنفسي لكل عقار، مع شرح كامل للمنطقة والخدمات. مش هتشتري حاجة من غير ما تشوفها بعينك
                    </p>
                    <div class="feature-stats">
                        <span class="feature-stat" data-translate="feat-tours-stat1">زيارات مجانية</span>
                        <span class="feature-stat" data-translate="feat-tours-stat2">مرونة في المواعيد</span>
                    </div>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">⚖️</div>
                    <h3 class="feature-title" data-translate="feat-legal-title">ضمانات وأمان قانوني كامل</h3>
                    <p class="feature-description" data-translate="feat-legal-desc">
                        كل عقار مفحوص قانونياً، أوراق كاملة، وضمان استرداد. شغل محامين متخصصين في العقارات
                    </p>
                    <div class="feature-stats">
                        <span class="feature-stat" data-translate="feat-legal-stat1">ضمان 30 يوم</span>
                        <span class="feature-stat" data-translate="feat-legal-stat2">فحص شامل</span>
                    </div>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">🏦</div>
                    <h3 class="feature-title" data-translate="feat-finance-title">استشارات مالية وتقسيط مريح</h3>
                    <p class="feature-description" data-translate="feat-finance-desc">
                        خطط دفع تناسب راتبك، تعامل مع أحسن البنوك، ونصايح استثمارية تخليك تكسب مش تخسر
                    </p>
                    <div class="feature-stats">
                        <span class="feature-stat" data-translate="feat-finance-stat1">تقسيط 10 سنين</span>
                        <span class="feature-stat" data-translate="feat-finance-stat2">أقل مقدم</span>
                    </div>
                </div>

                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-handshake"></i></div>
                    <h3 class="feature-title" data-translate="feat-service-title">خدمة شخصية أصيلة</h3>
                    <p class="feature-description" data-translate="feat-service-desc">
                        مش هتتعامل مع call center... هتتعامل مع عمرو شخصياً. رقم موبايله، واتساب، ومتابعة لحد التسليم
                    </p>
                    <div class="feature-stats">
                        <span class="feature-stat" data-translate="feat-service-stat1">خدمة شخصية</span>
                        <span class="feature-stat" data-translate="feat-service-stat2">متابعة كاملة</span>
                    </div>
                </div>
            </div>
            </div>

            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-mobile-alt"></i></div>
                <h3 class="feature-title" data-translate="feat-app-title">تطبيق ذكي متكامل</h3>
                <p class="feature-description" data-translate="feat-app-desc">
                    تطبيق محمول متطور بتقنيات الذكاء الاصطناعي للبحث والتصفح وإدارة الاستثمارات
                </p>
                <div class="feature-stats">
                    <span class="feature-stat" data-translate="feat-app-stat1">iOS & Android</span>
                    <span class="feature-stat" data-translate="feat-app-stat2">5★ تقييم</span>
                </div>
            </div>
            </div>
        </section>

        <!-- Market Insights Section -->
        <section class="market-insights">
            <div class="section-header">
                <div class="section-subtitle" data-translate="market-subtitle">رؤى السوق</div>
                <h2 class="section-title gradient-text" data-translate="market-title">تحليلات وتوقعات السوق العقاري</h2>
                <p class="section-description" data-translate="market-desc">
                    بيانات محدثة لحظياً من أكثر من 15 منطقة عقارية رئيسية في مصر
                </p>
            </div>

            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-header">
                        <h3 data-translate="loc-tagamo">التجمع الخامس</h3>
                        <span class="trend-up" data-translate="trend-tagamo">↗ +12%</span>
                    </div>
                    <div class="price-range" data-translate="price-tagamo">₤2.5M - ₤8.5M</div>
                    <div class="insight-stats">
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-avg-meter">متوسط المتر</span>
                            <span class="stat-value" data-translate="val-avg-meter-tagamo">₤15,500</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-demand">الطلب</span>
                            <span class="stat-value" data-translate="val-high">عالي جداً</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-forecast">التوقع</span>
                            <span class="stat-value trend-positive" data-translate="trend-up">صاعد</span>
                        </div>
                    </div>
                </div>

                <div class="insight-card">
                    <div class="insight-header">
                        <h3 data-translate="loc-capital">العاصمة الإدارية</h3>
                        <span class="trend-up" data-translate="trend-capital">↗ +18%</span>
                    </div>
                    <div class="price-range" data-translate="price-capital">₤1.8M - ₤6.2M</div>
                    <div class="insight-stats">
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-avg-meter">متوسط المتر</span>
                            <span class="stat-value" data-translate="val-avg-meter-capital">₤12,800</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-demand">الطلب</span>
                            <span class="stat-value" data-translate="val-medium">عالي</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-forecast">التوقع</span>
                            <span class="stat-value trend-positive" data-translate="trend-strong-up">صاعد قوي</span>
                        </div>
                    </div>
                </div>

                <div class="insight-card">
                    <div class="insight-header">
                        <h3 data-translate="loc-october">6 أكتوبر</h3>
                        <span class="trend-up" data-translate="trend-october">↗ +8%</span>
                    </div>
                    <div class="price-range" data-translate="price-october">₤3.2M - ₤12M</div>
                    <div class="insight-stats">
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-avg-meter">متوسط المتر</span>
                            <span class="stat-value" data-translate="val-avg-meter-october">₤18,200</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-demand">الطلب</span>
                            <span class="stat-value" data-translate="val-medium">متوسط</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label" data-translate="lbl-forecast">التوقع</span>
                            <span class="stat-value trend-positive" data-translate="trend-stable">مستقر</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section class="services-section">
            <div class="section-header">
                <div class="section-subtitle" data-translate="services-subtitle">خدماتنا المتكاملة</div>
                <h2 class="section-title gradient-text" data-translate="services-title">حلول عقارية شاملة</h2>
                <p class="section-description" data-translate="services-desc">
                    من البحث حتى التملك، نوفر لك كل ما تحتاجه في رحلتك العقارية
                </p>
            </div>

            <div class="services-grid">
                <div class="service-item">
                    <div class="service-icon"><i class="fas fa-search"></i></div>
                    <div class="service-content">
                        <h3 data-translate="serv-search">البحث الذكي</h3>
                        <p data-translate="serv-search-desc">خوارزميات متطورة تجد لك العقار المثالي من بين آلاف الخيارات
                        </p>
                    </div>
                </div>

                <div class="service-item">
                    <div class="service-icon"><i class="fas fa-clipboard-list"></i></div>
                    <div class="service-content">
                        <h3 data-translate="serv-eval">التقييم والفحص</h3>
                        <p data-translate="serv-eval-desc">تقييم دقيق للعقارات وفحص فني شامل قبل اتخاذ القرار</p>
                    </div>
                </div>

                <div class="service-item">
                    <div class="service-icon"><i class="fas fa-dollar-sign"></i></div>
                    <div class="service-content">
                        <h3 data-translate="serv-finance">التمويل والقروض</h3>
                        <p data-translate="serv-finance-desc">شراكات مع أفضل البنوك لتوفير حلول تمويلية مرنة</p>
                    </div>
                </div>

                <div class="service-item">
                    <div class="service-icon"><i class="fas fa-file-alt"></i></div>
                    <div class="service-content">
                        <h3 data-translate="serv-legal">الإجراءات القانونية</h3>
                        <p data-translate="serv-legal-desc">فريق قانوني متخصص لضمان سلامة كافة المعاملات</p>
                    </div>
                </div>

                <div class="service-item">
                    <div class="service-icon"><i class="fas fa-building"></i></div>
                    <div class="service-content">
                        <h3 data-translate="serv-manage">إدارة الممتلكات</h3>
                        <p data-translate="serv-manage-desc">خدمات ما بعد البيع وإدارة شاملة لاستثماراتك العقارية</p>
                    </div>
                </div>

                <div class="service-item">
                    <div class="service-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="service-content">
                        <h3 data-translate="serv-consult">استشارات الاستثمار</h3>
                        <p data-translate="serv-consult-desc">خبراء يساعدونك في بناء محفظة عقارية متنوعة ومربحة</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section class="testimonials-section">
            <div class="section-header">
                <div class="section-subtitle" data-translate="testi-subtitle">قصص نجاح حقيقية</div>
                <h2 class="section-title gradient-text" data-translate="testi-title">إيه اللي قاله العملاء عن عمرو؟</h2>
                <p class="section-description" data-translate="testi-desc">
                    مش كلام في الهوا... دي قصص حقيقية لناس حققوا أحلامهم معانا
                </p>
            </div>

            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text" data-translate="testi-1-text">
                        "والله ما صدقت! عمرو لاقيلي الشقة المثالية في التجمع في أقل من أسبوع. والراجل فاهم شغله أوي،
                        شرحلي
                        كل حاجة بالتفصيل ومش خلاني أشتري غلط. الدفع كمان اترتب على 8 سنين براحة! ربنا يبارك فيه"
                    </p>
                    <div class="testimonial-author">
                        <div class="author-avatar"><i class="fas fa-user-circle"></i></div>
                        <div class="author-info">
                            <div class="author-name" data-translate="testi-1-name">أحمد عبد الرحمن</div>
                            <div class="author-title" data-translate="testi-1-title">محاسب - شقة في التجمع الخامس</div>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text" data-translate="testi-2-text">
                        "أنا كنت خايفة أستثمر في العقار بس عمرو طمني وعرفني إزاي السوق شغال. اشتريت 3 شقق في العاصمة من
                        سنة
                        ونص ودلوقتي بيدولي إيجار 35 ألف في الشهر! وسعرهم زاد 40% كمان. مش مصدقة إني كسبت كده!"
                    </p>
                    <div class="testimonial-author">
                        <div class="author-avatar"><i class="fas fa-user-circle"></i></div>
                        <div class="author-info">
                            <div class="author-name" data-translate="testi-2-name">فاطمة محمود</div>
                            <div class="author-title" data-translate="testi-2-title">صيدلانية - استثمار في العاصمة
                                الإدارية</div>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">⭐⭐⭐⭐⭐</div>
                    <p class="testimonial-text" data-translate="testi-3-text">
                        "أحسن قرار اخدته في حياتي! كنت شايف إن العقار غالي أوي بس عمرو فهمني إن ده استثمار مش مصروف.
                        اشتريت
                        تاون هاوس في مدينتي بـ 4 مليون، دلوقتي سعره 6.8 مليون! وعيشتي فيه بقت أحلى حاجة"
                    </p>
                    <div class="testimonial-author">
                        <div class="author-avatar">👨‍🎓</div>
                        <div class="author-info">
                            <div class="author-name" data-translate="testi-3-name">محمود إبراهيم</div>
                            <div class="author-title" data-translate="testi-3-title">مهندس كمبيوتر - تاون هاوس في مدينتي
                            </div>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">⭐⭐⭐⭐⭐</div>
                    <p class="testimonial-text" data-translate="testi-4-text">
                        "كان نفسي في فيلا بس مش لاقية في ميزانيتي. عمرو لاقيلي فيلا في كايف بسعر معقول وبتقسيط مريح.
                        والمفاجأة إن المنطقة زادت 30% في سنة واحدة! شكراً عمرو، إنت فعلاً معلم في شغلك"
                    </p>
                    <div class="testimonial-author">
                        <div class="author-avatar"><i class="fas fa-user-circle"></i></div>
                        <div class="author-info">
                            <div class="author-name" data-translate="testi-4-name">د. مني أحمد</div>
                            <div class="author-title" data-translate="testi-4-title">طبيبة أسنان - فيلا في الشيخ زايد
                            </div>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">⭐⭐⭐⭐⭐</div>
                    <p class="testimonial-text" data-translate="testi-5-text">
                        "عمرو مش بس ساعدني ألاقي العقار المناسب، ده كمان عرفني على محامي شاطر وبنك يديني أحسن سعر فايدة.
                        وفضل معايا لحد ما استلمت ومخلانيش أقلق في أي حاجة. ده فعلاً صديق قبل ما يكون بائع!"
                    </p>
                    <div class="testimonial-author">
                        <div class="author-avatar"><i class="fas fa-user-circle"></i></div>
                        <div class="author-info">
                            <div class="author-name" data-translate="testi-5-name">أستاذ كريم سعد</div>
                            <div class="author-title" data-translate="testi-5-title">مدرس - شقة في 6 أكتوبر</div>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">⭐⭐⭐⭐⭐</div>
                    <p class="testimonial-text" data-translate="testi-6-text">
                        "والله كنت مش مصدقة إن ممكن أشتري عقار بالسهولة دي! عمرو عرفني على عروض خاصة مكانتش متاحة للعامة
                        وسعرلي سعر كويس أوي. والأهم إنه كان صادق معايا في كل حاجة حتى العيوب! 💯"
                    </p>
                    <div class="testimonial-author">
                        <div class="author-avatar">👩‍💻</div>
                        <div class="author-info">
                            <div class="author-name" data-translate="testi-6-name">سارة حسام</div>
                            <div class="author-title" data-translate="testi-6-title">ربة منزل - شقة في القاهرة الجديدة
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
            <div class="cta-content">
                <div class="cta-badge">
                    <span class="badge-dot"></span>
                    <span data-translate="cta-badge">أكثر من 1000 عائلة مصرية حققت حلمها معانا</span>
                </div>
                <h2 class="cta-title" data-translate="cta-title">جاهز تبدأ رحلتك للثراء؟</h2>
                <p class="cta-description" data-translate="cta-desc">
                    استشارة مجانية مع عمرو شخصياً • تحليل شامل للسوق • فرص استثمارية مخفية • ضمان أفضل سعر في السوق<br>
                    <strong>مش هتدفع أي حاجة غير لما نلاقيلك العقار المثالي!</strong>
                </p>
                <div class="cta-buttons">
                    <button class="btn btn-primary" onclick="openChat()">
                        <span><i class="fas fa-comments"></i></span>
                        <span data-translate="cta-btn-chat">كلم عمرو دلوقتي (مجاناً)</span>
                    </button>
                    <button class="btn btn-glass">
                        <span>📞</span>
                        <span data-translate="cta-phone">01001234567</span>
                    </button>
                </div>
                <div class="cta-features">
                    <div class="cta-feature">
                        <span class="feature-icon"><i class="fas fa-check-circle"></i></span>
                        <span data-translate="cta-feat-free">استشارة مجانية</span>
                    </div>
                    <div class="cta-feature">
                        <span class="feature-icon"><i class="fas fa-check-circle"></i></span>
                        <span data-translate="cta-feat-no-commit">بدون التزامات</span>
                    </div>
                    <div class="cta-feature">
                        <span class="feature-icon"><i class="fas fa-check-circle"></i></span>
                        <span data-translate="cta-feat-experts">خبراء معتمدون</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-brand">
                    <div class="logo-wrapper">
                        <div class="logo-icon">أ</div>
                        <div class="logo-text">Osool (أصول)</div>
                    </div>
                    <p class="footer-description" data-translate="footer-desc">
                        منصة عقارية رائدة تجمع بين التقنيات المتطورة والخبرة البشرية
                        لتوفير أفضل تجربة عقارية في مصر والشرق الأوسط
                    </p>
                    <div class="social-links">
                        <a href="#" class="social-link" title="فيسبوك"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-link" title="إنستغرام"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-link" title="تويتر"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-link" title="لينكد إن"><i class="fab fa-linkedin"></i></a>
                    </div>
                </div>

                <div class="footer-links">
                    <div class="footer-column">
                        <h4 data-translate="footer-serv">الخدمات</h4>
                        <ul>
                            <li><a href="#" data-translate="footer-serv-search">البحث العقاري</a></li>
                            <li><a href="#" data-translate="footer-serv-consult">الاستشارات</a></li>
                            <li><a href="#" data-translate="footer-serv-finance">التمويل</a></li>
                            <li><a href="#" data-translate="footer-serv-manage">إدارة الممتلكات</a></li>
                        </ul>
                    </div>

                    <div class="footer-column">
                        <h4 data-translate="footer-areas">المناطق</h4>
                        <ul>
                            <li><a href="#" data-translate="footer-area-tagamo">التجمع الخامس</a></li>
                            <li><a href="#" data-translate="footer-area-capital">العاصمة الإدارية</a></li>
                            <li><a href="#" data-translate="footer-area-october">6 أكتوبر</a></li>
                            <li><a href="#" data-translate="footer-area-sheikh-zayed">الشيخ زايد</a></li>
                        </ul>
                    </div>

                    <div class="footer-column">
                        <h4 data-translate="footer-company">الشركة</h4>
                        <ul>
                            <li><a href="#" data-translate="footer-company-about">من نحن</a></li>
                            <li><a href="#" data-translate="footer-company-team">فريق العمل</a></li>
                            <li><a href="#" data-translate="footer-company-careers">الوظائف</a></li>
                            <li><a href="#" data-translate="footer-company-news">الأخبار</a></li>
                        </ul>
                    </div>

                    <div class="footer-column">
                        <h4 data-translate="footer-support">الدعم</h4>
                        <ul>
                            <li><a href="#" data-translate="footer-support-center">مركز المساعدة</a></li>
                            <li><a href="#" data-translate="footer-support-contact">اتصل بنا</a></li>
                            <li><a href="#" data-translate="footer-support-faq">الأسئلة الشائعة</a></li>
                            <li><a href="#" data-translate="footer-support-privacy">سياسة الخصوصية</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <p data-translate="rights-reserved">&copy; 2024 Osool (أصول). جميع الحقوق محفوظة.</p>
                    <div class="footer-bottom-links">
                        <a href="#" data-translate="footer-terms">الشروط والأحكام</a>
                        <a href="#" data-translate="footer-privacy">سياسة الخصوصية</a>
                        <a href="#" data-translate="footer-cookies">ملفات تعريف الارتباط</a>
                    </div>
                </div>
            </div>
        </footer>
    </main>

    <!-- AI Sidebar (Persistent) -->
    <aside class="ai-sidebar">
        <div class="sidebar-header"
            style="padding: 30px; border-bottom: 1px solid rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; text-align: center; position: relative;">
            <!-- Help Button -->
            <button onclick="openHelpModal()"
                style="position: absolute; top: 16px; left: 16px; width: 36px; height: 36px; border-radius: 50%; border: 1px solid rgba(0,0,0,0.1); background: white; cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                title="مساعدة">
                <i class="fas fa-question-circle" style="color: var(--text-secondary);"></i>
            </button>
            <!-- Clear Chat Button -->
            <button onclick="clearChatHistory()"
                style="position: absolute; top: 16px; right: 16px; width: 36px; height: 36px; border-radius: 50%; border: 1px solid rgba(0,0,0,0.1); background: white; cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                title="مسح المحادثة" onmouseover="this.style.background='#fee2e2'; this.style.borderColor='#ef4444';"
                onmouseout="this.style.background='white'; this.style.borderColor='rgba(0,0,0,0.1)';">
                <i class="fas fa-trash-alt" style="color: #ef4444;"></i>
            </button>
            <div class="avatar-large"
                style="width: 80px; height: 80px; background: var(--gradient-primary); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 32px; color: white; margin-bottom: 16px; box-shadow: 0 10px 30px rgba(44, 62, 80, 0.3); position: relative;">
                <i class="fas fa-user-tie"></i>
                <div class="status-pulse"
                    style="position: absolute; bottom: -4px; right: -4px; width: 16px; height: 16px; background: #2ecc71; border: 3px solid white; border-radius: 50%;">
                </div>
            </div>
            <h2 style="font-family: var(--font-display); margin: 0; font-size: 24px; color: var(--text-primary);"
                data-translate="sidebar-title">عمرو
            </h2>
            <p style="color: var(--text-secondary); margin: 4px 0 0; font-size: 14px;"
                data-translate="sidebar-subtitle">مستشارك العقاري الذكي</p>
        </div>

        <div class="chat-container" id="chatMessages"
            style="flex: 1; overflow-y: auto; padding: 24px; display: flex; flex-direction: column; gap: 16px;">
            <!-- Welcome message will be added by JS -->
        </div>

        <div class="input-area"
            style="padding: 24px; border-top: 1px solid rgba(0,0,0,0.05); background: rgba(255,255,255,0.5);">
            <div class="suggestions" id="aiSuggestions"
                style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px;">
                <span class="chip" onclick="sendQuickMessage('أفضل فرص استثمار')"
                    style="font-size: 12px; padding: 6px 12px; background: white; border: 1px solid var(--glass-border); border-radius: 20px; cursor: pointer; transition: all 0.2s;"
                    data-translate="chip-invest">💰
                    فرص استثمار</span>
                <span class="chip" onclick="sendQuickMessage('شقق في المستقبل')"
                    style="font-size: 12px; padding: 6px 12px; background: white; border: 1px solid var(--glass-border); border-radius: 20px; cursor: pointer; transition: all 0.2s;"
                    data-translate="chip-future">🏙️
                    شقق المستقبل</span>
                <span class="chip" onclick="sendQuickMessage('عروض العاصمة')"
                    style="font-size: 12px; padding: 6px 12px; background: white; border: 1px solid var(--glass-border); border-radius: 20px; cursor: pointer; transition: all 0.2s;"
                    data-translate="chip-capital">🏛️
                    العاصمة الإدارية</span>
            </div>

            <div class="input-wrapper" style="position: relative;">
                <input type="text" id="chatInput" placeholder="اسأل عمرو عن أي عقار..."
                    onkeypress="handleKeyPress(event)"
                    style="width: 100%; padding: 16px 50px 16px 16px; border: 1px solid var(--glass-border); border-radius: 16px; background: white; box-shadow: 0 4px 20px rgba(0,0,0,0.03); font-family: var(--font-body); font-size: 14px;"
                    data-translate-placeholder="chat-placeholder">
                <button class="send-btn" onclick="sendMessage()"
                    style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); width: 36px; height: 36px; background: var(--primary); color: white; border: none; border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s;">
                    <i class="fas fa-paper-plane" style="font-size: 14px;"></i>
                </button>
            </div>
        </div>
    </aside>

    <script>
        // Global variables
        let chatOpen = true;
        let userEngagementScore = 0;
        let messageHistory = [];
        let currentTheme = 'light';
        let currentLanguage = 'ar';
        let roiChart = null;

        // Help Modal Function
        function openHelpModal() {
            let modal = document.getElementById('helpModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'helpModal';
                modal.className = 'schedule-modal-overlay';
                modal.innerHTML = `
                    <div class="schedule-modal" style="max-width: 550px; max-height: 80vh; overflow-y: auto;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="margin: 0;">❓ دليل استخدام عمرو</h3>
                            <button onclick="closeHelpModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary);">×</button>
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 16px;">
                            <div style="background: rgba(0,0,0,0.03); padding: 16px; border-radius: 12px;">
                                <h4 style="margin: 0 0 8px; font-size: 16px;">🔍 البحث عن العقارات</h4>
                                <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">قولي "عايز شقة في التجمع" أو "فيلا بـ 5 مليون" وهجيبلك كل الخيارات المتاحة!</p>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.03); padding: 16px; border-radius: 12px;">
                                <h4 style="margin: 0 0 8px; font-size: 16px;">📊 مقارنة العقارات</h4>
                                <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">قولي "قارن بين العقارات" وهعملك جدول مقارنة كامل بين الأسعار والمساحات والعوائد!</p>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.03); padding: 16px; border-radius: 12px;">
                                <h4 style="margin: 0 0 8px; font-size: 16px;">📱 إرسال استفسار</h4>
                                <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">قولي "ابعت استفسار" أو "تواصل مع المطور" وهجهزلك رسالة واتساب جاهزة!</p>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.03); padding: 16px; border-radius: 12px;">
                                <h4 style="margin: 0 0 8px; font-size: 16px;">📅 حجز معاينة</h4>
                                <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">قولي "عايز أحجز معاينة" وهفتحلك نموذج لتحديد الموعد اللي يناسبك!</p>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.03); padding: 16px; border-radius: 12px;">
                                <h4 style="margin: 0 0 8px; font-size: 16px;">🧮 حساب العائد (ROI)</h4>
                                <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">قولي "احسب العائد" أو اضغط على زر "ROI" في أي عقار وهحسبلك العائد المتوقع!</p>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.03); padding: 16px; border-radius: 12px;">
                                <h4 style="margin: 0 0 8px; font-size: 16px;">🧠 الذاكرة الذكية</h4>
                                <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">بفتكر تفضيلاتك! لو قلتلي ميزانيتك والمنطقة، هفتكرهم في المرة الجاية!</p>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.03); padding: 16px; border-radius: 12px;">
                                <h4 style="margin: 0 0 8px; font-size: 16px;">🌙 الوضع الليلي</h4>
                                <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">اضغط على أيقونة القمر في الهيدر عشان تفعل الوضع المريح للعين!</p>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.03); padding: 16px; border-radius: 12px;">
                                <h4 style="margin: 0 0 8px; font-size: 16px;">🌐 تغيير اللغة</h4>
                                <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">اضغط "English" في الهيدر لتحويل الواجهة كلها للإنجليزي!</p>
                            </div>
                        </div>
                        
                        <div style="margin-top: 24px; text-align: center;">
                            <button onclick="closeHelpModal()" class="schedule-btn primary" style="width: 100%;">فهمت! شكراً 🙏</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }
            modal.classList.add('active');
        }

        function closeHelpModal() {
            const modal = document.getElementById('helpModal');
            if (modal) modal.classList.remove('active');
        }

        // Theme toggle functionality
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('themeIcon');

            if (currentTheme === 'light') {
                html.setAttribute('data-theme', 'dark');
                themeIcon.className = 'fas fa-sun';
                currentTheme = 'dark';
                localStorage.setItem('theme', 'dark');
            } else {
                html.setAttribute('data-theme', 'light');
                themeIcon.className = 'fas fa-moon';
                currentTheme = 'light';
                localStorage.setItem('theme', 'light');
            }
        }

        // Language toggle functionality
        const translations = {
            ar: {
                // Navigation
                'home': 'الرئيسية',
                'properties': 'العقارات',
                'investment': 'الاستثمار',
                'analytics': 'التحليلات',
                'about': 'من نحن',
                'login': 'تسجيل الدخول',

                // Hero Section
                'hero-badge': 'عمرو نشط الآن • +500 ألف عائلة مصرية سعيدة • شهادة حكومية',
                'hero-title-part1': 'أهلاً وسهلاً، أنا عمرو',
                'hero-title-part2': 'خبيرك العقاري المصري الأول',
                'hero-description': '"في مصر، العقار مش مجرد استثمار... ده تأمين للمستقبل وكرامة للعائلة" 😉<br>15 سنة خبرة • 1000+ صفقة ناجحة • خبير معتمد في السوق المصري<br>من التجمع الخامس للعاصمة الإدارية، ومن 6 أكتوبر لمدينتي... معايا هتلاقي البيت اللي يليق بيك<br><strong>مش بس هشوفلك عقار... هعملك consultation كامل مجاناً! 🤩</strong>',
                'trust-licensed': 'مرخص من الحكومة المصرية',
                'trust-refund': 'ضمان استرداد 30 يوم',
                'trust-happy-families': '1000+ عائلة سعيدة',
                'trust-roi': 'عائد استثماري مضمون',
                'cta-chat-amr': 'استشارة مجانية مع عمرو',
                'cta-whatsapp': 'واتساب: 01001234567',
                'quote-text': '"زي ما قال أبوي: \'اللي يشتري أرض يشتري كرامة!\' وأنا هخليك تشتري بذكاء كمان 😉"',
                'quote-author': '- عمرو، مستشارك العقاري اللي بيفهم السوق والناس',
                'buy': 'شراء',
                'rent': 'إيجار',
                'invest': 'استثمار',
                'search-location': 'ابحث عن موقع أو مشروع...',
                'price-range': 'نطاق السعر',
                'property-type': 'نوع العقار',
                'advanced-search': 'بحث متقدم بالذكاء الاصطناعي',
                'chip-tagamo': 'التجمع الخامس',
                'chip-october': '6 أكتوبر',
                'chip-new-capital': 'العاصمة الجديدة',
                'chip-madinaty': 'مدينتي',
                'chip-more': '+12',

                // Quick Stats
                'stat-properties-egypt': 'عقار في مصر',
                'stat-trend-yesterday': '↑ 25% من امبارح',
                'stat-avg-price': 'متوسط السعر (جنيه)',
                'stat-trend-last-year': '↑ 12% من السنة اللي فاتت',
                'stat-amr-response': 'عمرو يرد عليك في',
                'stat-fastest': 'الأسرع في مصر!',
                'stat-happy-families-count': 'عائلة مصرية سعيدة',
                'stat-alhamdulillah': 'الحمد لله!',

                // ROI Section
                'roi-title': 'احسب عائد استثمارك بالذكاء الاصطناعي',
                'roi-desc': 'أداة ذكية لحساب العائد المتوقع على الاستثمار العقاري مع تحليل شامل للسوق المصري',
                'calc-title': 'حاسبة العائد السريعة',
                'property-price': 'سعر العقار (جنيه مصري)',
                'monthly-rent': 'الإيجار الشهري المتوقع',
                'yearly-appreciation': 'نسبة الزيادة السنوية %',
                'enter-values': 'أدخل البيانات لحساب العائد',
                'growth-chart': 'نمو القيمة',
                'roi-chart': 'العائد السنوي',
                'comparison-chart': 'مقارنة المناطق',

                // Properties Section
                'properties-subtitle': 'مختارة بعناية',
                'properties-title': 'عقارات استثنائية',
                'properties-desc': 'اكتشف مجموعة مختارة من أفضل العقارات المتاحة، محللة بواسطة الذكاء الاصطناعي لتناسب احتياجاتك',

                // Features Section
                'features-subtitle': 'ليه تختار عمرو؟',
                'features-title': 'الخبرة المصرية الأصيلة + التكنولوجيا المتطورة',
                'features-desc': 'مش مجرد موقع عقارات... ده مستشار شخصي فاهم السوق المصري وعارف احتياجاتك قبل ما تقولها',
                'feat-ai-title': 'ذكاء اصطناعي بطعم مصري',
                'feat-ai-desc': 'عمرو مش مجرد chatbot... ده AI متدرب على السوق المصري، فاهم الثقافة، وعارف إزاي يساعدك تاخد القرار الصح',
                'feat-market-title': 'تحليل السوق المصري العميق',
                'feat-market-desc': 'بيانات حقيقية من التجمع والعاصمة و6 أكتوبر، مع توقعات دقيقة للأسعار وأحسن فرص الاستثمار',
                'feat-tours-title': 'جولات وزيارات مجانية',
                'feat-tours-desc': 'هوديك بنفسي لكل عقار، مع شرح كامل للمنطقة والخدمات. مش هتشتري حاجة من غير ما تشوفها بعينك',
                'feat-legal-title': 'ضمانات وأمان قانوني كامل',
                'feat-legal-desc': 'كل عقار مفحوص قانونياً، أوراق كاملة، وضمان استرداد. شغل محامين متخصصين في العقارات',
                'feat-finance-title': 'استشارات مالية وتقسيط مريح',
                'feat-finance-desc': 'خطط دفع تناسب راتبك، تعامل مع أحسن البنوك، ونصايح استثمارية تخليك تكسب مش تخسر',
                'feat-service-title': 'خدمة شخصية أصيلة',
                'feat-service-desc': 'مش هتتعامل مع call center... هتتعامل مع عمرو شخصياً. رقم موبايله، واتساب، ومتابعة لحد التسليم',
                'feat-app-title': 'تطبيق ذكي متكامل',
                'feat-app-desc': 'تطبيق محمول متطور بتقنيات الذكاء الاصطناعي للبحث والتصفح وإدارة الاستثمارات',

                // Market Section
                'market-subtitle': 'رؤى السوق',
                'market-title': 'تحليلات وتوقعات السوق العقاري',
                'market-desc': 'بيانات محدثة لحظياً من أكثر من 15 منطقة عقارية رئيسية في مصر',
                'loc-tagamo': 'التجمع الخامس',
                'loc-capital': 'العاصمة الإدارية',
                'loc-october': '6 أكتوبر',
                'lbl-avg-meter': 'متوسط المتر',
                'lbl-demand': 'الطلب',
                'lbl-forecast': 'التوقع',
                'val-high': 'عالي جداً',
                'val-medium': 'متوسط',
                'trend-up': 'صاعد',
                'trend-stable': 'مستقر',

                // Services Section
                'services-subtitle': 'خدماتنا المتكاملة',
                'services-title': 'حلول عقارية شاملة',
                'services-desc': 'من البحث حتى التملك، نوفر لك كل ما تحتاجه في رحلتك العقارية',
                'serv-search': 'البحث الذكي',
                'serv-search-desc': 'خوارزميات متطورة تجد لك العقار المثالي من بين آلاف الخيارات',
                'serv-eval': 'التقييم والفحص',
                'serv-eval-desc': 'تقييم دقيق للعقارات وفحص فني شامل قبل اتخاذ القرار',
                'serv-finance': 'التمويل والقروض',
                'serv-finance-desc': 'شراكات مع أفضل البنوك لتوفير حلول تمويلية مرنة',
                'serv-legal': 'الإجراءات القانونية',
                'serv-legal-desc': 'فريق قانوني متخصص لضمان سلامة كافة المعاملات',
                'serv-manage': 'إدارة الممتلكات',
                'serv-manage-desc': 'خدمات ما بعد البيع وإدارة شاملة لاستثماراتك العقارية',
                'serv-consult': 'استشارات الاستثمار',
                'serv-consult-desc': 'خبراء يساعدونك في بناء محفظة عقارية متنوعة ومربحة',

                // Testimonials
                'testi-subtitle': 'قصص نجاح حقيقية',
                'testi-title': 'إيه اللي قاله العملاء عن عمرو؟',
                'testi-desc': 'مش كلام في الهوا... دي قصص حقيقية لناس حققوا أحلامهم معانا',

                // CTA
                'cta-badge': 'أكثر من 1000 عائلة مصرية حققت حلمها معانا',
                'cta-title': 'جاهز تبدأ رحلتك للثراء؟',
                'cta-desc': 'استشارة مجانية مع عمرو شخصياً • تحليل شامل للسوق • فرص استثمارية مخفية • ضمان أفضل سعر في السوق... وأهم حاجة مش هتدفع أي حاجة غير لما نلاقيلك العقار المثالي!',
                'cta-btn-chat': 'كلم عمرو دلوقتي (مجاناً)',
                'cta-feat-free': 'استشارة مجانية',
                'cta-feat-no-commit': 'بدون التزامات',
                'cta-feat-experts': 'خبراء معتمدون',

                // Chat
                'ai-welcome': `أهلاً وسهلاً بيك! أنا عمرو، مستشارك العقاري المصري اللي هيبقى معاك خطوة بخطوة.\n\nعايز تشتري ولا تستثمر؟ ولا عندك سؤال في العقارات؟ قولي على اللي في دماغك!\n\n"زي ما بيقولوا...البيت اللي يخليك مرتاح أهم من البيت اللي يخليك متفاخر!"`,
                'amr-expert': 'عمرو - خبير العقارات المصري',
                'available-now': 'متاح دلوقتي • هرد عليك في ثواني',
                'chat-placeholder': 'اكتب اللي في دماغك يا حبيبي...',
                'chip-invest': '💰 فرص استثمار',
                'chip-future': '🏙️ شقق المستقبل',
                'chip-capital': '🏛️ العاصمة الإدارية',
                'sidebar-title': 'عمرو',
                'sidebar-subtitle': 'مستشارك العقاري الذكي',

                // Footer
                'footer-desc': 'منصة عقارية رائدة تجمع بين التقنيات المتطورة والخبرة البشرية لتوفير أفضل تجربة عقارية في مصر والشرق الأوسط',
                'footer-serv': 'الخدمات',
                'footer-areas': 'المناطق',
                'footer-company': 'الشركة',
                'footer-support': 'الدعم',
                'rights-reserved': '© 2024 Osool (أصول). جميع الحقوق محفوظة.'
            },
            en: {
                // Navigation
                'home': 'Home',
                'properties': 'Properties',
                'investment': 'Investment',
                'analytics': 'Analytics',
                'about': 'About Us',
                'login': 'Login',

                // Hero Section
                'hero-title': 'Your Smart Real Estate Gateway with a Personal Touch',
                'hero-subtitle': 'Invest in the Future with Amr',
                'hero-desc': 'Discover the best opportunities in New Cairo, The Capital, and Sheikh Zayed, powered by AI and 15 years of Egyptian market experience.',
                'search-placeholder': 'Search for apartment, villa, or office...',
                'search-btn': 'Search Now',
                'stat-happy-clients': 'Happy Clients',
                'stat-properties': 'Properties Available',
                'stat-experience': 'Years Experience',

                // Features Section
                'features-subtitle': 'Why Choose Amr?',
                'features-title': 'Authentic Egyptian Experience + Advanced Tech',
                'features-desc': 'Not just a real estate site... A personal consultant who understands the Egyptian market and knows your needs before you say them.',
                'feat-ai-title': 'AI with Egyptian Flavor',
                'feat-ai-desc': 'Amr is not just a chatbot... He is an AI trained on the Egyptian market, understands the culture, and knows how to help you make the right decision.',
                'feat-market-title': 'Deep Market Analysis',
                'feat-market-desc': 'Real data from New Cairo, Capital, and 6th October, with accurate price forecasts and best investment opportunities.',
                'feat-tours-title': 'Free Tours & Visits',
                'feat-tours-desc': 'I will personally take you to every property, with a full explanation of the area and services. You wont buy anything without seeing it with your own eyes.',
                'feat-legal-title': 'Full Legal Guarantees',
                'feat-legal-desc': 'Every property is legally checked, papers complete, and refund guarantee. Work by lawyers specialized in real estate.',
                'feat-finance-title': 'Financial Consulting & Easy Installments',
                'feat-finance-desc': 'Payment plans that suit your salary, dealing with the best banks, and investment advice to make you gain, not lose.',
                'feat-service-title': 'Authentic Personal Service',
                'feat-service-desc': 'You wont deal with a call center... You will deal with Amr personally. His mobile number, WhatsApp, and follow-up until delivery.',
                'feat-app-title': 'Integrated Smart App',
                'feat-app-desc': 'Advanced mobile app with AI technologies for searching, browsing, and managing investments.',

                // Market Section
                'market-subtitle': 'Market Insights',
                'market-title': 'Real Estate Market Analysis & Forecasts',
                'market-desc': 'Real-time updated data from over 15 major real estate areas in Egypt',
                'loc-tagamo': 'Fifth Settlement',
                'loc-capital': 'New Capital',
                'loc-october': '6th of October',
                'lbl-avg-meter': 'Avg. Meter Price',
                'lbl-demand': 'Demand',
                'lbl-forecast': 'Forecast',
                'val-high': 'Very High',
                'val-medium': 'Medium',
                'trend-up': 'Rising',
                'trend-stable': 'Stable',

                // Services Section
                'services-subtitle': 'Our Integrated Services',
                'services-title': 'Comprehensive Real Estate Solutions',
                'services-desc': 'From search to ownership, we provide everything you need in your real estate journey.',
                'serv-search': 'Smart Search',
                'serv-search-desc': 'Advanced algorithms find you the perfect property from thousands of options.',
                'serv-eval': 'Valuation & Inspection',
                'serv-eval-desc': 'Accurate property valuation and comprehensive technical inspection before decision making.',
                'serv-finance': 'Financing & Loans',
                'serv-finance-desc': 'Partnerships with top banks to provide flexible financing solutions.',
                'serv-legal': 'Legal Procedures',
                'serv-legal-desc': 'Specialized legal team to ensure the safety of all transactions.',
                'serv-manage': 'Property Management',
                'serv-manage-desc': 'After-sales services and comprehensive management of your real estate investments.',
                'serv-consult': 'Investment Consulting',
                'serv-consult-desc': 'Experts helping you build a diversified and profitable real estate portfolio.',

                // Testimonials
                'testi-subtitle': 'Real Success Stories',
                'testi-title': 'What Customers Said About Amr?',
                'testi-desc': 'Not just empty words... These are real stories of people who achieved their dreams with us.',

                // CTA
                'cta-badge': 'Over 1000 Egyptian families achieved their dream with us',
                'cta-title': 'Ready to Start Your Wealth Journey?',
                'cta-desc': 'Free consultation with Amr personally • Comprehensive market analysis • Hidden investment opportunities • Best price guarantee... And most importantly, you wont pay anything until we find you the perfect property!',
                'cta-btn-chat': 'Talk to Amr Now (Free)',
                'cta-feat-free': 'Free Consultation',
                'cta-feat-no-commit': 'No Obligations',
                'cta-feat-experts': 'Certified Experts',

                // Chat
                'ai-welcome': `Welcome! I'm Amr, your Egyptian real estate expert who will be with you every step of the way.\n\nDo you want to buy or invest? Or do you have questions about real estate? Tell me what's on your mind!\n\n"As they say... a home that makes you comfortable is more important than a home that makes you proud!"`,
                'amr-expert': 'Amr - Egyptian Real Estate Expert',
                'available-now': 'Available now • I\'ll respond in seconds',
                'chat-placeholder': 'Type what\'s on your mind...',
                'chip-invest': '💰 Investment Opps',
                'chip-future': '🏙️ Future Apts',
                'chip-capital': '🏛️ New Capital',
                'sidebar-title': 'Amr',
                'sidebar-subtitle': 'Your Smart Real Estate Consultant',

                // Footer
                'footer-desc': 'Leading real estate platform combining advanced tech and human expertise to provide the best real estate experience in Egypt and the Middle East.',
                'footer-serv': 'Services',
                'footer-areas': 'Areas',
                'footer-company': 'Company',
                'footer-support': 'Support',
                'rights-reserved': '© 2024 Osool. All rights reserved.'
            }
        };

        function toggleLanguage() {
            const html = document.documentElement;
            const langToggle = document.getElementById('langToggle');

            if (currentLanguage === 'ar') {
                html.setAttribute('lang', 'en');
                html.setAttribute('dir', 'ltr');
                langToggle.textContent = 'العربية';
                currentLanguage = 'en';

                // NOTIFY AI TO SWITCH TO ENGLISH
                conversationHistory.push({
                    role: "user",
                    parts: [{ text: "[System]: The user has switched the interface language to ENGLISH. Please respond in ENGLISH from now on." }]
                });
            } else {
                html.setAttribute('lang', 'ar');
                html.setAttribute('dir', 'rtl');
                langToggle.textContent = 'English';
                currentLanguage = 'ar';

                // NOTIFY AI TO SWITCH TO ARABIC
                conversationHistory.push({
                    role: "user",
                    parts: [{ text: "[System]: The user has switched the interface language to ARABIC. Please respond in ARABIC set from now on." }]
                });
            }

            // Update text content based on language
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });

            // Update placeholders
            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[currentLanguage][key]) {
                    element.placeholder = translations[currentLanguage][key];
                }
            });

            localStorage.setItem('language', currentLanguage);
        }

        // Mobile Sidebar Toggle
        function toggleMobileSidebar() {
            const sidebar = document.querySelector('.ai-sidebar');
            sidebar.classList.toggle('active');
        }

        // Initialize AI Chat
        document.addEventListener('DOMContentLoaded', function () {
            // Show welcome message if empty
            if (messageHistory.length === 0) {
                setTimeout(() => {
                    const welcomeMsg = 'أهلاً بك في "أصول" 🏛️\nأنا عمرو، مستشارك العقاري الشخصي.\nجاهز أساعدك تلاقي بيت أحلامك أو أفضل فرصة استثمارية!';
                    addMessage(welcomeMsg, 'ai');
                }, 1000);
            }
        });

        // AI Chat functionality (Legacy wrapper if needed)
        function toggleAIChat() {
            toggleMobileSidebar();
        }

        // ROI Calculator functionality
        function initializeROICalculator() {
            const propertyPriceInput = document.getElementById('propertyPrice');
            const monthlyRentInput = document.getElementById('monthlyRent');
            const yearlyAppreciationInput = document.getElementById('yearlyAppreciation');
            const roiResult = document.getElementById('roiResult');

            function calculateROI() {
                const propertyPrice = parseFloat(propertyPriceInput.value);
                const monthlyRent = parseFloat(monthlyRentInput.value);
                const yearlyAppreciation = parseFloat(yearlyAppreciationInput.value) || 15;

                if (propertyPrice && monthlyRent) {
                    const annualRent = monthlyRent * 12;
                    const rentalYield = (annualRent / propertyPrice) * 100;
                    const totalROI = rentalYield + yearlyAppreciation;

                    roiResult.innerHTML = `
                <div style="font-size: 18px; margin-bottom: 8px;">العائد الإجمالي المتوقع</div>
                <div style="font-size: 32px; font-weight: bold;">${totalROI.toFixed(1)}%</div>
                <div style="font-size: 14px; opacity: 0.8;">
                    عائد إيجاري: ${rentalYield.toFixed(1)}% + تقدير سنوي: ${yearlyAppreciation}%
                </div>
                `;
                } else {
                    roiResult.innerHTML = '<span>أدخل البيانات لحساب العائد</span>';
                }
            }
            propertyPriceInput.addEventListener('input', calculateROI);
            monthlyRentInput.addEventListener('input', calculateROI);
            yearlyAppreciationInput.addEventListener('input', calculateROI);
        }

        // Chart functionality
        function initializeCharts() {
            const ctx = document.getElementById('roiChart').getContext('2d');

            const chartData = {
                growth: {
                    labels: ['2024', '2025', '2026', '2027', '2028', '2029', '2030'],
                    datasets: [{
                        label: 'قيمة العقار (مليون جنيه)',
                        data: [3.0, 3.45, 3.97, 4.56, 5.24, 6.03, 6.93],
                        borderColor: '#3c4558',
                        backgroundColor: 'rgba(60, 69, 88, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                roi: {
                    labels: ['2024', '2025', '2026', '2027', '2028'],
                    datasets: [{
                        label: 'العائد السنوي (%)',
                        data: [18, 22, 19, 25, 21],
                        backgroundColor: ['#3c4558', '#4a5568', '#2d3748', '#3c4558', '#4a5568']
                    }]
                },
                comparison: {
                    labels: ['التجمع الخامس', 'العاصمة الإدارية', '6 أكتوبر', 'الشيخ زايد', 'مدينتي'],
                    datasets: [{
                        label: 'متوسط سعر المتر (ألف جنيه)',
                        data: [15.5, 12.8, 18.2, 22.5, 25.0],
                        backgroundColor: [
                            '#3c4558',
                            '#4a5568',
                            '#2d3748',
                            '#5a6578',
                            '#6a7589'
                        ]
                    }]
                }
            };

            roiChart = new Chart(ctx, {
                type: 'line',
                data: chartData.growth,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary')
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            }
                        },
                        y: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            }
                        }
                    }
                }
            });

            window.showChart = function (type) {
                document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');

                roiChart.destroy();

                const config = {
                    type: type === 'comparison' ? 'bar' : 'line',
                    data: chartData[type],
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary')
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                                }
                            },
                            y: {
                                ticks: {
                                    color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                                }
                            }
                        }
                    }
                };

                roiChart = new Chart(ctx, config);
            };
        }

        // openChat function for CTA buttons
        function openChat() {
            if (!chatOpen) {
                toggleAIChat();
            }
        }

        // AI Responses based on Egyptian cultural psychology
        const aiResponses = {
            greetings: [
                `أهلاً وسهلاً! 😊 زي ما بيقولوا 'أهلاً بيك في بيتك التاني!' معايا هتلاقي العقار اللي يخليك تقول 'أهو ده!'`,
                `مرحبتين! 🌟 أنا عمرو وده تخصصي من زمان... العقارات دي حرفتي ومعايا مفيش مستحيل!`,
                `أهلاً بحبيبي! 👋 زي ما قال العندليب: 'دي مش حياة' بدون بيت حلو... تعال نلاقيلك البيت اللي يستاهلك!`
            ],

            scarcity: [
                `⚠️ والله الشقة دي مطلوبة جداً! في 3 عملاء كمان بيسألوا عليها دلوقتي 🔥`,
                `🏃‍♂️ الفرصة دي مش هتتكرر كتير... زي ما بيقولوا 'اللي يستنى كتير يضيع نصيبه!'`,
                `📈 المنطقة دي أسعارها طايرة! الشهر الجاي هتزيد 12% على الأقل - ده كلام أصحاب المكاتب`
            ],

            socialProof: [
                `والله 97% من اللي زيك اختاروا المنطقة دي... دي مش مصادفة يا حبيبي! 😎`,
                `حوالي 500 عيلة مصرية كريمة انتقلت هنا السنة اللي فاتت ومبسوطة جداً! 🏘️`,
                `الناس هنا بتقول عنها 4.8 من 5... والشهادة للحق، دي منطقة محترمة ومفيش فيها مشاكل!`
            ],

            authority: [
                `حبيبي أنا في السوق ده من 15 سنة... وقولتلك إن عمرو مش بيقول كلام فاضي! 💪`,
                `خبراء البنوك بيقولوا إن المنطقة دي من أحسن الاستثمارات... وأنا معاهم في الكلام ده!`,
                `تقرير البنك المركزي الأخير بيأكد... والواحد بيقرا ويتابع عشان مصلحة العملاء 📊`
            ],

            reciprocity: [
                `هاعملك تقرير مجاني عن أسعار المنطقة... كده نبقى اشتغلنا مع بعض زي الناس! 📋`,
                `هاديك استشارة مجانية مع أحسن خبير عندنا (دي عادة بـ5000 جنيه بس انت حبيبي!) ❤️`,
                `هدية مني ليك: دليل المشتري الذكي... 50 صفحة نصايح من القلب وبالمجان! 🎁`
            ],

            commitment: [
                `حلو كده! دلوقتي وإحنا حددنا الميزانية، تعال نشوف إيه الخطوة الجاية... 👍`,
                `ماشاء الله عليك! بما إنك مهتم بالاستثمار، هاوريك العوائد المتوقعة وتشوف بنفسك 💰`,
                `كده كلام! تعال نعمل خطة مخصوصة ليك خطوة بخطوة... المهم نوصل للنتيجة المطلوبة! 🎯`
            ],

            egyptian_humor: [
                `زي ما قال عادل إمام: 'اللي يصبر يبقى له نصيب!' بس في العقارات أحسن ما نصبرش كتير! 😄`,
                `كما قال الريس: 'الشقة الحلوة عايزة راجل يستاهلها!' وانت واضح إنك تستاهل أحسن من كده! 😎`,
                `والنبي تصدق... أنا شغلي أخليك مبسوط زي ما قال محمد هنيدي: 'السعادة جوا القلب!' 😊`
            ],

            location_expertise: [
                `التجمع الخامس ده جنة... مواصلات، مدارس، مولات، كله متوفر! 🌟`,
                `6 أكتوبر منطقة واعدة جداً... الاستثمار فيها مضمون إن شاء الله! 🏗️`,
                `العاصمة الإدارية دي مستقبل مصر... اللي يدخل فيها دلوقتي كسبان! 🏙️`
            ]
        };

        // Enhanced Egyptian AI Agent Responses with Authentic Personality
        const amrResponses = {
            greetings: [
                `أهلاً وسهلاً! أنا عمرو، صاحبك في رحلة البحث عن البيت المناسب 🏡 خبرتي 15 سنة في السوق وهقولك على كل حاجة بصراحة`,
                `السلام عليكم ورحمة الله! عمرو هنا، استشاري عقاري معتمد وخبير في السوق المصري 💪 إيه اللي جابك لعندي النهاردة؟`,
                `مرحباً بيك في أصول! أنا عمرو ومهمتي إني ألاقيلك البيت اللي يستاهلك... خلينا نبدأ بحلمك إيه؟ ✨`,
                `أهلاً حبيبي! عمرو في خدمتك، 15 سنة خبرة و 1000+ صفقة ناجحة... يلا نشوف إيه اللي عايزه 🤝`,
                `إزيك يا معلم! 😄 كله تمام والحمد لله... تعال نتكلم في اللي جابك لعمرو! محتاج شقة؟ فيلا؟ ولا استثمار ذهبي؟`
            ],
            location: {
                'التجمع': `التجمع الخامس؟ والله اختيار ممتاز! المنطقة دي زي الجوهرة الحقيقية 💎 كل حاجة متوفرة: مدارس دولية زي أمريكان وألماني، مستشفيات عالمية، مولات زي كايرو فيستيفال، ومواصلات سهلة للقاهرة والعاصمة.عندي شقق من 120 لـ 350 متر، أسعار تبدأ من 3.2 مليون.الاستثمار هنا مضمون 100% والأسعار بتزيد 15% سنوياً! أحسن كمباوندات: ميفيدا، ماونتن فيو، فيفث سكوير.عايز سكن عائلي هادي ولا قريب من الخدمات؟ 🏢`,
                '6 أكتوبر': `مدينة 6 أكتوبر الجديدة؟ المكان ده بقى قلب مصر النابض! 🌟 جامعات عالمية، شركات متعددة الجنسيات، ومجمعات سكنية راقية.الأسعار لسه معقولة والاستثمار عائده عالي جداً.عندي كمباوندات فخمة: بيفرلي هيلز، أليجريا، الخمائل، بأسعار تبدأ من 2.5 مليون للـ 100 متر.الشيخ زايد جنبك والطريق الدائري على بُعد دقائق.المنطقة دي هتبقى زي دبي في 5 سنين! ميزانيتك كام تقريباً؟`,
                'العاصمة': `العاصمة الإدارية الجديدة؟ ده مش مجرد مشروع... ده تغيير جذري لخريطة مصر! 🚀 الحكومة نقلت 80 % من الوزارات، البنوك المركزية، الشركات الكبرى كلها رايحة هناك.القطار المعلق، المترو الجديد، مطار شرق القاهرة...كله هيخلي المكان ده مركز الشرق الأوسط.سعر المتر هيوصل 100 ألف في 3 سنين.دي فرصة العمر والعمر ما يجيلك حاجة زيها تاني! عايز استثمار ولا سكن؟`,
                'مدينتي': `مدينتي؟ المكان اللي فيه الرفاهية الأوروبية في قلب مصر! 🌿 كمباوندات مغلقة، أمان 24 ساعة، مساحات خضراء وأكلوب هاوس عالمي.فيه جولف كورت، مدارس دولية، مستشفيات، ومولات.أسعار تبدأ من 4 مليون لشقة 130 متر.العيشة هنا زي اللي في لندن بس بطقس مصر الجميل! عندك عيال في سن المدارس؟`,
                'الشيخ زايد': `الشيخ زايد؟ منطقة راقية وهادية مناسبة للعائلات الكريمة! 🏛️ قرب من كل حاجة وأسعار معقولة نسبياً.كمباوندات زي كايف وغرب أرابيا.المتر من 35 لـ 55 ألف حسب القرب من المحاور الرئيسية`,
                'المعادي': `المعادي العريقة؟ منطقة ديبلوماسية راقية، طابع أوروبي مميز وشوارع واسعة. قريب من النيل ووسط القاهرة.أسعار تبدأ من 45 ألف للمتر في الشقق، و 5 مليون للفيلات`
            },
            budget: {
                low: `مليون لـ 2.5 مليون؟ تمام خالص! 👌 ده يفتحلك فرص ذهبية في العاصمة الإدارية والمستقبل سيتي. ممكن نلاقيلك شقة 100-130 متر بتقسيط مريح على 8 سنين بدون فوائد! أحسن المطورين: سيتي إيدج، بالم هيلز، الأهلي صبور.الأسعار دي هتضاعف في السنتين الجايين!`,
                medium: `2.5 لـ 5 مليون؟ ممتاز جداً! 💪 ده يفتحلك خيارات راقية في التجمع الخامس أو تاون هاوس فخم في كمباوند محترم.ممكن حتى دوبلكس في الشيخ زايد أو شقة بنتهاوس مع تراس.المطورين الكبار زي سوديك وأوراسكوم عندهم عروض خاصة دلوقتي`,
                high: `5 مليون فما فوق؟ ما شاء الله عليك! 🌟 يبقى نتكلم في فيلات مستقلة وبنتهاوس بإطلالات خرافية. عندي فرص VIP في ميفيدا، مدينتي، وكمباوند لا فيستا الساحل الشمالي.ممكن حتى قصر في كاتاميا هايتس!`,
                flexible: `الميزانية مش عائق؟ حلو أوي! 🎯 خلينا نركز على اللي يناسب lifestyle بتاعك الأول. عايز إيه بالظبط؟ privacy وفخامة؟ ولا location ومواصلات؟ ولا استثمار بعائد عالي؟ قولي وأنا هجيبلك الأفضل حتى لو مش متاح في السوق!`
            },
            objections: {
                price: `أنا فاهم إن السعر يمكن يكون عالي شوية، بس تعالى نحسبها صح... 🧮 لو قارنت بأسعار السنة اللي فاتت، هتلاقي إن ده استثمار ممتاز.منطقة زي دي ارتفعت 40% في 18 شهر! غير كده، فيه أنظمة تقسيط مريحة جداً على 8-10 سنين بدون فوائد.والأهم من كده، دي مش مجرد شقة...دي asset هتورثها لولادك!`,
                location: `صحيح المكان بعيد شوية عن وسط البلد، بس ده اللي خلاه هادي ومناسب للعائلات. 🚊 غير كده، المترو الجديد والقطار المعلق هيوصلوا هناك السنة الجاية إن شاء الله.والطرق الجديدة خلت المسافة نص ساعة للقاهرة في أسوأ زحمة!`,
                trust: `أنا فاهم قلقك، وده حقك طبعاً. 🤝 احنا شغالين مع أكبر المطورين في مصر وكلهم مرخصين من الهيئة العامة للتنمية السياحية والحكومة.وعندنا ضمان استرداد كامل لو مش عاجبك العقار في أول 30 يوم! زائد كل العقود معتمدة من الشهر العقاري`,
                timing: `استنى شوية؟ يا حبيبي الاستنى في العقار خسارة! 📈 الأسعار بتزيد كل شهر. السنة دي بس التجمع زاد 25% !كل ما استنيت أكتر، كل ما هتدفع أكتر.دلوقتي فيه عروض محدودة وخصومات للدفع الكاش`
            },
            humor: [
                `إنت عايز فيلا في التجمع بسعر شقة في الهرم؟ طب كمل الحلم الحلو ده وأنا أصحيك! 😄`,
                `زي ما عادل إمام قال: 'اللي يشتري دلوقتي يكسب بكرة' - وده فعلاً حقيقي في العقارات! 🎬`,
                `أنا مش جني علشان أجيبلك قصر بمليون جنيه، بس هحاول أجيبلك أحسن حاجة في الميزانية! 😅`,
                `العقار ده حلو لدرجة إن حماتك هتحبك وتقولك 'أنت راجل كده'! 😂`,
                `زي ما قال العندليب: 'الأحلام مش مستحيلة!' بس خلينا واقعيين شوية ونحلم بذكاء! ✨`,
                `لو العقار ده كان راجل، كان هيبقى جورج كلوني بس مصري! 😎`,
                `أنا شايف إنك محتار زي اللي واقف في سوبر ماركت الحلاوة... مش عارف يختار إيه! 🍭`,
                `الشقة دي حلوة لدرجة إن جيرانك هيسألوك: 'إنت مين واسطتك؟' 😂`
            ],
            investment: {
                roi: `من خبرتي الشخصية، المنطقة دي شهدت نمو استثنائي 35-45% في آخر سنتين فقط! 📊 ولو الحكومة كملت خطة التطوير زي ما مخطط لها، متوقع زيادة 25% كمان السنة الجاية.ده غير إن العقار في مصر بيحافظ على قيمته أكتر من أي استثمار تاني`,
                rental: `العائد الإيجاري هنا ممتاز - حوالي 8-12% سنوياً! 💰 يعني الشقة بـ 3 مليون ممكن تجيبلك 25-30 ألف شهرياً.وده أحسن من أي وديعة في أي بنك، غير إن العقار قيمته بتزيد!`,
                timing: `دلوقتي هو الوقت الذهبي للشراء! 🏆 قبل رمضان والصيف الأسعار بتبقى أقل. بعد العيد والموسم السياحي كل حاجة بتزيد 10-15 %.زائد المطورين عندهم عروض خاصة دلوقتي مش هتتكرر`,
                comparison: `لو قارنت بالذهب أو الدولار، العقار أحسن وأأمن استثمار على المدى الطويل في مصر. 💎 الذهب ممكن ينزل، الدولار ممكن يفقد قيمة، بس الأرض مش بتزيد! والناس عايزة تسكن في كل الأحوال`
            },
            family: [
                `عيلتك هتحب المكان ده من أول نظرة! 👨‍👩‍👧‍👦 فيه حدائق آمنة للأطفال، نادي اجتماعي، مدارس دولية على أعلى مستوى، ومستشفيات متخصصة.كل حاجة العائلة محتاجاها في مكان واحد!`,
                `والدتك هتكون مبسوطة جداً من التصميم والمساحة! المطبخ واسع ومجهز بأحدث الأجهزة، الريسبشن يستقبل العيلة كلها بكرامة، والحمامات فخمة زي الفنادق`,
                `أولادك هيكونوا في أمان تام وهيحبوا المكان! 🏫 الكمباوند فيه سيكيوريتي محترف 24 ساعة، كاميرات مراقبة حديثة، وأنشطة ترفيهية للأطفال.مش هتشيل هم عليهم أبداً!`,
                `المكان ده مثالي للعائلات اللي عايزة lifestyle راقي. 🌟 فيه كلوب هاوس، حمام سباحة، جيم، سبا، ومناطق للشواء والتجمعات العائلية.عيلتك هتعيش زي ما في أوروبا!`,
                `بصراحة، المنطقة دي اختيار العائلات الواعية. جيرانك هيبقوا من نفس مستواك الاجتماعي والثقافي، والأطفال هيكبروا في بيئة صحية ومحترمة`
            ],
            closing: [
                `خلاص كده؟ يبقى نحجزلك معاينة بكرة الصبح علشان تشوف المكان بعينك! 📅 أنا هبعتلك كل التفاصيل والصور والأسعار على الواتساب دلوقتي، وهنزورها سوا`,
                `تمام! أنا هحضرلك عقد ابتدائي وهنراجعه مع المحامي بتاعنا مجاناً. 📋 كل حاجة هتبقى واضحة وشفافة، ومش هنسيب أي تفصيلة صغيرة`,
                `ممتاز! خليني أكلم المطور دلوقتي وأشوفلك أحسن سعر وعرض خاص. 📞 هرجعلك في خلال ساعة بالتفاصيل النهائية`,
                `أنا مبسوط إنك اخترت تتعامل معايا! 🤝 هديلك رقم موبايلي الشخصي وهكون معاك في كل خطوة لحد ما نخلص كل الإجراءات`,
                `يلا نبدأ الخطوات العملية! هجيبلك كراسة الشروط والمواصفات وهنعمل جدولة للدفع تناسب ظروفك المالية`
            ],
            egyptian_expressions: [
                "اطمن يا حبيبي... أنا عمرو وده شغلي ودي أمانة في رقبتي! 💪",
                "والله العظيم مش هكدب عليك حتى لو كده يضرني... المصداقية أهم من أي صفقة!",
                "يلا ما تخليناش نستنى... العقار الحلو بيروح بسرعة زي الفشار! 🍿",
                "زي ما بيقولوا: 'اللي يستنى الدور يطول عليه الدور!' والعقار مش استثناء",
                "والله انت مش غلطان لما جيت لعمرو... ده تخصصي وحبي من زمان! ❤️",
                "حبيبي، أنا مش بائع عقارات... أنا استشاري وصديق! الفرق كبير أوي",
                "زي ما الراجل الطيب قال: 'اللي معاه فلوس يشتري، واللي معاهوش ييجي يتفرج!' 😄",
                "معلش، السوق غالي بس الجودة تستاهل... مش كل حاجة رخيصة حلوة!"
            ],

            // New sections for enhanced personality
            consultation: [
                "أنا مش بس هبيعلك عقار... أنا هديلك consultation كامل! 🎯 هحللك السوق، أشوفلك أحسن فرص الاستثمار، وأقولك على كل المخاطر بصراحة",
                "خدماتي مش بتنتهي بتوقيع العقد. هفضل معاك لحد التسليم وبعدها كمان لو احتجت أي حاجة",
                "أنا عندي شبكة علاقات واسعة - محامين، مهندسين، مقاولين، شركات ديكور. كل اللي تحتاجه هلاقيهولك"
            ],

            success_stories: [
                "زي أحمد اللي اشترى في العاصمة من سنتين بـ 2.2 مليون... دلوقتي شقته تتباع بـ 3.8 مليون! 📈",
                "فاطمة اشترت تاون هاوس في التجمع قبل كده بـ 4.5 مليون، دلوقتي قيمته 7.2 مليون!",
                "محمد استثمر في 3 شقق صغيرة للإيجار... دلوقتي دخله الشهري 45 ألف جنيه!"
            ]
        };

        // ========================================
        // GOOGLE GEMINI AI CONFIGURATION
        // ========================================

        // AI Configuration
        let AI_CONFIG = {
            provider: 'gemini',
            apiKey: localStorage.getItem('gemini_api_key') || '',
            model: 'gemini-1.5-flash',
            temperature: 0.9,
            maxTokens: 800
        };

        // Conversation history for context
        let conversationHistory = [];

        // Egyptian Real Estate Expert System Prompt
        const SYSTEM_PROMPT = `
                ═══════════════════════════════════════════════════════════════
                IDENTITY: SENIOR REAL ESTATE CONSULTANT (AMR)
                ═══════════════════════════════════════════════════════════════
                You are Amr, a Top-Tier Senior Real Estate Consultant with 15 years of experience.
                
                CORE TRAITS:
                1.  **Language Mirroring**: You MUST match the user's language 100%.
                    - If User speaks Arabic -> Reply in **Arabic ONLY**. Do NOT use English headers, words, or Phase names.
                    - If User speaks English -> You can be bilingual.
                2.  **Sales Psychology**: You NEVER just list properties. You qualify, analyze, and then propose.
                3.  **Firm Negotiator**: You DO NOT offer discounts. If pressured, pivot to value, scarcity, and developer reputation.
                4.  **Market Authority**: You distinguish strictly between Developer Price (Primary) and Resale Price (Secondary).

                ═══════════════════════════════════════════════════════════════
                STRICT DATA AUTHORITY (قاعدة البيانات الحصرية)
                ═══════════════════════════════════════════════════════════════
                You have access to a SPECIFIC, VERIFIED database of properties (egyptianData).
                1.  **NO HALLUCINATIONS**: You must ONLY recommend properties that exist in your database.
                2.  **NO OUTSIDE DATA**: Do not invent prices or units not in the list.
                3.  **STRICT MATCHING**: If the user asks for "Sodic", valid ONLY if found in your list. If not found, say "Not available in current inventory".
                4.  **DELIVERY DATE MATCHING**: When user requests "immediate delivery" or "استلام فوري":
                    - ONLY recommend properties with deliveryDate: "Ready" or "2025" or earlier
                    - If NO properties match, you MUST say: "للأسف، الاستلام الفوري غير متوفر حالياً في المخزون. أقرب موعد استلام متاح هو [deliveryDate]"
                    - NEVER hallucinate or assume a property is ready when deliveryDate shows future year
                    - ALWAYS verify deliveryDate field BEFORE recommending ANY property
                
                5.  **SMART ALTERNATIVES (CRITICAL)**: When exact match doesn't exist, ALWAYS offer closest alternatives:
                    - If no properties at EXACT budget (e.g., 6M), find properties within ±20% (4.8M - 7.2M)
                    - If no properties at EXACT location, find properties in nearby/similar locations
                    - If no properties at EXACT delivery date, find closest delivery dates
                    - CLEARLY STATE the differences: "أقرب عقار متاح بسعر 6.5 مليون (زيادة 500 ألف عن الميزانية)"
                    - NEVER just say "not available" without offering alternatives
                    - Use searchProperties tool to SHOW these alternatives to the user
                
                6.  **NO BUDGET HALLUCINATION (CRITICAL)**: NEVER assume or invent budget values:
                    - If user did NOT mention a budget, you MUST ASK: "في حدود ميزانية كام؟"
                    - NEVER say things like "لا توجد شقق بميزانية 4 مليون" if user never said 4 million
                    - NEVER reference specific budget numbers unless the user explicitly stated them
                    - Only use maxPrice filter in searchProperties if user gave you a budget
                    - If no budget provided, show a range of options and ask about budget preference
                
                Unless the user specifies "Resale", assume they are looking for "Primary/Developer" inventory first.

                ═══════════════════════════════════════════════════════════════
                AGENTIC TOOLS & CONTROL 🛠️
                ═══════════════════════════════════════════════════════════════
                You have full control over the UI. Use these tools by outputting PURE JSON.
                
                AVAILABLE TOOLS:
                1.  'searchProperties(args)': Filter the property grid.
                    - 'location': "New Cairo", "Mostakbal City", "Zayed", "6th settlement".
                    - 'type': "Apartment", "Villa", "Townhouse", "Twinhouse", "Duplex", "Penthouse".
                    - 'maxPrice': Number (EGP).

                2.  'calculateROI(args)': Open the ROI Calculator.
                    - 'price': Property price (Number).
                    - 'rent': Expected monthly rent (Number - optional).

                3.  'changeTheme(args)': Switch UI theme.
                    - 'mode': "dark" or "light".

                ═══════════════════════════════════════════════════════════════
                ⚠️⚠️⚠️ CRITICAL: OUTPUT FORMAT RULES ⚠️⚠️⚠️
                ═══════════════════════════════════════════════════════════════
                
                RULE 1: NEVER MIX TEXT WITH JSON
                - If calling a tool: Output ONLY the JSON. Nothing before. Nothing after.
                - If chatting: Output ONLY text. Never include JSON.

                ❌ WRONG (DO NOT DO THIS):
                "سأقوم بعرض العقارات... {"tool": "searchProperties", "args": {"location": "New Cairo"}}"
                "Here are properties: {"tool": "searchProperties"...}"

                ✅ CORRECT - When calling a tool, output ONLY:
                {"tool": "searchProperties", "args": {"location": "New Cairo", "maxPrice": 5000000}}
                
                ✅ CORRECT - When presenting a property in TEXT (NO JSON):
                "عندي وحدة مميزة في تيرا - 150 متر تاون هاوس بسعر 18 مليون. عايز تفاصيل أكتر؟"

                RULE 2: WHEN TO USE TOOLS
                - Use searchProperties SILENTLY when you need to show properties.
                - The tool will display property cards automatically.
                - After the tool runs, your next message should be a friendly follow-up.

                RULE 3: PROPERTY PRESENTATION (TEXT MODE)
                When describing a property in text, format it nicely:
                "🏠 [اسم المشروع] - [Type]
                📍 [Location]
                💰 السعر: [Price] مليون جنيه
                📐 المساحة: [Size] متر
                🏢 المطور: [Developer]"

                ═══════════════════════════════════════════════════════════════
                CONVERSATION FLOW & SALES PROTOCOL
                ═══════════════════════════════════════════════════════════════
                NEVER dump a list of properties immediately. Follow this flow:

                PHASE 1: DISCOVERY & QUALIFICATION (المرحلة الأولى: الاستكشاف)
                If the user says "I want an apartment", DO NOT SEARCH YET. Ask in Arabic:
                - "استثمار ولا سكن؟" (Investment or Home?)
                - "امتى موعد الاستلام المفضل؟" (Delivery Date?)
                - "في حدود ميزانية كام؟" (Budget?)
                
                CRITICAL: Before searching properties, VERIFY:
                1. Budget range matches database
                2. Location preference exists in inventory
                3. Property type is available
                4. **Delivery date requirement** - If user says "استلام فوري", filter for deliveryDate: "Ready", "2025" or earlier ONLY

                PHASE 2: MARKET EDUCATION (المرحلة الثانية: التثقيف)
                Before pitching, give value in Arabic:
                - "السوق حالياً بيشهد طلب عالي..."
                - "متوسط الأسعار للمطورين الكبار..."

                PHASE 3: PROPOSAL (المرحلة الثالثة: العرض)
                Now, propose specific units using 'searchProperties'.
                - "عندي وحدة 150 متر مناسبة جداً لطلبك..."
                
                PHASE 4: HANDLING OBJECTIONS (المرحلة الرابعة: الاعتراضات)
                User: "Can I get a discount?"
                Amr: "يا فندم ده سعر مطور (Primary) وده السعر الرسمي، لكن القيمة الحقيقية في خطة الدفع على 8 سنين اللي بتسبق التضخم."

                ═══════════════════════════════════════════════════════════════
                HANDLING DELIVERY DATE MISMATCHES (CRITICAL EXAMPLES)
                ═══════════════════════════════════════════════════════════════
                User: "عايز استلام فوري في حدود ال 6 مليون"
                
                ✅ CORRECT Response (if no matching properties with immediate delivery):
                "يا فندم، بكل صراحة ووفقاً للمخزون الحالي من المطورين الكبار، الاستلام الفوري في حدود ال 6 مليون غير متوفر حالياً في التجمع الخامس. 
                أقرب موعد استلام متاح هو 2026. هل في مرونة في موعد الاستلام؟ أو ممكن نشوف خيارات في السوق الثانوي (Resale)؟"
                
                ❌ WRONG (DO NOT DO THIS):
                Recommend a property with deliveryDate: "2026" as if it's immediate delivery, then backtrack later.

                ═══════════════════════════════════════════════════════════════
                SMART ALTERNATIVES EXAMPLES (CRITICAL)
                ═══════════════════════════════════════════════════════════════
                User: "اعرضلي ارخص شقه استلام فوري في التجمع الخامس"
                
                ✅ CORRECT Response (when no exact match, but close alternatives exist):
                "يا فندم، بناءً على طلب حضرتك، أقرب الخيارات المتاحة حالياً في التجمع الخامس:
                
                {\"tool\": \"searchProperties\", \"args\": {\"location\": \"6th settlement\", \"type\": \"Apartment\", \"maxPrice\": 7200000}}
                
                هذه أقرب الخيارات المتاحة. لاحظ أن:
                • موعد الاستلام 2026 (وليس فوري)
                • الأسعار تبدأ من 5 مليون
                هل تحب تشوف التفاصيل؟"
                
                ✅ ALSO CORRECT (explaining differences clearly):
                "أرخص شقة متاحة في التجمع الخامس هي بسعر 5 مليون جنيه (أقل من ميزانيتك ب 1 مليون)، لكن موعد الاستلام 2026. 
                عايز أعرضلك التفاصيل؟"
                
                ❌ WRONG (DO NOT DO THIS):
                "للأسف، لا توجد شقق متاحة" (without offering any alternatives)

                ═══════════════════════════════════════════════════════════════
                FORMATTING RULES
                ═══════════════════════════════════════════════════════════════
                - Keep responses clean and mobile-friendly.
                - Use bullet points for stats.
                - NO MARKDOWN or # Headers.
                - Tone: Professional, Confident, "White-Collar" Elite.
                `;


        // LOAD REAL EGYPTIAN REAL ESTATE DATA
        // Embedded Real Estate Data to fix CORS issues
        const egyptianData = {
            "metadata": {
                "totalProperties": 93,
                "lastUpdated": "2025-12-26",
                "marketStats": {
                    "averagePricePerSqm": 45000,
                    "hotLocations": [
                        "New Cairo",
                        "Mostakbal City",
                        "Golden Square"
                    ]
                }
            },
            "properties": [
                {
                    "id": "NC1",
                    "title": "Tierra - 6th settlement",
                    "type": "Townhouse",
                    "location": "6th settlement",
                    "compound": "Tierra",
                    "developer": "Saudi Egyptian Developers (SED)",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 5016000,
                    "pricePerSqm": 33440,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 47025
                    },
                    "image": "https://prod-images.nawy.com/processed/inventory/compounds/1834/gallery/Screenshot2025-11-17140324/high.webp",
                    "description": "Discover Saudi Egyptian Developers (SED)'s Properties in 6th settlement – With Financing Up to 8 Years"
                },
                {
                    "id": "NC2",
                    "title": "East Vale - Mostakbal City",
                    "type": "Villa",
                    "location": "Mostakbal City",
                    "compound": "East Vale",
                    "developer": "SODIC",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 11228000,
                    "pricePerSqm": 74853,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 105262
                    },
                    "image": "https://prod-images.nawy.com/processed/inventory/compounds/1846/gallery/Screenshot%202025-12-17%20004549/high.webp",
                    "description": "Discover SODIC's Properties in Mostakbal City – With Financing Up to 8 Years"
                },
                {
                    "id": "NC3",
                    "title": "Crescent Walk - 6th settlement",
                    "type": "Townhouse",
                    "location": "6th settlement",
                    "compound": "Crescent Walk",
                    "developer": "Marakez",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 9302960,
                    "pricePerSqm": 62019,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 87215
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1333/high.webp",
                    "description": "Discover Marakez's Properties in 6th settlement – With Financing Up to 9 Years"
                },
                {
                    "id": "NC4",
                    "title": "Solana East - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Solana East",
                    "developer": "Ora Developers",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 13955000,
                    "pricePerSqm": 93033,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 130828
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1077/high.webp",
                    "description": "Discover Ora Developers's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC5",
                    "title": "Telal East - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Telal East",
                    "developer": "Roya Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 6566900,
                    "pricePerSqm": 43779,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 61564
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/5934/high.webp",
                    "description": "Discover Roya Developments's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC6",
                    "title": "El Patio Riva - 6th settlement",
                    "type": "Penthouse",
                    "location": "6th settlement",
                    "compound": "El Patio Riva",
                    "developer": "La Vista Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 5943000,
                    "pricePerSqm": 39620,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 55715
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1761/high.webp",
                    "description": "Discover La Vista Developments's Properties in 6th settlement – With Financing Up to 8 Years"
                },
                {
                    "id": "NC7",
                    "title": "The Crest - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "The Crest",
                    "developer": "IL Cazar Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 4800000,
                    "pricePerSqm": 32000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 45000
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/806/high.webp",
                    "description": "Discover IL Cazar Developments's Properties in New Cairo – With Financing Up to 10 Years"
                },
                {
                    "id": "NC8",
                    "title": "Stei8ht - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Stei8ht",
                    "developer": "LMD",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 9881000,
                    "pricePerSqm": 65873,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 92634
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/7927/high.webp",
                    "description": "Discover LMD's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC9",
                    "title": "Scenes - Mostakbal City",
                    "type": "Villa",
                    "location": "Mostakbal City",
                    "compound": "Scenes",
                    "developer": "Tatweer Misr",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 15136000,
                    "pricePerSqm": 100906,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 141900
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1391/high.webp",
                    "description": "Discover Tatweer Misr's Properties in Mostakbal City – With Financing Up to 15 Years"
                },
                {
                    "id": "NC10",
                    "title": "Hyde Park - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Hyde Park",
                    "developer": "Hyde Park",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 8820000,
                    "pricePerSqm": 58800,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 82687
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/773/high.webp",
                    "description": "Discover Hyde Park's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC11",
                    "title": "Palm Hills New Cairo - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Palm Hills New Cairo",
                    "developer": "Palm Hills Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 9283000,
                    "pricePerSqm": 61886,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 87028
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/148/high.webp",
                    "description": "Discover Palm Hills Developments's Properties in New Cairo – With Financing Up to 6 Years"
                },
                {
                    "id": "NC12",
                    "title": "Patio Vida - 6th settlement",
                    "type": "Duplex",
                    "location": "6th settlement",
                    "compound": "Patio Vida",
                    "developer": "La Vista Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 11560000,
                    "pricePerSqm": 77066,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 108375
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1427/high.webp",
                    "description": "Discover La Vista Developments's Properties in 6th settlement – With Financing Up to 9 Years"
                },
                {
                    "id": "NC13",
                    "title": "City Gate - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "City Gate",
                    "developer": "Qatari Diar",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 6300000,
                    "pricePerSqm": 42000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 59062
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/764/high.webp",
                    "description": "Discover Qatari Diar's Properties in New Cairo – With Financing Up to 10 Years"
                },
                {
                    "id": "NC14",
                    "title": "Park Central - Mostakbal City",
                    "type": "Duplex",
                    "location": "Mostakbal City",
                    "compound": "Park Central",
                    "developer": "Hassan Allam Properties",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 7900000,
                    "pricePerSqm": 52666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 74062
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1312/high.webp",
                    "description": "Discover Hassan Allam Properties's Properties in Mostakbal City – With Financing Up to 10 Years"
                },
                {
                    "id": "NC15",
                    "title": "Saada - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Saada",
                    "developer": "Horizon Egypt Development",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 10699127,
                    "pricePerSqm": 71327,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 100304
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/974/high.webp",
                    "description": "Discover Horizon Egypt Development's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC16",
                    "title": "ZED East - 6th settlement",
                    "type": "Villa",
                    "location": "6th settlement",
                    "compound": "ZED East",
                    "developer": "Ora Developers",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 13762000,
                    "pricePerSqm": 91746,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 129018
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/2023/high.webp",
                    "description": "Discover Ora Developers's Properties in 6th settlement – With Financing Up to 10 Years"
                },
                {
                    "id": "NC17",
                    "title": "Aliva Mountain View Mostakbal City - Mostakbal City",
                    "type": "Villa",
                    "location": "Mostakbal City",
                    "compound": "Aliva Mountain View Mostakbal City",
                    "developer": "Mountain View",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 10357007,
                    "pricePerSqm": 69046,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 97096
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/996/high.webp",
                    "description": "Discover Mountain View's Properties in Mostakbal City – With Financing Up to 12 Years"
                },
                {
                    "id": "NC18",
                    "title": "Eastown - New Cairo",
                    "type": "Duplex",
                    "location": "New Cairo",
                    "compound": "Eastown",
                    "developer": "SODIC",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 11500000,
                    "pricePerSqm": 76666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 107812
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/6667/high.webp",
                    "description": "Discover SODIC's Properties in New Cairo"
                },
                {
                    "id": "NC19",
                    "title": "Mountain View ICity New Cairo - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Mountain View ICity New Cairo",
                    "developer": "Mountain View",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 9264465,
                    "pricePerSqm": 61763,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 86854
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/195/high.webp",
                    "description": "Discover Mountain View's Properties in New Cairo – With Financing Up to 10 Years"
                },
                {
                    "id": "NC20",
                    "title": "Glen - 6th settlement",
                    "type": "Villa",
                    "location": "6th settlement",
                    "compound": "Glen",
                    "developer": "IL Cazar Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 7800000,
                    "pricePerSqm": 52000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 73125
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1426/high.webp",
                    "description": "Discover IL Cazar Developments's Properties in 6th settlement – With Financing Up to 10 Years"
                },
                {
                    "id": "NC21",
                    "title": "DISTRICT 5 - South New Cairo",
                    "type": "Townhouse",
                    "location": "South New Cairo",
                    "compound": "DISTRICT 5",
                    "developer": "Marakez",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 15884000,
                    "pricePerSqm": 105893,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 148912
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1595/high.webp",
                    "description": "Discover Marakez's Properties in South New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC22",
                    "title": "Bloomfields - Mostakbal City",
                    "type": "Villa",
                    "location": "Mostakbal City",
                    "compound": "Bloomfields",
                    "developer": "Tatweer Misr",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 6545000,
                    "pricePerSqm": 43633,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 61359
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/9309/high.webp",
                    "description": "Discover Tatweer Misr's Properties in Mostakbal City – With Financing Up to 8 Years"
                },
                {
                    "id": "NC23",
                    "title": "Fifth Square Al Marasem - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Fifth Square Al Marasem",
                    "developer": "Al Marasem Development",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 11219000,
                    "pricePerSqm": 74793,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 105178
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1096/high.webp",
                    "description": "Discover Al Marasem Development's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC24",
                    "title": "El Patio Oro - New Cairo",
                    "type": "Duplex",
                    "location": "New Cairo",
                    "compound": "El Patio Oro",
                    "developer": "La Vista Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 9800000,
                    "pricePerSqm": 65333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 91875
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1178/high.webp",
                    "description": "Discover La Vista Developments's Properties in New Cairo – With Financing Up to 6 Years"
                },
                {
                    "id": "NC25",
                    "title": "Azzar New Cairo - Golden Square",
                    "type": "Villa",
                    "location": "Golden Square",
                    "compound": "Azzar New Cairo",
                    "developer": "Reedy Group",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14577000,
                    "pricePerSqm": 97180,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 136659
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/2257/high.webp",
                    "description": "Discover Reedy Group's Properties in Golden Square – With Financing Up to 6 Years"
                },
                {
                    "id": "NC26",
                    "title": "Capital Gardens - New Cairo",
                    "type": "Duplex",
                    "location": "New Cairo",
                    "compound": "Capital Gardens",
                    "developer": "Palm Hills Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 5000000,
                    "pricePerSqm": 33333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 46875
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/2600/high.webp",
                    "description": "Discover Palm Hills Developments's Properties in New Cairo"
                },
                {
                    "id": "NC27",
                    "title": "AZAD - New Cairo",
                    "type": "Penthouse",
                    "location": "New Cairo",
                    "compound": "AZAD",
                    "developer": "Tameer",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 18349800,
                    "pricePerSqm": 122332,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 172029
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1159/high.webp",
                    "description": "Discover Tameer's Properties in New Cairo"
                },
                {
                    "id": "NC28",
                    "title": "Stone Residence - New Cairo",
                    "type": "Penthouse",
                    "location": "New Cairo",
                    "compound": "Stone Residence",
                    "developer": "PRE Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 2467000,
                    "pricePerSqm": 16446,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 23128
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/410/high.webp",
                    "description": "Discover PRE Developments's Properties in New Cairo – With Financing Up to 4 Years"
                },
                {
                    "id": "NC29",
                    "title": "Jayd - New Cairo",
                    "type": "Duplex",
                    "location": "New Cairo",
                    "compound": "Jayd",
                    "developer": "Saudi Egyptian Developers (SED)",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 6898000,
                    "pricePerSqm": 45986,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 64668
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/283/high.webp",
                    "description": "Discover Saudi Egyptian Developers (SED)'s Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC30",
                    "title": "Lake View Residence - Golden Square",
                    "type": "Duplex",
                    "location": "Golden Square",
                    "compound": "Lake View Residence",
                    "developer": "Lake View Development",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 8850000,
                    "pricePerSqm": 59000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 82968
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/691/high.webp",
                    "description": "Discover Lake View Development's Properties in Golden Square"
                },
                {
                    "id": "NC31",
                    "title": "Mountain View Hyde Park - New Cairo",
                    "type": "Townhouse",
                    "location": "New Cairo",
                    "compound": "Mountain View Hyde Park",
                    "developer": "Mountain View",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 28652143,
                    "pricePerSqm": 191014,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 268613
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/50/high.webp",
                    "description": "Discover Mountain View's Properties in New Cairo – With Financing Up to 7 Years"
                },
                {
                    "id": "NC32",
                    "title": "Madinaty - Madinaty",
                    "type": "Villa",
                    "location": "Madinaty",
                    "compound": "Madinaty",
                    "developer": "Talaat Moustafa Group (TMG) Holding",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 3600000,
                    "pricePerSqm": 24000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 33750
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1765/high.webp",
                    "description": "Discover Talaat Moustafa Group (TMG) Holding's Properties in Madinaty"
                },
                {
                    "id": "NC33",
                    "title": "Katameya Heights - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Katameya Heights",
                    "developer": "Starlight Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 155000000,
                    "pricePerSqm": 1033333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 1453125
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/325/high.webp",
                    "description": "Discover Starlight Developments's Properties in New Cairo"
                },
                {
                    "id": "NC34",
                    "title": "Katameya Dunes - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Katameya Dunes",
                    "developer": "Starlight Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 72500000,
                    "pricePerSqm": 483333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 679687
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/327/high.webp",
                    "description": "Discover Starlight Developments's Properties in New Cairo"
                },
                {
                    "id": "NC35",
                    "title": "Lake View - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Lake View",
                    "developer": "Lake View Development",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 10400000,
                    "pricePerSqm": 69333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 97500
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/282/high.webp",
                    "description": "Discover Lake View Development's Properties in New Cairo"
                },
                {
                    "id": "NC36",
                    "title": "Cairo Festival City - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Cairo Festival City",
                    "developer": "Al-Futtaim Group Real Estate",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14500000,
                    "pricePerSqm": 96666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 135937
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1044/high.webp",
                    "description": "Discover Al-Futtaim Group Real Estate's Properties in New Cairo"
                },
                {
                    "id": "NC37",
                    "title": "Palm Hills Katameya Extension (PK2) - Golden Square",
                    "type": "Villa",
                    "location": "Golden Square",
                    "compound": "Palm Hills Katameya Extension (PK2)",
                    "developer": "Palm Hills Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 8200000,
                    "pricePerSqm": 54666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 76875
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/349/high.webp",
                    "description": "Discover Palm Hills Developments's Properties in Golden Square – With Financing Up to 3 Years"
                },
                {
                    "id": "NC38",
                    "title": "Stone Park - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Stone Park",
                    "developer": "Roya Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 7263300,
                    "pricePerSqm": 48422,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 68093
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/7935/high.webp",
                    "description": "Discover Roya Developments's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC39",
                    "title": "Mivida - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Mivida",
                    "developer": "Emaar Misr",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 8350000,
                    "pricePerSqm": 55666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 78281
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/6/high.webp",
                    "description": "Discover Emaar Misr's Properties in New Cairo"
                },
                {
                    "id": "NC40",
                    "title": "Villette - Golden Square",
                    "type": "Villa",
                    "location": "Golden Square",
                    "compound": "Villette",
                    "developer": "SODIC",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 21203000,
                    "pricePerSqm": 141353,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 198778
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/214/high.webp",
                    "description": "Discover SODIC's Properties in Golden Square – With Financing Up to 10 Years"
                },
                {
                    "id": "NC41",
                    "title": "Swanlake Residences - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Swanlake Residences",
                    "developer": "Hassan Allam Properties",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 19100000,
                    "pricePerSqm": 127333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 179062
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1646/high.webp",
                    "description": "Discover Hassan Allam Properties's Properties in New Cairo – With Financing Up to 10 Years"
                },
                {
                    "id": "NC42",
                    "title": "Layan - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Layan",
                    "developer": "Manazel Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 16500000,
                    "pricePerSqm": 110000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 154687
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1490/high.webp",
                    "description": "Discover Manazel Developments's Properties in New Cairo"
                },
                {
                    "id": "NC43",
                    "title": "Ninety Avenue - North Investors",
                    "type": "Duplex",
                    "location": "North Investors",
                    "compound": "Ninety Avenue",
                    "developer": "TBK Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 9774689,
                    "pricePerSqm": 65164,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 91637
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/754/high.webp",
                    "description": "Discover TBK Developments's Properties in North Investors – With Financing Up to 3 Years"
                },
                {
                    "id": "NC44",
                    "title": "The Village Gate - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "The Village Gate",
                    "developer": "Palm Hills Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 5500000,
                    "pricePerSqm": 36666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 51562
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/354/high.webp",
                    "description": "Discover Palm Hills Developments's Properties in New Cairo"
                },
                {
                    "id": "NC45",
                    "title": "The Village - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "The Village",
                    "developer": "Palm Hills Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 5200000,
                    "pricePerSqm": 34666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 48750
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/363/high.webp",
                    "description": "Discover Palm Hills Developments's Properties in New Cairo"
                },
                {
                    "id": "NC46",
                    "title": "The Waterway - New Cairo - North Investors",
                    "type": "Duplex",
                    "location": "North Investors",
                    "compound": "The Waterway - New Cairo",
                    "developer": "The Waterway Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14000000,
                    "pricePerSqm": 93333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 131250
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/2128/high.webp",
                    "description": "Discover The Waterway Developments's Properties in North Investors"
                },
                {
                    "id": "NC47",
                    "title": "El Patio 7 - New Cairo",
                    "type": "Penthouse",
                    "location": "New Cairo",
                    "compound": "El Patio 7",
                    "developer": "La Vista Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 18150000,
                    "pricePerSqm": 121000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 170156
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/7297/high.webp",
                    "description": "Discover La Vista Developments's Properties in New Cairo – With Financing Up to 3 Years"
                },
                {
                    "id": "NC48",
                    "title": "Village Garden Katameya - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Village Garden Katameya",
                    "developer": "Palm Hills Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 7800000,
                    "pricePerSqm": 52000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 73125
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/311/high.webp",
                    "description": "Discover Palm Hills Developments's Properties in New Cairo"
                },
                {
                    "id": "NC49",
                    "title": "The Square - New Cairo",
                    "type": "Townhouse",
                    "location": "New Cairo",
                    "compound": "The Square",
                    "developer": "Al Ahly Sabbour Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 3300000,
                    "pricePerSqm": 22000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 30937
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/317/high.webp",
                    "description": "Discover Al Ahly Sabbour Developments's Properties in New Cairo – With Financing Up to 3 Years"
                },
                {
                    "id": "NC50",
                    "title": "Mirage City - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Mirage City",
                    "developer": "Mirage City",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 75000000,
                    "pricePerSqm": 500000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 703125
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/328/high.webp",
                    "description": "Discover Mirage City's Properties in New Cairo"
                },
                {
                    "id": "NC51",
                    "title": "Katameya Residence - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Katameya Residence",
                    "developer": "Al Ahly Sabbour Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 61500000,
                    "pricePerSqm": 410000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 576562
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/332/high.webp",
                    "description": "Discover Al Ahly Sabbour Developments's Properties in New Cairo"
                },
                {
                    "id": "NC52",
                    "title": "Palm Hills Katameya (PK1) - Golden Square",
                    "type": "Villa",
                    "location": "Golden Square",
                    "compound": "Palm Hills Katameya (PK1)",
                    "developer": "Palm Hills Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 32000000,
                    "pricePerSqm": 213333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 300000
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/342/high.webp",
                    "description": "Discover Palm Hills Developments's Properties in Golden Square"
                },
                {
                    "id": "NC53",
                    "title": "Village Avenue - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Village Avenue",
                    "developer": "Palm Hills Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 17500000,
                    "pricePerSqm": 116666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 164062
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/361/high.webp",
                    "description": "Discover Palm Hills Developments's Properties in New Cairo"
                },
                {
                    "id": "NC54",
                    "title": "L’Avenir - Mostakbal City",
                    "type": "Duplex",
                    "location": "Mostakbal City",
                    "compound": "L’Avenir",
                    "developer": "Al Ahly Sabbour Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 3600000,
                    "pricePerSqm": 24000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 33750
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/11219/high.webp",
                    "description": "Discover Al Ahly Sabbour Developments's Properties in Mostakbal City"
                },
                {
                    "id": "NC55",
                    "title": "Les Rois New Cairo - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Les Rois New Cairo",
                    "developer": "Housing and Development Properties HDP",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 32000000,
                    "pricePerSqm": 213333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 300000
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/694/high.webp",
                    "description": "Discover Housing and Development Properties HDP's Properties in New Cairo"
                },
                {
                    "id": "NC56",
                    "title": "Sarai - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Sarai",
                    "developer": "Madinet Masr ",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 4017858,
                    "pricePerSqm": 26785,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 37667
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1422/high.webp",
                    "description": "Discover Madinet Masr 's Properties in New Cairo – With Financing Up to 12 Years"
                },
                {
                    "id": "NC57",
                    "title": "Mountain View One - North Investors",
                    "type": "Villa",
                    "location": "North Investors",
                    "compound": "Mountain View One",
                    "developer": "Mountain View",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 75000000,
                    "pricePerSqm": 500000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 703125
                    },
                    "image": "https://prod-images.nawy.com/processed/inventory/compounds/168/gallery/10%20Pool%20Club%20House/high.webp",
                    "description": "Discover Mountain View's Properties in North Investors"
                },
                {
                    "id": "NC58",
                    "title": "Fountain Park - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Fountain Park",
                    "developer": "Orientals for Urban Development",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 27675000,
                    "pricePerSqm": 184500,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 259453
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1012/high.webp",
                    "description": "Discover Orientals for Urban Development's Properties in New Cairo"
                },
                {
                    "id": "NC59",
                    "title": "Taj City - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Taj City",
                    "developer": "Madinet Masr ",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 5052232,
                    "pricePerSqm": 33681,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 47364
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1059/high.webp",
                    "description": "Discover Madinet Masr 's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC60",
                    "title": "La Rose New Cairo - New Cairo",
                    "type": "Twinhouse",
                    "location": "New Cairo",
                    "compound": "La Rose New Cairo",
                    "developer": "La Rose",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 26000000,
                    "pricePerSqm": 173333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 243750
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1063/high.webp",
                    "description": "Discover La Rose's Properties in New Cairo"
                },
                {
                    "id": "NC61",
                    "title": "Zizinia Gardens - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Zizinia Gardens",
                    "developer": "ARDIC For Real Estate Development",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 7350000,
                    "pricePerSqm": 49000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 68906
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1066/high.webp",
                    "description": "Discover ARDIC For Real Estate Development's Properties in New Cairo"
                },
                {
                    "id": "NC62",
                    "title": "HAPTown - Mostakbal City",
                    "type": "Villa",
                    "location": "Mostakbal City",
                    "compound": "HAPTown",
                    "developer": "Hassan Allam Properties",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 11200000,
                    "pricePerSqm": 74666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 105000
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1561/high.webp",
                    "description": "Discover Hassan Allam Properties's Properties in Mostakbal City – With Financing Up to 8 Years"
                },
                {
                    "id": "NC63",
                    "title": "Trio - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Trio",
                    "developer": "M Squared",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14282964,
                    "pricePerSqm": 95219,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 133902
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/7091/high.webp",
                    "description": "Discover M Squared's Properties in New Cairo – With Financing Up to 3 Years"
                },
                {
                    "id": "NC64",
                    "title": "Galleria - South Investors",
                    "type": "Duplex",
                    "location": "South Investors",
                    "compound": "Galleria",
                    "developer": "Arabia Holding",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 12600000,
                    "pricePerSqm": 84000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 118125
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/2098/high.webp",
                    "description": "Discover Arabia Holding's Properties in South Investors – With Financing Up to 5 Years"
                },
                {
                    "id": "NC65",
                    "title": "The City of Odyssia - Mostakbal City",
                    "type": "Townhouse",
                    "location": "Mostakbal City",
                    "compound": "The City of Odyssia",
                    "developer": "Al Ahly Sabbour Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 18727000,
                    "pricePerSqm": 124846,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 175565
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1242/high.webp",
                    "description": "Discover Al Ahly Sabbour Developments's Properties in Mostakbal City – With Financing Up to 7 Years"
                },
                {
                    "id": "NC66",
                    "title": "Aria - Mostakbal City",
                    "type": "Apartment",
                    "location": "Mostakbal City",
                    "compound": "Aria",
                    "developer": "LMD",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 4300000,
                    "pricePerSqm": 28666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 40312
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1244/high.webp",
                    "description": "Discover LMD's Properties in Mostakbal City"
                },
                {
                    "id": "NC67",
                    "title": "Address East - New Cairo",
                    "type": "Twinhouse",
                    "location": "New Cairo",
                    "compound": "Address East",
                    "developer": "Dorra Group",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 6100000,
                    "pricePerSqm": 40666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 57187
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1303/high.webp",
                    "description": "Discover Dorra Group's Properties in New Cairo"
                },
                {
                    "id": "NC68",
                    "title": "La Fontaine Province - New Cairo",
                    "type": "Townhouse",
                    "location": "New Cairo",
                    "compound": "La Fontaine Province",
                    "developer": "ARCO",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 8000000,
                    "pricePerSqm": 53333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 75000
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1531/high.webp",
                    "description": "Discover ARCO's Properties in New Cairo"
                },
                {
                    "id": "NC69",
                    "title": "Maxim Country Clubhouse - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Maxim Country Clubhouse",
                    "developer": "Maxim Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 32000000,
                    "pricePerSqm": 213333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 300000
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1766/high.webp",
                    "description": "Discover Maxim Developments's Properties in New Cairo"
                },
                {
                    "id": "NC70",
                    "title": "5A  Administrative - El Choueifat",
                    "type": "Office",
                    "location": "El Choueifat",
                    "compound": "5A  Administrative",
                    "developer": "The Waterway Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 41800000,
                    "pricePerSqm": 278666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 391875
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/1966/high.webp",
                    "description": "Discover The Waterway Developments's Properties in El Choueifat"
                },
                {
                    "id": "NC71",
                    "title": "Three Sixty - New Cairo",
                    "type": "Office",
                    "location": "New Cairo",
                    "compound": "Three Sixty",
                    "developer": "LMD",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 8448000,
                    "pricePerSqm": 56320,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 79200
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/8075/high.webp",
                    "description": "Discover LMD's Properties in New Cairo – With Financing Up to 6 Years"
                },
                {
                    "id": "NC72",
                    "title": "One - Ninety - New Cairo",
                    "type": "Townhouse",
                    "location": "New Cairo",
                    "compound": "One - Ninety",
                    "developer": "LMD",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 20689185,
                    "pricePerSqm": 137927,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 193961
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/5342/high.webp",
                    "description": "Discover LMD's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC73",
                    "title": "Green Square - Mostakbal City",
                    "type": "Townhouse",
                    "location": "Mostakbal City",
                    "compound": "Green Square",
                    "developer": "Al Ahly Sabbour Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 3500000,
                    "pricePerSqm": 23333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 32812
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/11005/high.webp",
                    "description": "Discover Al Ahly Sabbour Developments's Properties in Mostakbal City"
                },
                {
                    "id": "NC74",
                    "title": "Katameya Creeks - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Katameya Creeks",
                    "developer": "Starlight Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 29340000,
                    "pricePerSqm": 195600,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 275062
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/361/high.webp",
                    "description": "Discover Starlight Developments's Properties in New Cairo – With Financing Up to 5 Years"
                },
                {
                    "id": "NC75",
                    "title": "Cairo Business Park - New Cairo",
                    "type": "Twinhouse",
                    "location": "New Cairo",
                    "compound": "Cairo Business Park",
                    "developer": "Misr Italia Properties",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 12200000,
                    "pricePerSqm": 81333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 114375
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/7709/high.webp",
                    "description": "Discover Misr Italia Properties's Properties in New Cairo – With Financing Up to 7 Years"
                },
                {
                    "id": "NC76",
                    "title": "The HUB  Waterway New Cairo - New Cairo",
                    "type": "Office",
                    "location": "New Cairo",
                    "compound": "The HUB  Waterway New Cairo",
                    "developer": "The Waterway Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14484000,
                    "pricePerSqm": 96560,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 135787
                    },
                    "image": "https://www.nawy.com/assets/images/common/broken.webp",
                    "description": "Discover The Waterway Developments's Properties in New Cairo – With Financing Up to 4 Years"
                },
                {
                    "id": "NC77",
                    "title": "The Waterway Villas - North Investors",
                    "type": "Villa",
                    "location": "North Investors",
                    "compound": "The Waterway Villas",
                    "developer": "The Waterway Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 37000000,
                    "pricePerSqm": 246666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 346875
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/7404/high.webp",
                    "description": "Discover The Waterway Developments's Properties in North Investors – With Financing Up to 2 Years"
                },
                {
                    "id": "NC78",
                    "title": "Al Jazi First Marriott Residences - North Investors",
                    "type": "Apartment",
                    "location": "North Investors",
                    "compound": "Al Jazi First Marriott Residences",
                    "developer": "Al Jazi Egypt",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14200000,
                    "pricePerSqm": 94666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 133125
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/2228/high.webp",
                    "description": "Discover Al Jazi Egypt's Properties in North Investors – With Financing Up to 5 Years"
                },
                {
                    "id": "NC79",
                    "title": "Kinda - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Kinda",
                    "developer": "Madinet Masr ",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 7000000,
                    "pricePerSqm": 46666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 65625
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/2309/high.webp",
                    "description": "Discover Madinet Masr 's Properties in New Cairo – With Financing Up to 7 Years"
                },
                {
                    "id": "NC80",
                    "title": "La Nuova Vista - North Investors",
                    "type": "Villa",
                    "location": "North Investors",
                    "compound": "La Nuova Vista",
                    "developer": "Misr Italia Properties",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 26000000,
                    "pricePerSqm": 173333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 243750
                    },
                    "image": "https://prod-images.nawy.com/processed/compound_image/image/2381/high.webp",
                    "description": "Discover Misr Italia Properties's Properties in North Investors"
                },
                {
                    "id": "NC81",
                    "title": "Hyde Park Central - 6th settlement",
                    "type": "Villa",
                    "location": "6th settlement",
                    "compound": "Hyde Park Central",
                    "developer": "Hyde Park",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 8700000,
                    "pricePerSqm": 58000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 81562
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1495/high.webp",
                    "description": "Discover Hyde Park's Properties in 6th settlement – With Financing Up to 10 Years"
                },
                {
                    "id": "NC82",
                    "title": "Point 90 Mall - New Cairo",
                    "type": "Office",
                    "location": "New Cairo",
                    "compound": "Point 90 Mall",
                    "developer": "PRE Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 12307000,
                    "pricePerSqm": 82046,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 115378
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1496/high.webp",
                    "description": "Discover PRE Developments's Properties in New Cairo – With Financing Up to 7 Years"
                },
                {
                    "id": "NC83",
                    "title": "Azzar Legacy - New Cairo",
                    "type": "Townhouse",
                    "location": "New Cairo",
                    "compound": "Azzar Legacy",
                    "developer": "Reedy Group",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14110000,
                    "pricePerSqm": 94066,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 132281
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1498/high.webp",
                    "description": "Discover Reedy Group's Properties in New Cairo – With Financing Up to 10 Years"
                },
                {
                    "id": "NC84",
                    "title": "Acasa - New Cairo",
                    "type": "Apartment",
                    "location": "New Cairo",
                    "compound": "Acasa",
                    "developer": "Dar  Al Alamia Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 6500000,
                    "pricePerSqm": 43333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 60937
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1500/high.webp",
                    "description": "Discover Dar  Al Alamia Developments's Properties in New Cairo"
                },
                {
                    "id": "NC85",
                    "title": "Peerage - New Cairo",
                    "type": "Duplex",
                    "location": "New Cairo",
                    "compound": "Peerage",
                    "developer": "Al Riyadh Misr",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 5500000,
                    "pricePerSqm": 36666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 51562
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1512/high.webp",
                    "description": "Discover Al Riyadh Misr's Properties in New Cairo – With Financing Up to 7 Years"
                },
                {
                    "id": "NC86",
                    "title": "Grisya Hyde Park - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Grisya Hyde Park",
                    "developer": "Hyde Park",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 31560000,
                    "pricePerSqm": 210400,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 295875
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1528/high.webp",
                    "description": "Discover Hyde Park's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC87",
                    "title": "Aster - New Cairo",
                    "type": "Duplex",
                    "location": "New Cairo",
                    "compound": "Aster",
                    "developer": "Times Development",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14240000,
                    "pricePerSqm": 94933,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 133500
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1628/high.webp",
                    "description": "Discover Times Development's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC88",
                    "title": "Yellow - New Cairo",
                    "type": "Office",
                    "location": "New Cairo",
                    "compound": "Yellow",
                    "developer": "Urbnlanes Development",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 18600000,
                    "pricePerSqm": 124000,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 174375
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1653/high.webp",
                    "description": "Discover Urbnlanes Development's Properties in New Cairo – With Financing Up to 7 Years"
                },
                {
                    "id": "NC89",
                    "title": "Eastshire - New Cairo",
                    "type": "Villa",
                    "location": "New Cairo",
                    "compound": "Eastshire",
                    "developer": "Al Ahly Sabbour Developments",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 17314000,
                    "pricePerSqm": 115426,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 162318
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1658/high.webp",
                    "description": "Discover Al Ahly Sabbour Developments's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC90",
                    "title": "Axle - New Cairo",
                    "type": "Office",
                    "location": "New Cairo",
                    "compound": "Axle",
                    "developer": "MG DEVELOPMENTS",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 14000000,
                    "pricePerSqm": 93333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 131250
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1666/high.webp",
                    "description": "Discover MG DEVELOPMENTS's Properties in New Cairo – With Financing Up to 5 Years"
                },
                {
                    "id": "NC91",
                    "title": "Amara - New Cairo",
                    "type": "Duplex",
                    "location": "New Cairo",
                    "compound": "Amara",
                    "developer": "New Plan",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 21800000,
                    "pricePerSqm": 145333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 204375
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1715/high.webp",
                    "description": "Discover New Plan's Properties in New Cairo – With Financing Up to 8 Years"
                },
                {
                    "id": "NC92",
                    "title": "Il Bosco City - Mostakbal City",
                    "type": "Villa",
                    "location": "Mostakbal City",
                    "compound": "Il Bosco City",
                    "developer": "Misr Italia Properties",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 6200000,
                    "pricePerSqm": 41333,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 58125
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1723/high.webp",
                    "description": "Discover Misr Italia Properties's Properties in Mostakbal City – With Financing Up to 9 Years"
                },
                {
                    "id": "NC93",
                    "title": "The Rift - Mostakbal City",
                    "type": "Office",
                    "location": "Mostakbal City",
                    "compound": "The Rift",
                    "developer": "LMD",
                    "area": 150,
                    "bedrooms": 3,
                    "bathrooms": 2,
                    "price": 16600000,
                    "pricePerSqm": 110666,
                    "deliveryDate": "2026",
                    "paymentPlan": {
                        "downPayment": 10,
                        "installmentYears": 8,
                        "monthlyInstallment": 155625
                    },
                    "image": "https://prod-images.nawy.com/processed/compound/cover_image/1739/high.webp",
                    "description": "Discover LMD's Properties in Mostakbal City – With Financing Up to 7 Years"
                }
            ]
        };

        // Load Egyptian Real Estate Data
        async function loadEgyptianData() {
            // Data is now embedded to avoid CORS issues
            console.log('✅ Real Estate Database loaded successfully!');
            console.log(`📊 Loaded ${egyptianData.properties?.length || 0} properties`);
        }

        // Build RAG context from real estate data based on user message
        function buildContextForAI(userMessage) {
            if (!egyptianData) return '';

            // Shuffle function to vary property order each time
            function shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            let context = '\n\nالبيانات المتاحة (استخدم هذه البيانات فقط):\n\n';
            const message = userMessage.toLowerCase();

            // Location-based context
            const locations = {
                'المستقبل': 'مدينة المستقبل',
                'مستقبل': 'مدينة المستقبل',
                'mostakbal': 'مدينة المستقبل',
                'التجمع': 'التجمع الخامس',
                'تجمع': 'التجمع الخامس',
                'العاصمة': 'العاصمة الإدارية',
                'الإدارية': 'العاصمة الإدارية',
                'أكتوبر': '6 أكتوبر',
                'مدينتي': 'مدينتي',
                'زايد': 'الشيخ زايد'
            };

            let foundLocation = false;
            for (let [keyword, location] of Object.entries(locations)) {
                if (message.includes(keyword)) {
                    foundLocation = true;
                    // Add market trends
                    if (egyptianData.marketTrends && egyptianData.marketTrends[location]) {
                        context += `📍 معلومات سوق ${location}: \n`;
                        const trends = egyptianData.marketTrends[location];
                        context += `- متوسط سعر المتر: ${trends.avgPricePerSqm.toLocaleString()} جنيه\n`;
                        context += `- معدل النمو السنوي: ${trends.yearlyGrowth}%\n`;
                        context += `- مستوى الطلب: ${trends.demandLevel} \n`;
                        context += `- أشهر المطورين: ${trends.topDevelopers.join(', ')} \n`;
                        if (trends.popularCompounds) {
                            context += `- الكمباوندات المشهورة: ${trends.popularCompounds.join(', ')} \n`;
                        }
                        context += '\n';
                    }

                    // Add relevant properties with detailed formatting
                    if (egyptianData.properties) {
                        const props = egyptianData.properties.filter(p => p.location.includes(location));
                        if (props.length > 0) {
                            context += `عقارات متاحة في ${location}:\n\n`;
                            shuffleArray(props).slice(0, 5).forEach(p => {
                                context += `${p.title}\n`;
                                context += `النوع: ${p.type} | المساحة: ${p.area}م² | الغرف: ${p.bedrooms}\n`;
                                context += `السعر: ${(p.price / 1000000).toFixed(2)} مليون جنيه\n`;
                                context += `الكمباوند: ${p.compound} | المطور: ${p.developer}\n`;
                                context += `الاستلام: ${p.deliveryDate}\n`;
                                context += `خطة الدفع: مقدم ${p.paymentPlan.downPayment}%، قسط شهري
                ${p.paymentPlan.monthlyInstallment.toLocaleString()} جنيه على ${p.paymentPlan.installmentYears}
                سنين\n`;
                                context += `العائد الاستثماري: ${p.totalROI}%\n`;
                                context += `---\n`;
                            });
                        }
                    }
                    break;
                }
            }

            // Budget-based context
            const budgetMatch = message.match(/(\d+)\s*مليون/);
            if (budgetMatch && egyptianData.properties) {
                const budget = parseInt(budgetMatch[1]) * 1000000;
                const relevant = egyptianData.properties.filter(
                    p => p.price >= budget * 0.7 && p.price <= budget * 1.4); if (relevant.length > 0 && !foundLocation) {
                        context += `عقارات مناسبة للميزانية (${budgetMatch[1]} مليون):\n\n`;
                        shuffleArray(relevant).slice(0, 3).forEach(p => {
                            context += `${p.title}\n`;
                            context += `السعر: ${(p.price / 1000000).toFixed(2)} مليون | المساحة: ${p.area}م² |
                    ${p.location}\n`;
                            context += `مقدم ${p.paymentPlan.downPayment}% + قسط
                    ${p.paymentPlan.monthlyInstallment.toLocaleString()} جنيه/${p.paymentPlan.installmentYears}
                    سنين\n`;
                            context += `ROI: ${p.totalROI}% | ${p.compound}\n---\n`;
                        });
                    }
            }

            // Investment context
            if (message.includes('استثمار') || message.includes('استثمر') || message.includes('عائد')) {
                if (egyptianData.properties && !foundLocation && !budgetMatch) {
                    const topInvestments = shuffleArray(egyptianData.properties
                        .sort((a, b) => b.totalROI - a.totalROI)
                        .slice(0, 6))
                        .slice(0, 3);
                    context += 'أفضل فرص الاستثمار:\n\n';
                    topInvestments.forEach(p => {
                        context += `${p.title}\n`;
                        context += `السعر: ${(p.price / 1000000).toFixed(2)} مليون | ROI: ${p.totalROI}% سنوياً\n`;
                        context += `${p.compound} - ${p.location}\n---\n`;
                    });
                }
            }

            // Compound/Developer Search
            if (egyptianData.properties && !foundLocation && !budgetMatch) {
                const searchTerms = message.split(' ');
                const foundProperties = egyptianData.properties.filter(p => {
                    return searchTerms.some(term =>
                        term.length > 3 && (
                            p.compound.toLowerCase().includes(term) ||
                            p.developer.toLowerCase().includes(term)
                        )
                    );
                });

                if (foundProperties.length > 0) {
                    context += 'عقارات مرتبطة ببحثك:\n\n';
                    shuffleArray(foundProperties).slice(0, 3).forEach(p => {
                        context += `${p.title}\n`;
                        context += `${p.type} ${p.area}م² | ${(p.price / 1000000).toFixed(2)} مليون جنيه\n`;
                        context += `${p.compound} - ${p.developer}\n---\n`;
                    });
                }
            }

            // If no specific context, add general overview
            if (context === '\n\nالبيانات المتاحة (استخدم هذه البيانات فقط):\n\n') {
                if (egyptianData.marketTrends) {
                    context += 'نظرة عامة على السوق:\n\n';
                    Object.entries(egyptianData.marketTrends).forEach(([location, data]) => {
                        context += `${location}: متوسط ${data.avgPricePerSqm.toLocaleString()} جنيه/م² | نمو
                    ${data.yearlyGrowth}%\n`;
                    });
                    context += '\n';
                }

                // Add random properties sample
                if (egyptianData.properties) {
                    context += 'عقارات متاحة:\n\n';
                    shuffleArray(egyptianData.properties).slice(0, 3).forEach(p => {
                        context += `${p.type} ${p.area}م² في ${p.compound}\n`;
                        context += `${(p.price / 1000000).toFixed(2)} مليون جنيه | ${p.location}\n---\n`;
                    });
                }
            }

            // Add instructions for using data
            context += '\nتعليمات مهمة:\n';
            context += '1. استخدم البيانات أعلاه فقط\n';
            context += '2. ممنوع تعرض ID أو كود العقار للعميل\n';
            context += '3. لو مش لاقي عقار مناسب، قول بصراحة\n';
            context += '4. نوّع العقارات اللي بتعرضها كل مرة\n';

            return context;
        }

        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // SMART CACHE SYSTEM 💾
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

        const CACHE_CONFIG = {
            enabled: true,
            ttl: 24 * 60 * 60 * 1000, // 24 hours
            maxEntries: 100,
            storageKey: 'amr_ai_cache'
        };

        // Generate cache key from normalized message
        function getCacheKey(message) {
            const normalized = message
                .toLowerCase()
                .trim()
                .replace(/[؟?!.،,]/g, '')  // Remove punctuation
                .replace(/\s+/g, ' ');      // Normalize whitespace

            // Simple hash function
            let hash = 0;
            for (let i = 0; i < normalized.length; i++) {
                hash = ((hash << 5) - hash) + normalized.charCodeAt(i);
                hash = hash & hash; // Convert to 32bit integer
            }
            return `cache_${Math.abs(hash)}`;
        }

        // Get cached response
        function getCachedResponse(message) {
            if (!CACHE_CONFIG.enabled) return null;

            try {
                const cache = JSON.parse(localStorage.getItem(CACHE_CONFIG.storageKey) || '{}');
                const key = getCacheKey(message);
                const entry = cache[key];

                if (!entry) return null;

                // Check if expired
                const age = Date.now() - entry.timestamp;
                if (age > CACHE_CONFIG.ttl) {
                    delete cache[key];
                    localStorage.setItem(CACHE_CONFIG.storageKey, JSON.stringify(cache));
                    return null;
                }

                // Update hit count
                entry.hits = (entry.hits || 0) + 1;
                cache[key] = entry;
                localStorage.setItem(CACHE_CONFIG.storageKey, JSON.stringify(cache));

                console.log(`✅ Cache HIT for "${message.substring(0, 30)}..." (${entry.hits} hits)`);
                return entry.response;

            } catch (e) {
                console.warn('Cache read error:', e);
                return null;
            }
        }

        // Save response to cache
        function saveToCache(message, response) {
            if (!CACHE_CONFIG.enabled || !response) return;

            try {
                let cache = JSON.parse(localStorage.getItem(CACHE_CONFIG.storageKey) || '{}');

                // Prune old entries if cache is full
                const entries = Object.entries(cache);
                if (entries.length >= CACHE_CONFIG.maxEntries) {
                    // Remove oldest 20% of entries
                    const sorted = entries.sort((a, b) => a[1].timestamp - b[1].timestamp);
                    const toRemove = Math.floor(CACHE_CONFIG.maxEntries * 0.2);
                    sorted.slice(0, toRemove).forEach(([key]) => delete cache[key]);
                }

                const key = getCacheKey(message);
                cache[key] = {
                    query: message.substring(0, 100),  // Store first 100 chars for debugging
                    response: response,
                    timestamp: Date.now(),
                    hits: 0
                };

                localStorage.setItem(CACHE_CONFIG.storageKey, JSON.stringify(cache));
                console.log(`💾 Cached response for "${message.substring(0, 30)}..."`);

            } catch (e) {
                console.warn('Cache write error:', e);
            }
        }

        // Clear cache (call from console or admin panel)
        window.clearAICache = function () {
            localStorage.removeItem(CACHE_CONFIG.storageKey);
            console.log('🗑️ AI cache cleared');
        };

        // Call Google Gemini API
        async function callGeminiAPI(userMessage) {
            // ✅ CHECK CACHE FIRST
            const cachedResponse = getCachedResponse(userMessage);
            if (cachedResponse) {
                return cachedResponse;  // Return immediately without API call
            }

            if (!AI_CONFIG.apiKey) {
                throw new Error('API_KEY_MISSING');
            }

            // Build context from real estate data
            const dataContext = buildContextForAI(userMessage);

            // 🧠 Build User Profile Context for Memory-Aware AI
            let userProfileContext = '';
            if (window.userProfile) {
                const profile = window.userProfile;
                userProfileContext = '\n\n🧠 USER PROFILE (ملف العميل المحفوظ):\n';

                if (profile.preferredLocations.length > 0) {
                    userProfileContext += `- المناطق المفضلة: ${profile.preferredLocations.join(', ')}\n`;
                }
                if (profile.preferredTypes.length > 0) {
                    userProfileContext += `- أنواع العقارات المفضلة: ${profile.preferredTypes.join(', ')}\n`;
                }
                if (profile.budgetMax) {
                    userProfileContext += `- الميزانية المعروفة: ${(profile.budgetMax / 1000000).toFixed(1)} مليون جنيه\n`;
                }
                if (profile.searchHistory.length > 0) {
                    const lastSearch = profile.searchHistory[profile.searchHistory.length - 1];
                    userProfileContext += `- آخر بحث: "${lastSearch.query}"\n`;
                }

                userProfileContext += '\n⚠️ استخدم المعلومات دي عشان تفهم العميل أحسن ومتسألش أسئلة هو جاوب عليها قبل كده!\n';
            }

            // Prepare messages for Gemini with enhanced memory instructions
            const fullPrompt = SYSTEM_PROMPT + dataContext + userProfileContext + '\n\n---\n\n';

            // Build conversation context with EXPLICIT memory instructions
            let conversationText = fullPrompt;

            // Add conversation history (last 10 messages)
            const recentHistory = conversationHistory.slice(-10);
            if (recentHistory.length > 0) {
                conversationText += '\n📝 CONVERSATION HISTORY (تاريخ المحادثة):\n';
                conversationText += 'هذا ملخص المحادثة السابقة - استخدمها لتتذكر ما قاله العميل:\n\n';

                recentHistory.forEach((msg, index) => {
                    if (msg.role === 'user') {
                        conversationText += `[${index + 1}] العميل قال: ${msg.content} \n`;
                    } else {
                        conversationText += `[${index + 1}] أنت رديت: ${msg.content} \n`;
                    }
                });

                conversationText += '\n⚠️ CRITICAL: اقرأ المحادثة السابقة كويس! العميل ممكن يكون قال ميزانيته أو المنطقة اللي عايزها.ما تسألش تاني عن حاجة قالها!\n\n';
                conversationText += '---\n\n';
            }

            // Add current message
            conversationText += `الرسالة الجديدة من العميل: \n${userMessage} \n\nردك كـ عمرو: `;

            // MODEL DEFINITIONS FOR FALLBACK CHAIN 🔗
            const models = [
                'gemini-1.5-flash',                 // 0. HIGH QUOTA: 1500 req/min free tier ⚡
                'gemini-1.5-pro',                   // 1. Backup Pro
                'gemini-2.5-flash',                 // 2. Newest Flash (lower quota)
                'gemini-flash-latest',              // 3. Stable Flash
                'gemini-pro-latest',                // 4. Stable Pro
                'gemini-2.0-flash-lite-preview-02-05', // 5. Lite fallback
                'gemini-2.5-flash-preview-09-2025'  // 6. Preview
            ];

            let lastError = null;

            // Prepare the request body once
            const requestBody = {
                contents: [{
                    role: 'user',
                    parts: [{ text: conversationText }]
                }],
                generationConfig: {
                    temperature: AI_CONFIG.temperature,
                    topK: AI_CONFIG.topK,
                    topP: AI_CONFIG.topP,
                    maxOutputTokens: AI_CONFIG.maxOutputTokens,
                },
            };

            // Try models in sequence
            for (const model of models) {
                try {
                    console.log(`🤖 Attempting connection to ${model}...`);
                    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${AI_CONFIG.apiKey}`;

                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(requestBody)
                    });

                    if (!response.ok) {
                        const errData = await response.json();
                        throw new Error(errData.error?.message || `HTTP ${response.status}`);
                    }

                    const data = await response.json();

                    if (data.candidates && data.candidates[0]?.content?.parts[0]?.text) {
                        let rawText = data.candidates[0].content.parts[0].text.trim();

                        // ============================================
                        // 🛠️ ROBUST TOOL CALL EXTRACTION
                        // ============================================
                        // Strategy 1: Check if entire response is pure JSON
                        if (rawText.startsWith('{') && rawText.endsWith('}')) {
                            try {
                                const cmd = JSON.parse(rawText);
                                if (cmd.tool && window.executeAiTool) {
                                    console.log('🤖 AI Tool Call (Pure JSON):', cmd.tool);
                                    const toolResult = window.executeAiTool(cmd.tool, cmd.args);
                                    if (toolResult) return toolResult;
                                }
                            } catch (e) {
                                // Not valid JSON, continue to next strategy
                            }
                        }

                        // Strategy 2: Extract embedded JSON from mixed text
                        // Handles cases like: "سأقوم بعرض... {"tool": "searchProperties"...}"
                        const jsonRegex = /\{[\s]*"tool"[\s]*:[\s]*"[^"]+?"[\s]*,[\s]*"args"[\s]*:[\s]*\{[^}]*\}[\s]*\}/g;
                        const matches = rawText.match(jsonRegex);

                        if (matches && matches.length > 0) {
                            try {
                                const cmd = JSON.parse(matches[0]);
                                if (cmd.tool && window.executeAiTool) {
                                    console.log('🤖 AI Tool Call (Extracted from text):', cmd.tool);
                                    const toolResult = window.executeAiTool(cmd.tool, cmd.args);
                                    if (toolResult) {
                                        // Remove the JSON from the text and return cleaned text + tool result
                                        let cleanedText = rawText.replace(matches[0], '').trim();
                                        // Remove common prefixes that lead to JSON
                                        cleanedText = cleanedText.replace(/سأقوم بعرض.*?الآن:?\s*/g, '').trim();
                                        cleanedText = cleanedText.replace(/سأبحث.*?لك:?\s*/g, '').trim();
                                        cleanedText = cleanedText.replace(/خليني أعرضلك.*?:?\s*/g, '').trim();

                                        // If there's remaining meaningful text, combine with tool result
                                        if (cleanedText.length > 10) {
                                            return cleanedText + '\n\n' + toolResult;
                                        }
                                        return toolResult;
                                    }
                                }
                            } catch (e) {
                                console.warn('Failed to parse extracted JSON:', e);
                            }
                        }

                        // ✅ SAVE TO CACHE before returning
                        saveToCache(userMessage, rawText);

                        return rawText; // Success! Return text
                    }

                } catch (error) {
                    console.warn(`⚠️ Model ${model} failed:`, error.message);
                    lastError = error;

                    // SMART RETRY: If rate limited (429), wait before trying next model
                    if (error.message.includes('429') || error.message.toLowerCase().includes('quota')) {
                        console.log('⏳ Rate limit hit. Cooling down for 4 seconds...');
                        await new Promise(r => setTimeout(r, 4000));
                    }

                    continue; // Try next model
                }
            }

            // IF WE REACH HERE, ALL MODELS FAILED -> OFFLINE FALLBACK 🧠
            console.warn('All online models failed. Switching to Offline Brain.');
            // Fallback logic
            let fallbackResponse = generateAmrResponse(userMessage);

            // CHECK FOR LOCAL TOOL CALLS IN FALLBACK
            if (fallbackResponse.trim().startsWith('{') && fallbackResponse.trim().endsWith('}')) {
                try {
                    const cmd = JSON.parse(fallbackResponse);
                    if (cmd.tool && window.executeAiTool) {
                        console.log('🤖 Offline Brain calling tool:', cmd.tool);
                        const toolResult = window.executeAiTool(cmd.tool, cmd.args);
                        if (toolResult) fallbackResponse = toolResult;
                    }
                } catch (e) { }
            }

            // Update history manually since we aren't returning from API
            conversationHistory.push(
                { role: 'user', content: userMessage },
                { role: 'assistant', content: fallbackResponse }
            );

            return fallbackResponse;
        }

        // Enhanced human-like typing simulation with punctuation-aware delays
        function typeMessage(text, sender, callback) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-${sender}`;

            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = 'message-bubble';
            bubbleDiv.style.minHeight = '20px';
            messageDiv.appendChild(bubbleDiv);

            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            let charIndex = 0;
            const chars = text.split('');
            let currentText = '';

            function typeNextChar() {
                if (charIndex < chars.length) {
                    const char = chars[charIndex];
                    currentText += char;
                    // Preserve emojis and formatting
                    bubbleDiv.innerText = currentText;
                    messagesDiv.scrollTop = messagesDiv.scrollHeight;
                    charIndex++;

                    // Base typing speed: 25-60ms per character
                    let typingSpeed = Math.random() * 35 + 25;

                    // Punctuation-aware pauses
                    if (char === '.' || char === '!' || char === '؟' || char === '。') {
                        typingSpeed = Math.random() * 200 + 300;
                    } else if (char === ',' || char === '،' || char === '؛') {
                        typingSpeed = Math.random() * 100 + 150;
                    } else if (char === '\n') {
                        typingSpeed = Math.random() * 80 + 100;
                    } else if (char === ' ') {
                        typingSpeed = Math.random() * 20 + 30;
                    }

                    // Occasional random "thinking" pauses
                    if (Math.random() > 0.95) {
                        typingSpeed += Math.random() * 300 + 200;
                    }

                    // Simulate occasional fast typing bursts
                    if (Math.random() > 0.9) {
                        typingSpeed = typingSpeed * 0.4;
                    }

                    setTimeout(typeNextChar, typingSpeed);
                } else {
                    if (callback) callback();
                }
            }

            typeNextChar();
        }

        // Global User State for Fallback Memory
        let userState = {
            budget: null,
            location: null,
            unitType: null,
            stage: 'initial' // initial, details, closing
        };

        // Enhanced Egyptian AI response generation with real data AND MEMORY
        function generateAmrResponse(userMessage) {
            const message = userMessage.toLowerCase();
            let response = "";
            let useData = false;

            // Update User State based on message
            if (message.includes('مستقبل') || message.includes('المستقبل') ||
                message.includes('mostakbal')) userState.location = 'مدينة المستقبل';
            if (message.includes('تجمع') || message.includes('fifth')) userState.location = 'التجمع الخامس';
            if (message.includes('عاصمة') || message.includes('capital')) userState.location = 'العاصمة الإدارية';
            if (message.includes('اكتوبر') || message.includes('october')) userState.location = '6 أكتوبر';
            if (message.includes('زايد') || message.includes('zayed')) userState.location = 'الشيخ زايد';

            const budgetMatch = message.match(/(\d+)\s*مليون/);
            if (budgetMatch) userState.budget = parseInt(budgetMatch[1]) * 1000000;

            // Get random Egyptian expression
            const getExpression = () => {
                if (!egyptianData) return "يا حبيبي";
                const exprs = egyptianData.egyptianExpressions || ["يا حبيبي"];
                return exprs[Math.floor(Math.random() * exprs.length)];
            };

            // Get random emoji
            const getEmoji = () => {
                if (!egyptianData) return "😊";
                const emojis = egyptianData.egyptianEmojis || ["😊"];
                return emojis[Math.floor(Math.random() * emojis.length)];
            };

            // Get random movie quote
            const getMovieQuote = () => {
                if (!egyptianData || !egyptianData.egyptianMovieQuotes) return "";
                const quotes = egyptianData.egyptianMovieQuotes;
                const quote = quotes[Math.floor(Math.random() * quotes.length)];
                return `\n\n🎬 زي ما قال ${quote.actor} في ${quote.movie}: "${quote.quote}"`;
            };

            // Search properties
            const searchProperties = (term) => {
                if (!egyptianData || !egyptianData.properties) return [];
                return egyptianData.properties.filter(p =>
                    p.compound.includes(term) ||
                    p.developer.includes(term) ||
                    p.location.includes(term) ||
                    (p.description && p.description.includes(term))
                );
            };

            // SMART RESPONSE LOGIC & OFFLINE AGENT 🧠

            // 0. AGENTIC SHORTCUTS (Offline Tools)
            // If API fails, we simulate intelligence here

            // Search Trigger
            if (message.includes('بحث') || message.includes('find') || message.includes('search') || message.includes('دورلي') || message.includes('عايز')) {
                if (message.includes('تجمع') || message.includes('fifth')) {
                    return JSON.stringify({ "tool": "searchProperties", "args": { "location": "التجمع" } });
                }
                if (message.includes('مستقبل') || message.includes('mostakbal')) {
                    return JSON.stringify({ "tool": "searchProperties", "args": { "location": "مستقبل" } });
                }
                if (message.includes('زايد') || message.includes('zayed') || message.includes('أكتوبر') || message.includes('october')) {
                    return JSON.stringify({ "tool": "searchProperties", "args": { "location": "أكتوبر" } });
                }
                if (message.includes('عاصمة') || message.includes('capital')) {
                    return JSON.stringify({ "tool": "searchProperties", "args": { "location": "العاصمة" } });
                }
            }

            // ROI Trigger
            if (message.includes('roi') || message.includes('عائد') || message.includes('استثمار') || message.includes('احسب')) {
                const priceMatch = message.match(/\d+/);
                const price = priceMatch ? parseInt(priceMatch[0]) * 1000000 : 5000000;
                return JSON.stringify({ "tool": "calculateROI", "args": { "price": price } });
            }

            // Theme Trigger
            if (message.includes('dark') || message.includes('ليلي') || message.includes('ظلام')) {
                return JSON.stringify({ "tool": "changeTheme", "args": { "mode": "dark" } });
            }
            if (message.includes('light') || message.includes('نهاري') || message.includes('نور')) {
                return JSON.stringify({ "tool": "changeTheme", "args": { "mode": "light" } });
            }

            // 1. Check for specific compound/developer search FIRST
            // This fixes the "Mountain View" issue
            if (egyptianData && egyptianData.properties) {
                const searchTerms = message.split(' ');
                for (const term of searchTerms) {
                    if (term.length > 3) {
                        const found = egyptianData.properties.filter(p =>
                            p.compound.includes(term) || p.developer.includes(term)
                        );
                        if (found.length > 0) {
                            response = `${getExpression()}! أنت بتسأل عن ${found[0].compound}؟ اختيار عالمي
                        ${getEmoji()}\n\n`;

                            // Use memory if available
                            if (userState.budget && found[0].price > userState.budget * 1.2) {
                                response += `بس خلي بالك، سعره ${(found[0].price / 1000000).toFixed(1)} مليون، يعني أعلى
                        شوية من ميزانيتك (${userState.budget / 1000000} مليون). بس يستاهل!\n\n`;
                            } else if (userState.budget) {
                                response += `وسعره مناسب جداً لميزانيتك! \n\n`;
                            }

                            response += `عندي ليك الوحدات دي:\n`;
                            found.slice(0, 2).forEach(p => {
                                response += `🏠 ${p.type} ${p.size}م² - ${(p.price / 1000000).toFixed(1)} مليون\n`;
                                response += `✨ مقدم ${p.downPayment.percent}% وقسط ${p.paymentPlan.years} سنين\n`;
                            });
                            return response;
                        }
                    }
                }
            }

            // 2. Location Context - Mostakbal City (مستقبل)
            if (message.includes('مستقبل') || message.includes('المستقبل') ||
                message.includes('mostakbal') || message.includes('future city')) {
                const marketInfo = egyptianData?.marketTrends?.['مدينة المستقبل'];
                userState.location = 'مدينة المستقبل';

                response = `أهلاً وسهلاً! مدينة المستقبل منطقة ممتازة ومن أحسن الاختيارات دلوقتي.\n\n`;
                response += `خليني أوريك الصورة كاملة:\n\n`;
                response += `متوسط سعر المتر في الشقق: من 20,000 لـ 24,000 جنيه\n`;
                response += `يعني مثلاً:\n`;
                response += `- شقة غرفتين (110-130م): من 2.2 لـ 3.1 مليون\n`;
                response += `- شقة 3 غرف (140-165م): من 2.8 لـ 4 مليون\n`;
                response += `- شقة كبيرة (180م+): من 3.6 لـ 4.5 مليون\n\n`;
                response += `السعر بيتأثر بـ:\n`;
                response += `- اسم المطور (Tatweer الأقل، Hassan Allam الأعلى)\n`;
                response += `- الموقع داخل الكمباوند وقربه من الخدمات\n`;
                response += `- التشطيب ونوعيته\n`;
                response += `- موعد الاستلام (فوري أغلى)\n\n`;
                response += `تحب ندور على:\n`;
                response += `- رينج سعر معين في بالك؟\n`;
                response += `- ولا مطور بعينه بتفضله؟\n`;
                response += `- ولا عايز أقل سعر متاح الأول؟`;
                useData = true;
            }
            // 2b. Location Context - التجمع الخامس
            else if (message.includes('التجمع') || message.includes('تجمع') ||
                message.includes('fifth')) {
                userState.location = 'التجمع الخامس';

                response = `التجمع الخامس اختيار ممتاز! منطقة راقية وقريبة من كل الخدمات.\n\n`;
                response += `خليني أوريك السوق هناك:\n\n`;
                response += `متوسط سعر المتر للشقق: من 21,000 لـ 28,000 جنيه\n`;
                response += `يعني مثلاً:\n`;
                response += `- شقة غرفتين (120م): من 2.5 لـ 3.4 مليون\n`;
                response += `- شقة 3 غرف (150م): من 3.2 لـ 4.2 مليون\n`;
                response += `- فيلا تاون هاوس (200م): من 7 لـ 11 مليون\n\n`;
                response += `السعر بيفرق حسب:\n`;
                response += `- الكمباوند (Sodic, Palm Hills أغلى)\n`;
                response += `- الإطلالة والموقع داخل الكمباوند\n`;
                response += `- التشطيب كامل ولا نصف تشطيب\n\n`;
                response += `أنت بتفكر في:\n`;
                response += `- شقة ولا فيلا؟\n`;
                response += `- ميزانية معينة في بالك؟\n`;
                response += `- استثمار ولا سكن دائم؟`;
                useData = true;
            }
            // 2c. Location Context - العاصمة الإدارية
            else if (message.includes('العاصمة') || message.includes('الإدارية') ||
                message.includes('capital') || message.includes('admin')) {
                userState.location = 'العاصمة الإدارية';

                response = `العاصمة الإدارية الجديدة! مستقبل مصر كله هناك.\n\n`;
                response += `خليني أوريك السوق هناك:\n\n`;
                response += `متوسط سعر المتر للشقق: من 25,000 لـ 35,000 جنيه\n`;
                response += `يعني مثلاً:\n`;
                response += `- شقة غرفتين (100-120م): من 2.5 لـ 4.2 مليون\n`;
                response += `- شقة 3 غرف (140-160م): من 3.5 لـ 5.6 مليون\n`;
                response += `- دوبلكس (200م+): من 5 لـ 7 مليون\n\n`;
                response += `السعر بيتأثر بـ:\n`;
                response += `- الحي (R5, R7 أرخص من Downtown)\n`;
                response += `- المطور (City Edge, Misr Italia)\n`;
                response += `- القرب من المحاور والخدمات\n\n`;
                response += `تحب ندور على:\n`;
                response += `- ميزانية معينة في بالك؟\n`;
                response += `- حي معين بتفضله؟\n`;
                response += `- ولا عايز أفضل فرصة استثمارية؟`;
                useData = true;
            }

            // 3. Budget Context
            else if (message.includes('مليون') || userState.budget) {
                let budget = userState.budget;
                if (message.includes('مليون')) {
                    const numbers = message.match(/\d+/g);
                    if (numbers) budget = parseInt(numbers[0]) * 1000000;
                }

                if (budget) {
                    const properties = egyptianData.properties.filter(p => p.price <= budget * 1.2); if (!response)
                        response = `${getExpression()}! ميزانية ${(budget / 1000000).toFixed(1)} مليون؟ تمام جداً
                            ${getEmoji()}\n\n`; if (properties.length > 0) {
                        response += `لقيتلك ${properties.length} لقطة تناسبك:\n`;
                        properties.slice(0, 3).forEach(p => {
                            response += `• ${p.compound}: ${p.type} ${p.size}م² بـ ${(p.price / 1000000).toFixed(1)}
                            مليون\n`;
                        });
                        response += `\nتحب تفاصيل أكتر عن أي واحدة فيهم؟`;
                    } else {
                        response += `الميزانية دي محتاجة تزيد شوية عشان نلاقي حاجة مميزة في السوق ده، بس
                            هندورلك!`;
                    }
                    useData = true;
                }
            }

            // Default generic response if nothing matched
            if (!response) {
                // Check if they mentioned apartment/villa type without location
                if (message.includes('شقة') || message.includes('شقه')) {
                    response = `تمام! بتدور على شقة.\n\n`;
                    response += `عندي شقق في مناطق مختلفة:\n`;
                    response += `- مدينة المستقبل: من 1.3 لـ 4.5 مليون\n`;
                    response += `- التجمع الخامس: من 2.5 لـ 5 مليون\n`;
                    response += `- العاصمة الإدارية: من 2.5 لـ 7 مليون\n\n`;
                    response += `تحب ندور في أنهي منطقة؟\n`;
                    response += `ولا عندك ميزانية معينة نبدأ منها؟`;
                } else if (message.includes('فيلا') || message.includes('villa')) {
                    response = `تمام! بتدور على فيلا.\n\n`;
                    response += `عندي فيلات في مناطق مختلفة:\n`;
                    response += `- تاون هاوس (200م): من 7 لـ 12 مليون\n`;
                    response += `- توين هاوس (280م): من 10 لـ 15 مليون\n`;
                    response += `- فيلا مستقلة (350م+): من 15 لـ 25 مليون\n\n`;
                    response += `تحب ندور في أنهي منطقة؟\n`;
                    response += `ولا عندك ميزانية معينة في بالك؟`;
                } else if (message.includes('استوديو') || message.includes('studio')) {
                    response = `الاستوديوهات اختيار ذكي للاستثمار!\n\n`;
                    response += `متوسط أسعار الاستوديوهات:\n`;
                    response += `- المستقبل سيتي: من 1.3 لـ 1.7 مليون\n`;
                    response += `- العاصمة الإدارية: من 1.5 لـ 2 مليون\n`;
                    response += `- التجمع: من 1.8 لـ 2.5 مليون\n\n`;
                    response += `العائد الإيجاري للاستوديوهات بيوصل 9% سنوياً!\n\n`;
                    response += `تحب ندور في أنهي منطقة؟`;
                } else if (userState.location && userState.budget) {
                    response = `${getExpression()}! فاكر طلبك: ${userState.location} في حدود
                            ${(userState.budget / 1000000)} مليون.\n`;
                    response += `تحب أبعتلك تفاصيل أكتر عن نظام التقسيط؟ ولا نشوف مناطق تانية؟
                            ${getEmoji()}`;
                } else {
                    response = `${getExpression()}! ${getEmoji()} عشان أقدر أساعدك بأفضل شكل، ممكن
                            تقولي:\n\n`;
                    response += `🎯 ميزانيتك كام تقريباً؟\n`;
                    response += `📍 عايز تسكن في أنهي منطقة؟\n`;
                    response += `وأنا هجيبلك أحسن الفرص المتاحة!`;
                }
            }

            // Add movie quote sometimes (30% chance)
            if (Math.random() > 0.7 && useData) {
                response += getMovieQuote();
            }

            return response;
        }

        // Detect profanity and abusive language
        function containsProfanity(text) {
            const cleanText = text.toLowerCase().trim();

            // Comprehensive Arabic profanity/abuse including Egyptian slang
            const arabicBadWords = [
                // Strong profanity
                'كسم', 'كس', 'كسمك', 'خول', 'شرموط', 'عرص', 'متناك', 'لبوة', 'قحبة', 'زب', 'طيز',
                'عاهرة', 'منيوك', 'ابن القحبة', 'يلعن', 'كس اخت', 'نيك', 'منيك', 'نياكة',
                'ابن الكلب', 'خرا', 'زبالة', 'ابن الوسخة', 'وسخ', 'قذر', 'عرصة',

                // Egyptian colloquial profanity/curses
                'احا', 'يخرب', 'يخربيت', 'ولاد', 'يلعن', 'كسختك', 'يلهوي', 'ابوس',
                'متخلف', 'حمار', 'كلب', 'بهيم', 'حيوان', 'ابن المتناكة', 'يا ابن',

                // Common curse phrases
                'يلعن دين', 'يلعن ابو', 'كس ام', 'يخرب بيت', 'ابن الشرموطة',
                'يا خول', 'يا عرص', 'يا كلب', 'يا حمار', 'يا متناك',

                // Variants and common misspellings
                'كسومك', 'خرة', 'خره', 'نيكة', 'منيوكة', 'شرموطه', 'قحبه',
                'a7a', '7mar', 'kos', 'kos omak', 'ya 5awal', 'ya 3ars'
            ];

            // Common English profanity/abuse
            const englishBadWords = [
                'fuck', 'fucking', 'fucked', 'fucker', 'shit', 'shit', 'bitch', 'ass', 'asshole',
                'damn', 'hell', 'bastard', 'dick', 'cock', 'pussy', 'slut', 'whore', 'cunt',
                'motherfucker', 'prick', 'fag', 'faggot', 'nigger', 'nigga', 'retard', 'retarded',
                'stupid', 'idiot', 'dumb', 'dumbass', 'moron', 'wtf', 'stfu', 'bullshit', 'piss',
                'crap', 'suck', 'sucks', 'sucking', 'wanker', 'twat', 'douche', 'douchebag'
            ];

            // Combine both lists
            const allBadWords = [...arabicBadWords, ...englishBadWords];

            // Check if text contains any bad words
            return allBadWords.some(badWord => {
                // Escape special regex characters
                const escapedWord = badWord.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                // Use word boundaries for exact matching or partial matching
                const regex = new RegExp(`\\b${escapedWord}\\b|${escapedWord}`, 'i');
                return regex.test(cleanText);
            });
        }

        // Detect gibberish/nonsense input
        function isGibberish(text) {
            if (!text) return true;
            const cleanText = text.toLowerCase().trim();

            // Too short to judge, but check against common short words
            if (cleanText.length < 2) return false;

            // Check for common real greeting words - these are NOT gibberish
            const realPhrases = ['سلام', 'مرحبا', 'هاي', 'السلام', 'ازيك', 'إزيك', 'عامل', 'hello', 'hi', 'hey', 'شقة', 'فيلا', 'عقار', 'استثمار', 'شراء', 'بيع', 'سعر', 'التجمع', 'العاصمة', 'مليون', 'الف', 'ميزانية', 'اكتوبر', 'زايد', 'نصيحة', 'رأي', 'مساعدة'];

            if (realPhrases.some(phrase => cleanText.includes(phrase))) {
                return false;
            }

            // Count vowels vs consonants (for English)
            const vowels = (cleanText.match(/[aeiou]/g) || []).length;
            const consonants = (cleanText.match(/[bcdfghjklmnpqrstvwxyz]/g) || []).length;
            const letters = vowels + consonants;

            // If mostly English letters
            if (letters > cleanText.length * 0.5) {
                // Very low vowel ratio = likely gibberish (like "joijl", "asdf", "qwer")
                if (letters > 3 && vowels / letters < 0.15) { return true; }

                // Check for keyboard patterns (asdf, qwerty, etc.)
                const keyboardPatterns = ['asdf', 'qwer', 'zxcv', 'hjkl', 'erty', 'dfgh'];
                if (keyboardPatterns.some(pattern => cleanText.includes(pattern))) {
                    return true;
                }
            }

            // Check for repeated characters like "aaa", "kkkkk"
            if (/(.)\1{3,}/.test(cleanText)) {
                return true;
            }

            // Random single letters or very short nonsense (but allow "ا" or "و" for Arabic)
            if (cleanText.length <= 4) {
                const hasArabic = /[\u0600-\u06FF]/.test(cleanText);
                const hasNumbers = /\d/.test(cleanText);

                if (!hasArabic && !hasNumbers && letters === cleanText.length) {
                    // Check if it forms any meaningful pattern
                    const commonShort = ['yes', 'no', 'ok', 'لا', 'نعم', 'اه', 'لو'];
                    if (!commonShort.some(word => cleanText === word)) {
                        return true;
                    }
                }
            }

            return false;
        }

        // Send Message with Gemini AI integration
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();

            if (!message) return;

            addMessage(message, 'user');
            input.value = '';
            userEngagementScore++;

            // Check for profanity FIRST - highest priority
            if (containsProfanity(message)) {
                showTyping();
                setTimeout(() => {
                    // Track abuse count
                    if (!window.abuseCount) window.abuseCount = 0;
                    window.abuseCount++;

                    let response;
                    if (window.abuseCount === 1) {
                        // First offense - firm but polite
                        const firstWarnings = [
                            'اعذرني يا فندم، أنا محترف ومحترم. 🙏 لو عايز نكمل لازم الكلام يكون محترم. أنا هنا عشان أساعدك تلاقي بيت أحلامك 🏡',
                            'معلش يا باشا، الكلام ده مش مقبول. 😔 أنا شخص محترم وبحترم كل العملاء. تقدر نبدأ من جديد بطريقة محترمة؟',
                            'يا أخي الكريم، أنا هنا عشان أخدمك بكل احترافية. 🤝 لو فيه حاجة مضايقاك، قولي وهنحلها...بس بأسلوب محترم لو سمحت.'
                        ];
                        response = firstWarnings[Math.floor(Math.random() * firstWarnings.length)];
                    } else if (window.abuseCount === 2) {
                        // Second offense - more firm
                        response = 'للأسف الكلام ده مش هينفع تاني. 🛑 أنا محترف وبحترم نفسي وعملائي. آخر مرة بقولك - لو عايز نكمل لازم احترام متبادل.إيه رأيك نبدأ صفحة جديدة؟';
                    } else {
                        // Third+ offense - end conversation
                        response = 'للأسف مش هقدر أكمل معاك بالأسلوب ده. 🙏 لما تكون جاهز للحوار المحترم، أنا تحت أمرك.وقتك الطيب وتحياتي.';
                        // Optionally disable input after 3 offenses
                        setTimeout(() => {
                            const chatInput = document.getElementById('chatInput');
                            if (chatInput && window.abuseCount >= 3) {
                                chatInput.placeholder = 'المحادثة انتهت بسبب عدم الاحترام';
                                chatInput.disabled = true;
                            }
                        }, 2000);
                    }

                    hideTyping();
                    typeMessage(response, 'ai');
                }, 1000);
                return;
            }

            // Check for gibberish before processing
            if (isGibberish(message)) {
                showTyping();
                setTimeout(() => {
                    const confusedResponses = [
                        'ههههه معلش مفهمتش! 😅 كتبت حاجة غلط ولا إيه؟ قولي عايز تسأل عن إيه بالظبط؟',
                        'إيه ده يا معلم؟ 🤔 الكيبورد اتخض ولا إيه؟ ههههه قولي عايز تعرف إيه عن العقارات؟',
                        'معلش مش فاهم قصدك إيه! 😄 ممكن توضحلي أكتر؟ بتدور على إيه؟',
                        'يا عم الحاج! 😂 الكلام ده مالوش معنى... عايز تسأل عن شقة؟ فيلا؟ استثمار؟',
                        'ههههه ماشي ماشي 🤣 بس ممكن تكتب حاجة افهمها؟ بتدور على عقار في أنهي منطقة؟'
                    ];
                    const response = confusedResponses[Math.floor(Math.random() *
                        confusedResponses.length)];
                    hideTyping();
                    typeMessage(response, 'ai');
                }, 800);
                return;
            }

            showTyping();

            // Realistic delay before response (1-3 seconds based on message length)
            const baseDelay = 800;
            const lengthDelay = message.length * 8;
            const thinkingDelay = Math.random() * 600;
            const totalDelay = baseDelay + Math.min(lengthDelay, 1500) + thinkingDelay;

            setTimeout(async () => {
                try {
                    let response;

                    // Try to call Gemini API if API key is configured
                    if (AI_CONFIG.apiKey) {
                        try {
                            response = await callGeminiAPI(message);

                            // Update conversation history
                            conversationHistory.push(
                                { role: 'user', content: message },
                                { role: 'assistant', content: response }
                            );

                            // Keep only last 20 messages (10 exchanges)
                            if (conversationHistory.length > 20) {
                                conversationHistory = conversationHistory.slice(-20);
                            }

                        } catch (apiError) {
                            console.error('Gemini API failed, using fallback:', apiError);

                            // Show error message if it's API key issue
                            if (apiError.message === 'API_KEY_MISSING') {
                                addMessage('⚠️ مفتاح API غير موجود. يرجى إضافته من الإعدادات.', 'system');
                                hideTyping();
                                return;
                            }

                            // Fallback to rule-based response
                            response = generateAmrResponse(message);

                            // CRITICAL: Update conversation history even on fallback so we have context!
                            conversationHistory.push(
                                { role: 'user', content: message },
                                { role: 'assistant', content: response }
                            );

                            // Keep only last 20 messages
                            if (conversationHistory.length > 20) {
                                conversationHistory = conversationHistory.slice(-20);
                            }
                        }
                    } else {
                        // No API key, use fallback directly
                        response = generateAmrResponse(message);

                        // Update history here too
                        conversationHistory.push(
                            { role: 'user', content: message },
                            { role: 'assistant', content: response }
                        );
                    }

                    hideTyping();

                    // Type the message character by character
                    typeMessage(response, 'ai', () => {
                        // Add follow-up engagement after some messages
                        if (userEngagementScore > 3 && Math.random() > 0.7) {
                            setTimeout(() => {
                                const followUps = [
                                    "بالمناسبة، انت عميل مميز عندنا... هاديك خصم 3% كرمة عين! 🎁✨",
                                    "وعندي عرض خاص ليك... هديك جولة مجانية في أي كمباوند تختاره! 🚗",
                                    "ملحوظة: فيه عرض محدود دلوقتي بدون مقدم! عايز التفاصيل؟ 🔥"
                                ];
                                const followUp = followUps[Math.floor(Math.random() * followUps.length)];
                                typeMessage(followUp, 'ai');
                            }, 2500);
                        }
                    });

                } catch (error) {
                    console.error('Error in sendMessage:', error);
                    hideTyping();
                    typeMessage('عفواً، حصل خطأ فني صغير. ممكن تعيد كتابة رسالتك تاني؟ 🙏',
                        'ai');
                }

                messageHistory.push(message);
            }, totalDelay);
        }

        // Quick message function
        function sendQuickMessage(message) {
            sendMessage();
        }

        function addMessage(text, sender) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-${sender}`;

            messageDiv.innerHTML = `
                                        <div class="message-bubble">${text}</div>
                                        `;

            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // Visual Agent: Enhanced Thinking Indicator
        const thinkingStates = [
            '🔍 جاري البحث في قاعدة البيانات...',
            '📊 تحليل العقارات المتاحة...',
            '💡 تجهيز أفضل الخيارات ليك...',
            '🧠 عمرو بيفكر...'
        ];
        let thinkingInterval = null;

        function showTyping() {
            const messagesDiv = document.getElementById('chatMessages');

            // Remove old indicator if exists
            hideTyping();

            const thinkingDiv = document.createElement('div');
            thinkingDiv.className = 'message message-ai';
            thinkingDiv.id = 'typingIndicator';
            thinkingDiv.innerHTML = `
                <div class="thinking-badge">
                    <span class="dot"></span>
                    <span class="thinking-text">${thinkingStates[0]}</span>
                </div>
            `;
            messagesDiv.appendChild(thinkingDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            // Cycle through thinking states
            let stateIndex = 0;
            thinkingInterval = setInterval(() => {
                stateIndex = (stateIndex + 1) % thinkingStates.length;
                const textEl = thinkingDiv.querySelector('.thinking-text');
                if (textEl) {
                    textEl.textContent = thinkingStates[stateIndex];
                }
            }, 1500);
        }

        function hideTyping() {
            if (thinkingInterval) {
                clearInterval(thinkingInterval);
                thinkingInterval = null;
            }
            const indicator = document.getElementById('typingIndicator');
            if (indicator) {
                indicator.remove();
            }
        }

        // Settings Management Functions - Removed (API key is built-in)

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function () {
            // Built-in API Key - Always use this key
            const BUILTIN_API_KEY = 'AIzaSyDeCE9yITtWQWHFNgReuKbNBjA_5SUnx4I';
            localStorage.setItem('gemini_api_key', BUILTIN_API_KEY);
            AI_CONFIG.apiKey = BUILTIN_API_KEY;
            console.log('✅ Gemini API Key built-in and active');

            // Remove any legacy stored keys
            // Always override with built-in key

            // Update status if API key is configured
            if (AI_CONFIG.apiKey) {
                const chatStatus = document.getElementById('chatStatus');
                if (chatStatus) {
                    chatStatus.innerHTML = 'متصل بـ Google Gemini AI 🤖';
                    chatStatus.style.color = '#38a169'; // success color
                }
            }

            // ============================================
            // 🧠 PHASE 2: MEMORY CORE SYSTEM
            // ============================================

            // User Profile Object
            window.userProfile = {
                name: null,
                preferredLocations: [],
                preferredTypes: [],
                budgetMin: null,
                budgetMax: null,
                lastVisit: null,
                searchHistory: [],
                interests: []
            };

            // Save User Profile to localStorage
            function saveUserProfile() {
                window.userProfile.lastVisit = new Date().toISOString();
                localStorage.setItem('amr_user_profile', JSON.stringify(window.userProfile));
                console.log('💾 User profile saved:', window.userProfile);
            }

            // Load User Profile from localStorage
            function loadUserProfile() {
                const saved = localStorage.getItem('amr_user_profile');
                if (saved) {
                    try {
                        window.userProfile = JSON.parse(saved);
                        console.log('📂 User profile loaded:', window.userProfile);
                        return true;
                    } catch (e) {
                        console.warn('Failed to parse user profile:', e);
                    }
                }
                return false;
            }

            // Save Chat History to localStorage
            function saveChatHistory() {
                const messages = [];
                document.querySelectorAll('#chatMessages .message').forEach(msg => {
                    const isUser = msg.classList.contains('message-user');
                    const bubble = msg.querySelector('.message-bubble');
                    if (bubble && !msg.querySelector('.chat-carousel') && !msg.querySelector('.thinking-badge')) {
                        messages.push({
                            role: isUser ? 'user' : 'ai',
                            text: bubble.textContent.trim()
                        });
                    }
                });
                // Keep last 50 messages
                const toSave = messages.slice(-50);
                localStorage.setItem('amr_chat_history', JSON.stringify(toSave));
                console.log('💬 Chat history saved:', toSave.length, 'messages');
            }

            // Clear Chat History - Complete reset (Global function for onclick)
            window.clearChatHistory = function () {
                // Show confirmation with Arabic message
                if (!confirm('هل أنت متأكد أنك تريد مسح المحادثة؟ سيتم حذف كل الرسائل السابقة.')) {
                    return;
                }

                // Clear localStorage first
                localStorage.removeItem('amr_chat_history');

                // Clear conversation history array (for AI context)
                if (typeof conversationHistory !== 'undefined') {
                    conversationHistory = [];
                }

                // Clear the UI completely
                const chatContainer = document.getElementById('chatMessages');
                if (chatContainer) {
                    chatContainer.innerHTML = '';
                }

                console.log('🗑️ Chat history cleared!');

                // Use addMessage to properly add welcome message
                // This ensures it integrates with the auto-save mechanism
                // Wait a bit to ensure DOM is cleared before adding new message
                setTimeout(() => {
                    // Use the global addMessage function which has auto-save built in
                    const addMessageFunc = typeof window.addMessage === 'function' ? window.addMessage : addMessage;
                    addMessageFunc('أهلاً بيك! 👋 أنا عمرو، مستشارك العقاري الذكي. إزاي أقدر أساعدك النهاردة؟', 'ai');
                }, 200);
            };

            // Load Chat History from localStorage
            function loadChatHistory() {
                const saved = localStorage.getItem('amr_chat_history');
                if (saved) {
                    try {
                        const messages = JSON.parse(saved);
                        const chatContainer = document.getElementById('chatMessages');
                        messages.forEach(msg => {
                            addMessage(msg.text, msg.role);
                        });
                        console.log('📜 Chat history restored:', messages.length, 'messages');
                        return messages.length > 0;
                    } catch (e) {
                        console.warn('Failed to parse chat history:', e);
                    }
                }
                return false;
            }

            // Extract Preferences from User Messages
            function extractPreferences(message) {
                const lowerMsg = message.toLowerCase();
                let updated = false;

                // Extract locations
                const locationKeywords = {
                    'التجمع': 'New Cairo',
                    'القاهرة الجديدة': 'New Cairo',
                    'new cairo': 'New Cairo',
                    'زايد': 'Zayed',
                    'الشيخ زايد': 'Zayed',
                    'sheikh zayed': 'Zayed',
                    'العاصمة': 'New Capital',
                    'capital': 'New Capital',
                    'اكتوبر': '6th October',
                    '6 اكتوبر': '6th October',
                    'مدينتي': 'Madinaty',
                    'المستقبل': 'Mostakbal City'
                };

                for (const [keyword, location] of Object.entries(locationKeywords)) {
                    if (lowerMsg.includes(keyword) && !window.userProfile.preferredLocations.includes(location)) {
                        window.userProfile.preferredLocations.push(location);
                        updated = true;
                    }
                }

                // Extract property types
                const typeKeywords = {
                    'شقة': 'Apartment',
                    'apartment': 'Apartment',
                    'فيلا': 'Villa',
                    'villa': 'Villa',
                    'تاون هاوس': 'Townhouse',
                    'townhouse': 'Townhouse',
                    'دوبلكس': 'Duplex',
                    'duplex': 'Duplex',
                    'بنتهاوس': 'Penthouse',
                    'penthouse': 'Penthouse'
                };

                for (const [keyword, type] of Object.entries(typeKeywords)) {
                    if (lowerMsg.includes(keyword) && !window.userProfile.preferredTypes.includes(type)) {
                        window.userProfile.preferredTypes.push(type);
                        updated = true;
                    }
                }

                // Extract budget (looking for numbers in millions)
                const budgetPatterns = [
                    /(\d+(?:\.\d+)?)\s*(?:مليون|مليار|million|m)/gi,
                    /ميزانيت[يى]\s*(\d+)/gi,
                    /budget[:\s]*(\d+)/gi
                ];

                for (const pattern of budgetPatterns) {
                    const match = pattern.exec(message);
                    if (match) {
                        const amount = parseFloat(match[1]) * 1000000;
                        if (amount > 500000) { // Reasonable budget
                            window.userProfile.budgetMax = amount;
                            updated = true;
                        }
                    }
                }

                // Track search in history
                if (message.length > 5) {
                    window.userProfile.searchHistory.push({
                        query: message.substring(0, 100),
                        timestamp: new Date().toISOString()
                    });
                    // Keep last 20 searches
                    window.userProfile.searchHistory = window.userProfile.searchHistory.slice(-20);
                    updated = true;
                }

                if (updated) {
                    saveUserProfile();
                }
            }

            // Generate Welcome Back Message
            function generateWelcomeBack() {
                const profile = window.userProfile;
                if (!profile.lastVisit) return null;

                const lastVisit = new Date(profile.lastVisit);
                const now = new Date();
                const hoursSinceVisit = (now - lastVisit) / (1000 * 60 * 60);

                // Only show welcome back if more than 30 minutes since last visit
                if (hoursSinceVisit < 0.5) return null;

                let greeting = 'أهلاً رجعتلي! 👋 ';

                if (profile.preferredLocations.length > 0) {
                    greeting += `آخر مرة كنت بتدور على عقارات في ${profile.preferredLocations[0]}. `;
                }

                if (profile.budgetMax) {
                    greeting += `وميزانيتك كانت حوالي ${(profile.budgetMax / 1000000).toFixed(1)} مليون. `;
                }

                greeting += 'لسه مهتم ولا عايز نشوف حاجة جديدة؟ 🏠';

                return greeting;
            }

            // Initialize Memory System
            const isReturningUser = loadUserProfile();
            const hasChatHistory = loadChatHistory();

            if (isReturningUser && !hasChatHistory) {
                // Returning user without chat history - show welcome back
                const welcomeMsg = generateWelcomeBack();
                if (welcomeMsg) {
                    setTimeout(() => {
                        addMessage(welcomeMsg, 'ai');
                    }, 500);
                }
            }

            // Hook into sendMessage to extract preferences and save history
            const originalAddMessage = window.addMessage || addMessage;
            window.addMessage = function (text, sender) {
                originalAddMessage(text, sender);
                if (sender === 'user') {
                    extractPreferences(text);
                }
                // Auto-save chat history after each message
                setTimeout(saveChatHistory, 100);
            };

            // Save profile on page unload
            window.addEventListener('beforeunload', () => {
                saveUserProfile();
                saveChatHistory();
            });

            console.log('🧠 Memory Core System initialized');
            // ============================================

            // Load Egyptian real estate data
            loadEgyptianData();

            // AGENTIC UI: Render Properties Dynamically
            function renderProperties(properties) {
                const grid = document.getElementById('propertyGrid');
                if (!grid) return;

                grid.innerHTML = ''; // Clear existing

                if (properties.length === 0) {
                    grid.innerHTML = '<div class="no-results" style="grid-column: 1/-1; text-align: center; font-size: 1.5rem; color: var(--text-muted);">عفواً، مفيش عقارات بالمواصفات دي حالياً. 🏜️</div>';
                    return;
                }

                properties.forEach(p => {
                    const priceMillion = (p.price / 1000000).toFixed(1);
                    const card = document.createElement('div');
                    card.className = 'property-card';
                    // Trigger simple entry animation
                    card.style.animation = 'fadeInUp 0.5s ease forwards';

                    // Select image based on object property or fallback
                    let bgImage = p.image || 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=400&q=80';

                    // Only apply fallback logic if no image provided
                    if (!p.image) {
                        if (p.type && p.type.includes('فيلا')) bgImage = 'https://images.unsplash.com/photo-1613977257363-707ba9348227?w=400&q=80';
                        if (p.compound && p.compound.includes('Capital')) bgImage = 'https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?w=400&q=80';
                    }

                    card.innerHTML = `
                        <div class="property-image">
                            <img src="${bgImage}" alt="${p.compound} - ${p.location}" loading="lazy" width="400" height="240">
                            <span class="property-badge">${p.type}</span>
                            <span class="roi-badge">ROI: ${p.roi}%</span>
                        </div>
                        <div class="property-content">
                            <h3 class="property-title">${p.compound}</h3>
                            <div class="property-location">
                                <span><i class="fas fa-map-marker-alt"></i></span>
                                <span>${p.location}</span>
                            </div>
                            <div class="property-features">
                                <span class="feature-item">
                                    <span><i class="fas fa-ruler-combined"></i></span>
                                    <span>${p.size}م²</span>
                                </span>
                                <span class="feature-item">
                                    <span><i class="fas fa-building"></i></span>
                                    <span>${p.developer}</span>
                                </span>
                            </div>
                            <div class="property-price">₤${priceMillion}M</div>
                            <div class="property-monthly">مقدم ${p.downPayment.percent}% - قسط ${p.paymentPlan.years} سنين</div>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            }

            // Initial Render of all properties
            if (window.egyptianData && window.egyptianData.properties) {
                renderProperties(window.egyptianData.properties.slice(0, 3)); // Show top 3 initially
            }

            // Visual Agent: Render Property Cards in Chat
            function renderChatCards(properties) {
                if (!properties || properties.length === 0) return;

                const chatContainer = document.getElementById('chatMessages');
                const carouselWrapper = document.createElement('div');
                carouselWrapper.className = 'message message-ai';
                carouselWrapper.style.maxWidth = '100%';

                let carouselHtml = '<div class="chat-carousel">';

                properties.slice(0, 5).forEach(p => {
                    const priceMillion = (p.price / 1000000).toFixed(1);
                    const imgUrl = p.image || 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400&q=80';

                    carouselHtml += `
                        <div class="chat-property-card" data-id="${p.id}">
                            <img class="chat-card-image" src="${imgUrl}" alt="${p.compound}" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400&q=80'">
                            <div class="chat-card-body">
                                <div class="chat-card-title">${p.compound}</div>
                                <div class="chat-card-price">₤${priceMillion}M</div>
                                <div class="chat-card-meta">
                                    <span>📍 ${p.location}</span>
                                    <span>📐 ${p.area || p.size || 150}م²</span>
                                </div>
                                <div class="chat-card-actions">
                                    <button class="chat-card-btn primary" onclick="scrollToProperty('${p.id}')">التفاصيل</button>
                                    <button class="chat-card-btn secondary" onclick="window.aiTools.calculateROI({price: ${p.price}})">ROI</button>
                                </div>
                            </div>
                        </div>
                    `;
                });

                carouselHtml += '</div>';
                carouselWrapper.innerHTML = carouselHtml;
                chatContainer.appendChild(carouselWrapper);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // Helper: Scroll to property in main grid
            function scrollToProperty(propertyId) {
                const card = document.querySelector(`.property-card[data-id="${propertyId}"]`);
                if (card) {
                    card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    card.style.boxShadow = '0 0 0 4px var(--secondary)';
                    setTimeout(() => {
                        card.style.boxShadow = '';
                    }, 2000);
                } else {
                    // Property might not be rendered, render full list and scroll
                    const prop = window.egyptianData.properties.find(p => p.id === propertyId);
                    if (prop) {
                        renderProperties([prop, ...window.egyptianData.properties.filter(p => p.id !== propertyId).slice(0, 5)]);
                        setTimeout(() => {
                            const newCard = document.querySelector(`.property-card[data-id="${propertyId}"]`);
                            if (newCard) newCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }, 100);
                    }
                }
            }

            // AGENTIC TOOLS ENGINE 🛠️
            window.aiTools = {
                // Tool 1: Real Property Search (Visual Agent Enhanced + Smart Nearest Match)
                searchProperties: (args) => {
                    console.log('🕵️ Visual Agent Search Tool executing:', args);
                    const allProps = window.egyptianData.properties;
                    let filtered = allProps;
                    let fallbackUsed = null;
                    let originalCriteria = { ...args };

                    // Step 1: Try exact match first
                    if (args.location) {
                        filtered = filtered.filter(p => p.location.includes(args.location) || (p.description && p.description.includes(args.location)));
                    }
                    if (args.type) {
                        filtered = filtered.filter(p => p.type && p.type.includes(args.type));
                    }
                    if (args.maxPrice) {
                        filtered = filtered.filter(p => p.price <= args.maxPrice);
                    }
                    if (args.minPrice) {
                        filtered = filtered.filter(p => p.price >= args.minPrice);
                    }

                    // ============================================
                    // 🧠 SMART NEAREST MATCH FALLBACK SYSTEM
                    // ============================================
                    if (filtered.length === 0) {
                        console.log('🔍 No exact match. Activating Smart Fallback...');

                        // Location similarity map (nearby areas)
                        const locationProximity = {
                            'التجمع الخامس': ['مستقبل سيتي', 'العاصمة الادارية', 'الشروق', 'مدينتي'],
                            'New Cairo': ['مستقبل سيتي', 'العاصمة الادارية', 'الشروق', 'مدينتي'],
                            'القاهرة الجديدة': ['مستقبل سيتي', 'العاصمة الادارية', 'الشروق', 'مدينتي'],
                            'مستقبل سيتي': ['التجمع الخامس', 'العاصمة الادارية', 'القاهرة الجديدة'],
                            'Mostakbal City': ['التجمع الخامس', 'العاصمة الادارية', 'القاهرة الجديدة'],
                            'العاصمة الادارية': ['التجمع الخامس', 'مستقبل سيتي', 'بدر'],
                            'New Capital': ['التجمع الخامس', 'مستقبل سيتي', 'بدر'],
                            'أكتوبر': ['الشيخ زايد', 'حدائق أكتوبر', 'الحزام الأخضر'],
                            '6 October': ['الشيخ زايد', 'حدائق أكتوبر'],
                            'الشيخ زايد': ['أكتوبر', 'حدائق أكتوبر', 'الساحل'],
                            'Zayed': ['أكتوبر', 'حدائق أكتوبر'],
                            'الساحل': ['العلمين', 'مراسي', 'رأس الحكمة'],
                            'الساحل الشمالي': ['العلمين', 'مراسي', 'راس الحكمة'],
                            'North Coast': ['العلمين', 'مراسي', 'راس الحكمة'],
                            'العين السخنة': ['الجلالة', 'العاصمة الادارية', 'السويس']
                        };

                        // Type similarity map
                        const typeProximity = {
                            'شقة': ['استوديو', 'دوبلكس', 'بنتهاوس'],
                            'Apartment': ['استوديو', 'دوبلكس', 'بنتهاوس'],
                            'فيلا': ['تاون هاوس', 'توين هاوس', 'دوبلكس'],
                            'Villa': ['تاون هاوس', 'توين هاوس', 'دوبلكس'],
                            'تاون هاوس': ['فيلا', 'توين هاوس'],
                            'Townhouse': ['فيلا', 'توين هاوس'],
                            'توين هاوس': ['تاون هاوس', 'فيلا'],
                            'Twin House': ['تاون هاوس', 'فيلا'],
                            'دوبلكس': ['شقة', 'بنتهاوس', 'فيلا'],
                            'Duplex': ['شقة', 'بنتهاوس', 'فيلا']
                        };

                        // Fallback Strategy 1: Nearest Price (±30% range)
                        if (args.maxPrice || args.minPrice) {
                            const targetPrice = args.maxPrice || args.minPrice;
                            const priceRange = targetPrice * 0.3; // 30% flexibility

                            let nearestByPrice = allProps
                                .map(p => ({ ...p, priceDiff: Math.abs(p.price - targetPrice) }))
                                .sort((a, b) => a.priceDiff - b.priceDiff)
                                .slice(0, 5);

                            // Apply location filter if specified
                            if (args.location) {
                                const locMatches = nearestByPrice.filter(p =>
                                    p.location.includes(args.location) ||
                                    (p.description && p.description.includes(args.location))
                                );
                                if (locMatches.length > 0) nearestByPrice = locMatches;
                            }

                            if (nearestByPrice.length > 0) {
                                filtered = nearestByPrice;
                                const nearestPrice = (nearestByPrice[0].price / 1000000).toFixed(1);
                                fallbackUsed = `💡 مفيش عقار بالضبط بسعر ${(targetPrice / 1000000).toFixed(1)} مليون. أقرب سعر متاح: ${nearestPrice} مليون`;
                            }
                        }

                        // Fallback Strategy 2: Similar Location
                        if (filtered.length === 0 && args.location) {
                            const nearbyLocations = locationProximity[args.location] || [];

                            for (const nearLoc of nearbyLocations) {
                                let nearby = allProps.filter(p =>
                                    p.location.includes(nearLoc) ||
                                    (p.description && p.description.includes(nearLoc))
                                );

                                // Apply price filter if specified
                                if (args.maxPrice) {
                                    nearby = nearby.filter(p => p.price <= args.maxPrice * 1.2); // 20% flexibility
                                }

                                if (nearby.length > 0) {
                                    filtered = nearby.slice(0, 5);
                                    fallbackUsed = `💡 مفيش عقارات في "${args.location}" حالياً. بس لقيت عقارات في "${nearLoc}" (منطقة قريبة)`;
                                    break;
                                }
                            }
                        }

                        // Fallback Strategy 3: Similar Property Type
                        if (filtered.length === 0 && args.type) {
                            const similarTypes = typeProximity[args.type] || [];

                            for (const simType of similarTypes) {
                                let similar = allProps.filter(p => p.type && p.type.includes(simType));

                                if (args.location) {
                                    const locMatches = similar.filter(p =>
                                        p.location.includes(args.location) ||
                                        (p.description && p.description.includes(args.location))
                                    );
                                    if (locMatches.length > 0) similar = locMatches;
                                }

                                if (similar.length > 0) {
                                    filtered = similar.slice(0, 5);
                                    fallbackUsed = `💡 مفيش "${args.type}" متاحة. بس لقيت "${simType}" (نوع مشابه)`;
                                    break;
                                }
                            }
                        }

                        // Fallback Strategy 4: Show top properties by ROI if all else fails
                        if (filtered.length === 0) {
                            filtered = allProps
                                .sort((a, b) => (b.roi || 0) - (a.roi || 0))
                                .slice(0, 5);
                            fallbackUsed = `💡 مفيش نتايج بالمواصفات دي. بس دي أفضل 5 عقارات عندنا من حيث العائد!`;
                        }
                    }

                    // Render in main grid
                    renderProperties(filtered);

                    // ✨ VISUAL AGENT: Render cards in chat
                    if (filtered.length > 0) {
                        renderChatCards(filtered);
                    }

                    // Build response message
                    let responseMsg = `🏠 لقيت ${filtered.length} عقار يناسب طلبك! شوف الكروت فوق 👆`;
                    if (fallbackUsed) {
                        responseMsg = `${fallbackUsed}\n\n🏠 لقيتلك ${filtered.length} بديل ممتاز! شوف الكروت فوق 👆`;
                    }

                    return responseMsg;
                },

                // Tool 2: ROI Calculator Population
                calculateROI: (args) => {
                    console.log('🧮 ROI Tool executing:', args);
                    document.getElementById('propertyPrice').value = args.price;
                    document.getElementById('rentalIncome').value = args.rent || (args.price * 0.08); // Estimate 8% if missing
                    document.getElementById('appreciationRate').value = 15; // Optimistic default

                    // Scroll to calculator
                    document.getElementById('roiCalculator').scrollIntoView({ behavior: 'smooth' });

                    // Trigger calculation if function exists
                    if (window.calculateROI) window.calculateROI();

                    return `فتحتلك حاسبة العائد! وكتبتلك سعر العقار (${args.price.toLocaleString()} جم). بص على النتيجة تحت 👇`;
                },

                // Tool 3: Theme Control
                changeTheme: (args) => {
                    console.log('🎨 Theme Tool executing:', args);
                    if (args.mode === 'dark' || args.mode === 'light') {
                        document.documentElement.setAttribute('data-theme', args.mode);
                        localStorage.setItem('theme', args.mode);
                        return `تم تغيير الثيم لـ ${args.mode === 'dark' ? 'الوضع الليلي 🌙' : 'الوضع النهاري ☀️'} بناءً على طلبك!`;
                    }
                },

                // ============================================
                // 🛠️ PHASE 3: ACTION TAKER TOOLS
                // ============================================

                // Tool 4: Property Comparison Engine
                compareProperties: (args) => {
                    console.log('📊 Comparison Tool executing:', args);
                    const ids = args.ids || [];
                    const allProps = window.egyptianData.properties;

                    // If no IDs provided, compare first 2-3 properties from last search
                    let propsToCompare = [];
                    if (ids.length > 0) {
                        propsToCompare = allProps.filter(p => ids.includes(p.id));
                    } else {
                        propsToCompare = allProps.slice(0, 3);
                    }

                    if (propsToCompare.length < 2) {
                        return 'محتاج عقارين على الأقل عشان أقارنهم! جرب تقولي "قارن بين أول اتنين"';
                    }

                    // Build comparison table
                    const chatContainer = document.getElementById('chatMessages');
                    const tableWrapper = document.createElement('div');
                    tableWrapper.className = 'message message-ai';
                    tableWrapper.style.maxWidth = '100%';

                    let tableHtml = `
                        <div class="comparison-table-wrapper">
                            <table class="comparison-table">
                                <thead>
                                    <tr>
                                        <th>المقارنة</th>
                                        ${propsToCompare.map(p => `<th>${p.compound}</th>`).join('')}
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>📍 الموقع</td>
                                        ${propsToCompare.map(p => `<td>${p.location}</td>`).join('')}
                                    </tr>
                                    <tr>
                                        <td>💰 السعر</td>
                                        ${propsToCompare.map(p => {
                        const price = (p.price / 1000000).toFixed(1);
                        const isLowest = p.price === Math.min(...propsToCompare.map(x => x.price));
                        return `<td class="${isLowest ? 'highlight' : ''}">${price}M جنيه</td>`;
                    }).join('')}
                                    </tr>
                                    <tr>
                                        <td>📐 المساحة</td>
                                        ${propsToCompare.map(p => `<td>${p.area || p.size || 150} م²</td>`).join('')}
                                    </tr>
                                    <tr>
                                        <td>🏠 النوع</td>
                                        ${propsToCompare.map(p => `<td>${p.type}</td>`).join('')}
                                    </tr>
                                    <tr>
                                        <td>📈 ROI</td>
                                        ${propsToCompare.map(p => {
                        const roi = p.roi || p.totalROI || 15;
                        const isHighest = roi === Math.max(...propsToCompare.map(x => x.roi || x.totalROI || 15));
                        return `<td class="${isHighest ? 'highlight' : ''}">${roi}%</td>`;
                    }).join('')}
                                    </tr>
                                    <tr>
                                        <td>💳 المقدم</td>
                                        ${propsToCompare.map(p => `<td>${p.paymentPlan?.downPayment || p.downPayment?.percent || 10}%</td>`).join('')}
                                    </tr>
                                    <tr>
                                        <td>🏗️ المطور</td>
                                        ${propsToCompare.map(p => `<td>${p.developer}</td>`).join('')}
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    `;

                    tableWrapper.innerHTML = tableHtml;
                    chatContainer.appendChild(tableWrapper);
                    chatContainer.scrollTop = chatContainer.scrollHeight;

                    return `📊 تمام! عملتلك مقارنة بين ${propsToCompare.length} عقارات. الأخضر = الأفضل في الفئة! 👆`;
                },

                // Tool 5: Viewing Scheduler
                scheduleViewing: (args) => {
                    console.log('📅 Schedule Tool executing:', args);
                    const propertyId = args.propertyId;
                    const prop = window.egyptianData.properties.find(p => p.id === propertyId) || window.egyptianData.properties[0];

                    // Create modal if not exists
                    let modal = document.getElementById('scheduleModal');
                    if (!modal) {
                        modal = document.createElement('div');
                        modal.id = 'scheduleModal';
                        modal.className = 'schedule-modal-overlay';
                        modal.innerHTML = `
                            <div class="schedule-modal">
                                <h3>📅 حجز معاينة</h3>
                                <p id="schedulePropertyName"></p>
                                <div class="schedule-form-group">
                                    <label>اسمك الكريم</label>
                                    <input type="text" id="scheduleUserName" placeholder="محمد أحمد">
                                </div>
                                <div class="schedule-form-group">
                                    <label>رقم الموبايل</label>
                                    <input type="tel" id="schedulePhone" placeholder="01xxxxxxxxx">
                                </div>
                                <div class="schedule-form-group">
                                    <label>التاريخ المفضل</label>
                                    <input type="date" id="scheduleDate">
                                </div>
                                <div class="schedule-form-group">
                                    <label>الوقت المفضل</label>
                                    <input type="time" id="scheduleTime" value="10:00">
                                </div>
                                <div class="schedule-btn-group">
                                    <button class="schedule-btn primary" onclick="confirmSchedule()">تأكيد الحجز</button>
                                    <button class="schedule-btn secondary" onclick="closeScheduleModal()">إلغاء</button>
                                </div>
                            </div>
                        `;
                        document.body.appendChild(modal);
                    }

                    // Set property name
                    document.getElementById('schedulePropertyName').textContent = `🏠 ${prop.compound} - ${prop.location}`;

                    // Set default date to tomorrow
                    const tomorrow = new Date();
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    document.getElementById('scheduleDate').value = tomorrow.toISOString().split('T')[0];

                    // Store property for confirmation
                    window.schedulingProperty = prop;

                    // Show modal
                    modal.classList.add('active');

                    return `📅 فتحتلك نموذج حجز المعاينة! املا البيانات وأنا هرتب الموضوع 👆`;
                },

                // Tool 6: WhatsApp Inquiry Drafter
                draftInquiry: (args) => {
                    console.log('📱 Inquiry Tool executing:', args);
                    const propertyId = args.propertyId;
                    const prop = window.egyptianData.properties.find(p => p.id === propertyId) || window.egyptianData.properties[0];

                    const priceMillion = (prop.price / 1000000).toFixed(1);
                    const message = `السلام عليكم،

أنا مهتم بالعقار التالي:
🏠 ${prop.compound}
📍 ${prop.location}
💰 السعر: ${priceMillion} مليون جنيه
📐 المساحة: ${prop.area || prop.size || 150} م²

أرجو التواصل معي لمزيد من التفاصيل.
شكراً لكم.`;

                    const whatsappUrl = `https://wa.me/201000000000?text=${encodeURIComponent(message)}`;

                    // Render inquiry card in chat
                    const chatContainer = document.getElementById('chatMessages');
                    const inquiryWrapper = document.createElement('div');
                    inquiryWrapper.className = 'message message-ai';
                    inquiryWrapper.style.maxWidth = '100%';

                    inquiryWrapper.innerHTML = `
                        <div class="inquiry-card">
                            <h4><i class="fab fa-whatsapp"></i> رسالة الاستفسار جاهزة!</h4>
                            <div class="message-preview">${message}</div>
                            <div class="action-btns">
                                <button class="action-btn whatsapp" onclick="window.open('${whatsappUrl}', '_blank')">
                                    <i class="fab fa-whatsapp"></i> إرسال واتساب
                                </button>
                                <button class="action-btn copy" onclick="copyInquiry(this, \`${message.replace(/`/g, "'")}\`)">
                                    📋 نسخ الرسالة
                                </button>
                            </div>
                        </div>
                    `;

                    chatContainer.appendChild(inquiryWrapper);
                    chatContainer.scrollTop = chatContainer.scrollHeight;

                    return `📱 جهزتلك رسالة واتساب محترفة! تقدر تبعتها مباشرة أو تنسخها 👆`;
                }
            };

            // Execute Tool Helper
            window.executeAiTool = (toolName, args) => {
                if (window.aiTools[toolName]) {
                    return window.aiTools[toolName](args);
                }
                return null;
            };

            // Phase 3: Schedule Modal Helpers
            window.confirmSchedule = function () {
                const name = document.getElementById('scheduleUserName').value;
                const phone = document.getElementById('schedulePhone').value;
                const date = document.getElementById('scheduleDate').value;
                const time = document.getElementById('scheduleTime').value;
                const prop = window.schedulingProperty;

                if (!name || !phone) {
                    alert('من فضلك ادخل اسمك ورقم الموبايل');
                    return;
                }

                // Close modal
                closeScheduleModal();

                // Show confirmation in chat
                const chatContainer = document.getElementById('chatMessages');
                const confirmMsg = document.createElement('div');
                confirmMsg.className = 'message message-ai';
                confirmMsg.innerHTML = `
                    <div class="message-bubble" style="background: linear-gradient(135deg, rgba(56, 161, 105, 0.1), rgba(56, 161, 105, 0.05)); border: 1px solid rgba(56, 161, 105, 0.2);">
                        <div style="font-size: 24px; margin-bottom: 8px;">✅</div>
                        <strong>تم حجز المعاينة بنجاح!</strong><br><br>
                        🏠 العقار: ${prop.compound}<br>
                        📅 التاريخ: ${date}<br>
                        ⏰ الوقت: ${time}<br>
                        👤 الاسم: ${name}<br>
                        📱 الموبايل: ${phone}<br><br>
                        <em>هنتواصل معاك قريب جداً لتأكيد الموعد! 🤝</em>
                    </div>
                `;
                chatContainer.appendChild(confirmMsg);
                chatContainer.scrollTop = chatContainer.scrollHeight;

                // Save to user profile
                if (window.userProfile) {
                    window.userProfile.name = name;
                    if (typeof saveUserProfile === 'function') saveUserProfile();
                }
            };

            window.closeScheduleModal = function () {
                const modal = document.getElementById('scheduleModal');
                if (modal) {
                    modal.classList.remove('active');
                }
            };

            // Phase 3: Copy Inquiry Helper
            window.copyInquiry = function (btn, text) {
                navigator.clipboard.writeText(text).then(() => {
                    const originalText = btn.innerHTML;
                    btn.innerHTML = '✅ تم النسخ!';
                    btn.style.background = 'rgba(56, 161, 105, 0.3)';
                    setTimeout(() => {
                        btn.innerHTML = originalText;
                        btn.style.background = '';
                    }, 2000);
                });
            };

            // Load saved preferences
            const savedTheme = localStorage.getItem('theme');
            const savedLanguage = localStorage.getItem('language');

            if (savedTheme === 'dark') {
                toggleTheme();
            }

            if (savedLanguage === 'en') {
                toggleLanguage();
            }

            // Initialize components
            initializeROICalculator();
            initializeCharts();

            // Add smooth scrolling
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });

            // Navigation Mapping
            const navMapping = {
                'home': '.hero-section',
                'properties': '.properties-section',
                'investment': '.roi-section',
                'analytics': '.market-insights',
                'about': '.features-section'
            };

            // Add navigation interactivity
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function () {
                    document.querySelectorAll('.nav-item').forEach(nav =>
                        nav.classList.remove('active'));
                    this.classList.add('active');

                    const key = this.getAttribute('data-translate');
                    if (navMapping[key]) {
                        const target = document.querySelector(navMapping[key]);
                        if (target) {
                            target.scrollIntoView({ behavior: 'smooth' });
                        }
                    }
                });
            });

            // Search tab functionality
            document.querySelectorAll('.search-tab').forEach(tab => {
                tab.addEventListener('click', function () {
                    document.querySelectorAll('.search-tab').forEach(t =>
                        t.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Property filter chips
            document.querySelectorAll('.chip').forEach(chip => {
                chip.addEventListener('click', function () {
                    this.classList.toggle('active');
                });
            });

            // Animated counters for stats
            const observerOptions = {
                threshold: 0.5,
                triggerOnce: true
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const target = entry.target;
                        const finalNumber = target.textContent;
                        const duration = 2000;
                        const increment = parseInt(finalNumber.replace(/[^\d]/g, '')) / (duration /
                            16);
                        let current = 0;

                        const counter = setInterval(() => {
                            current += increment;
                            if (current >= parseInt(finalNumber.replace(/[^\d]/g, ''))) {
                                target.textContent = finalNumber;
                                clearInterval(counter);
                            } else {
                                target.textContent = Math.floor(current).toLocaleString();
                            }
                        }, 16);
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.stat-number').forEach(stat => {
                observer.observe(stat);
            });

            // Smart Header Initialization
            function initSmartHeader() {
                let lastScroll = 0;
                const header = document.querySelector('.navigation');

                window.addEventListener('scroll', () => {
                    const currentScroll = window.pageYOffset;

                    // Add scrolled class for glass effect intensity
                    if (currentScroll > 50) {
                        header.classList.add('nav-scrolled');
                    } else {
                        header.classList.remove('nav-scrolled');
                    }

                    // Hide/Show logic
                    if (currentScroll <= 0) {
                        header.classList.remove('nav-hidden');
                        return;
                    }

                    if (currentScroll > lastScroll && !header.classList.contains('nav-hidden') && currentScroll > 100) {
                        // Scroll Down
                        header.classList.add('nav-hidden');
                    } else if (currentScroll < lastScroll && header.classList.contains('nav-hidden')) {
                        // Scroll Up
                        header.classList.remove('nav-hidden');
                    }

                    lastScroll = currentScroll;
                });
            }

            initSmartHeader();
        });
    </script>

    <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
    <!-- PRIVACY POLICY MODAL 📜 -->
    <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
    <div id="privacyModal" class="lead-modal" style="display: none;">
        <div class="lead-modal-overlay" onclick="closePrivacyModal()"></div>
        <div class="lead-modal-content" style="max-width: 700px;">
            <button class="lead-modal-close" onclick="closePrivacyModal()">×</button>

            <div class="lead-modal-header">
                <h2>📜 سياسة الخصوصية</h2>
                <p>Privacy Policy</p>
            </div>

            <div style="padding: 0 32px 32px; max-height: 60vh; overflow-y: auto; text-align: right; line-height: 1.8;">
                <h3 style="color: #2C3E50; margin-top: 0;">نحن نحترم خصوصيتك</h3>
                <p>في أصول (Osool)، نلتزم بحماية خصوصيتك. هذه السياسة توضح كيفية جمع واستخدام بياناتك الشخصية.</p>

                <h4 style="color: #2C3E50; margin-top: 20px;">البيانات التي نجمعها</h4>
                <ul style="margin-right: 20px;">
                    <li>الاسم ورقم الهاتف (عند تقديم طلب)</li>
                    <li>البريد الإلكتروني (اختياري)</li>
                    <li>تفضيلات البحث العقاري</li>
                    <li>بيانات استخدام المنصة (Google Analytics)</li>
                    <li>ملفات تعريف الارتباط (Cookies)</li>
                </ul>

                <h4 style="color: #2C3E50; margin-top: 20px;">كيف نستخدم بياناتك</h4>
                <ul style="margin-right: 20px;">
                    <li>التواصل معك بخصوص العقارات المناسبة</li>
                    <li>تحسين تجربتك على المنصة</li>
                    <li>إرسال تحديثات عن عقارات جديدة</li>
                    <li>تحليل وتحسين خدماتنا</li>
                </ul>

                <h4 style="color: #2C3E50; margin-top: 20px;">حقوقك</h4>
                <ul style="margin-right: 20px;">
                    <li>الوصول إلى بياناتك الشخصية</li>
                    <li>تصحيح أو حذف بياناتك</li>
                    <li>الاعتراض على معالجة بياناتك</li>
                    <li>إلغاء الاشتراك في الرسائل التسويقية</li>
                </ul>

                <h4 style="color: #2C3E50; margin-top: 20px;">الأمان</h4>
                <p>نستخدم تدابير أمنية متقدمة لحماية بياناتك من الوصول غير المصرح به.</p>

                <h4 style="color: #2C3E50; margin-top: 20px;">ملفات تعريف الارتباط (Cookies)</h4>
                <p>نستخدم Cookies لتحسين تجربتك. يمكنك تعطيلها من إعدادات المتصفح.</p>

                <p style="margin-top: 20px; font-size: 14px; color: #7f8c8d;">
                    آخر تحديث: ديسمبر 2025<br>
                    للاستفسارات: info@osool.com
                </p>
            </div>
        </div>
    </div>

    <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
    <!-- LEAD CAPTURE MODAL 📋 -->
    <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
    <div id="leadModal" class="lead-modal" style="display: none;">
        <div class="lead-modal-overlay" onclick="closeLeadModal()"></div>
        <div class="lead-modal-content">
            <button class="lead-modal-close" onclick="closeLeadModal()">×</button>

            <div class="lead-modal-header">
                <h2>🏠 خلينا نساعدك تلاقي بيت أحلامك</h2>
                <p>سيب بياناتك وهنتواصل معاك في أقرب وقت</p>
            </div>

            <form id="leadForm" class="lead-form">
                <div class="form-group">
                    <label>الاسم *</label>
                    <input type="text" id="leadName" placeholder="محمد أحمد" required>
                </div>

                <div class="form-group">
                    <label>رقم الواتساب *</label>
                    <input type="tel" id="leadPhone" placeholder="01xxxxxxxxx" required pattern="[0-9]{11}">
                </div>

                <div class="form-group">
                    <label>البريد الإلكتروني</label>
                    <input type="email" id="leadEmail" placeholder="example@email.com">
                </div>

                <div class="form-group">
                    <label>الميزانية التقريبية</label>
                    <select id="leadBudget">
                        <option value="">اختر الميزانية</option>
                        <option value="3-5M">3 - 5 مليون</option>
                        <option value="5-8M">5 - 8 مليون</option>
                        <option value="8-12M">8 - 12 مليون</option>
                        <option value="12M+">أكثر من 12 مليون</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ملاحظات إضافية</label>
                    <textarea id="leadNotes" placeholder="أي تفاصيل تحب تضيفها..." rows="3"></textarea>
                </div>

                <button type="submit" class="lead-submit-btn">
                    📤 إرسال الطلب
                </button>

                <p class="lead-privacy">
                    بالضغط على إرسال، أنت توافق على <a href="#"
                        onclick="event.preventDefault(); showPrivacyPolicy();">سياسة الخصوصية</a>
                </p>
            </form>

            <!-- Success State -->
            <div id="leadSuccess" class="lead-success" style="display: none;">
                <div class="success-icon">✅</div>
                <h3>تم إرسال طلبك بنجاح!</h3>
                <p>هنتواصل معاك في أقرب وقت عبر الواتساب أو البريد الإلكتروني</p>
                <button onclick="closeLeadModal()" class="success-btn">حسناً</button>
            </div>
        </div>
    </div>

    <style>
        /* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
        /* LEAD CAPTURE MODAL STYLES */
        /* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */

        .lead-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .lead-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
        }

        .lead-modal-content {
            position: relative;
            background: white;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .lead-modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: #f0f0f0;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s;
            z-index: 1;
        }

        .lead-modal-close:hover {
            background: #e0e0e0;
            transform: rotate(90deg);
        }

        .lead-modal-header {
            padding: 32px 32px 24px;
            text-align: center;
        }

        .lead-modal-header h2 {
            margin: 0 0 8px;
            color: #2C3E50;
            font-size: 24px;
        }

        .lead-modal-header p {
            margin: 0;
            color: #7f8c8d;
            font-size: 15px;
        }

        .lead-form {
            padding: 0 32px 32px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2C3E50;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            transition: border-color 0.2s;
            font-family: inherit;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .lead-submit-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .lead-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .lead-privacy {
            margin-top: 16px;
            text-align: center;
            font-size: 12px;
            color: #95a5a6;
        }

        .lead-success {
            padding: 48px 32px;
            text-align: center;
        }

        .success-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .lead-success h3 {
            margin: 0 0 12px;
            color: #27ae60;
            font-size: 22px;
        }

        .lead-success p {
            margin: 0 0 24px;
            color: #7f8c8d;
            font-size: 15px;
            line-height: 1.6;
        }

        .success-btn {
            padding: 12px 32px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .success-btn:hover {
            transform: translateY(-2px);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .lead-modal-content {
                max-width: 95%;
                margin: 20px;
            }

            .lead-modal-header {
                padding: 24px 20px 16px;
            }

            .lead-modal-header h2 {
                font-size: 20px;
            }

            .lead-form {
                padding: 0 20px 24px;
            }
        }
    </style>

    <script>
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // ANALYTICS EVENT TRACKING 📊
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

        // Track chat interactions
        window.trackChatEvent = function (action, label = '', value = {}) {
            if (typeof gtag !== 'undefined') {
                gtag('event', action, {
                    'event_category': 'Chat',
                    'event_label': label,
                    ...value
                });
                console.log('📊 Chat event:', action, label);
            }
        };

        // Track property interactions
        window.trackPropertyEvent = function (action, propertyId, propertyData = {}) {
            if (typeof gtag !== 'undefined') {
                gtag('event', action, {
                    'event_category': 'Property',
                    'event_label': propertyId,
                    'property_type': propertyData.type || '',
                    'property_location': propertyData.location || '',
                    'property_price': propertyData.price || 0,
                    'value': propertyData.price || 0
                });
                console.log('📊 Property event:', action, propertyId);
            }
        };

        // Track search/filter usage  
        window.trackSearchEvent = function (filterType, filterValue) {
            if (typeof gtag !== 'undefined') {
                gtag('event', 'search', {
                    'search_term': filterValue,
                    'filter_type': filterType
                });
                console.log('📊 Search event:', filterType, filterValue);
            }
        };

        // Track conversions (high-value actions)
        window.trackConversion = function (conversionType, value = {}) {
            if (typeof gtag !== 'undefined') {
                gtag('event', 'conversion', {
                    'event_category': 'Conversion',
                    'event_label': conversionType,
                    ...value
                });
                console.log('📊 Conversion:', conversionType);
            }
        };

        // Track errors
        window.trackError = function (errorType, errorMessage) {
            if (typeof gtag !== 'undefined') {
                gtag('event', 'exception', {
                    'description': `${errorType}: ${errorMessage}`,
                    'fatal': false
                });
                console.log('⚠️ Error tracked:', errorType);
            }
        };

        // Track user engagement milestones
        window.trackMilestone = function (milestone, data = {}) {
            if (typeof gtag !== 'undefined') {
                gtag('event', 'milestone', {
                    'event_category': 'Engagement',
                    'event_label': milestone,
                    ...data
                });
                console.log('🎯 Milestone:', milestone);
            }
        };

        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // LEAD CAPTURE SYSTEM
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

        // Lead engagement tracking
        let leadEngagement = {
            propertiesViewed: 0,
            chatMessages: 0,
            timeOnSite: 0,
            searchesUsed: 0,
            hasShownModal: false,
            startTime: Date.now()
        };

        // Track property views
        window.trackPropertyView = function (propertyId) {
            leadEngagement.propertiesViewed++;
            console.log('📊 Property viewed:', propertyId, '| Total views:', leadEngagement.propertiesViewed);
            checkLeadCaptureEligibility();
        };

        // Track chat engagement
        window.trackChatMessage = function () {
            leadEngagement.chatMessages++;
            checkLeadCaptureEligibility();
        };

        // Check if user is eligible for lead capture
        function checkLeadCaptureEligibility() {
            if (leadEngagement.hasShownModal || localStorage.getItem('lead_captured')) {
                return;
            }

            leadEngagement.timeOnSite = (Date.now() - leadEngagement.startTime) / 1000;

            const shouldShow =
                leadEngagement.propertiesViewed >= 3 ||
                (leadEngagement.chatMessages >= 5 && leadEngagement.timeOnSite > 120) ||
                (leadEngagement.timeOnSite > 180 && leadEngagement.propertiesViewed >= 2);

            if (shouldShow) {
                setTimeout(showLeadModal, 1000);
            }
        }

        // Show lead capture modal
        window.showLeadModal = function () {
            leadEngagement.hasShownModal = true;
            document.getElementById('leadModal').style.display = 'flex';
            console.log('📋 Lead modal shown');

            // Track modal shown
            trackMilestone('lead_modal_shown', {
                properties_viewed: leadEngagement.propertiesViewed,
                time_on_site: Math.round(leadEngagement.timeOnSite)
            });
        };

        // Close lead modal
        window.closeLeadModal = function () {
            document.getElementById('leadModal').style.display = 'none';

            // Track modal closed
            trackChatEvent('lead_modal_closed');
        };

        // Show Privacy Policy
        window.showPrivacyPolicy = function () {
            document.getElementById('privacyModal').style.display = 'flex';
            trackChatEvent('privacy_policy_viewed');
        };

        // Close Privacy Policy
        window.closePrivacyModal = function () {
            document.getElementById('privacyModal').style.display = 'none';
        };

        // Handle lead form submission
        document.addEventListener('DOMContentLoaded', function () {
            const leadForm = document.getElementById('leadForm');
            if (leadForm) {
                leadForm.addEventListener('submit', async function (e) {
                    e.preventDefault();

                    const leadData = {
                        name: document.getElementById('leadName').value,
                        phone: document.getElementById('leadPhone').value,
                        email: document.getElementById('leadEmail').value || '',
                        budget: document.getElementById('leadBudget').value || '',
                        notes: document.getElementById('leadNotes').value || '',
                        source: 'AI_Chatbot',
                        timestamp: new Date().toISOString(),
                        engagement: {
                            properties_viewed: leadEngagement.propertiesViewed,
                            chat_messages: leadEngagement.chatMessages,
                            time_on_site: Math.round(leadEngagement.timeOnSite)
                        },
                        user_preferences: window.userProfile || {}
                    };

                    // Save to localStorage
                    const leads = JSON.parse(localStorage.getItem('leads') || '[]');
                    leads.push(leadData);
                    localStorage.setItem('leads', JSON.stringify(leads));
                    localStorage.setItem('lead_captured', 'true');

                    // Track lead conversion (high-value event!)
                    trackConversion('generate_lead', {
                        'value': 100, // Estimated lead value
                        'currency': 'EGP',
                        'lead_budget': leadData.budget,
                        'lead_source': 'AI_Chatbot',
                        'properties_viewed': leadEngagement.propertiesViewed
                    });

                    // Show success message
                    document.querySelector('.lead-form').style.display = 'none';
                    document.getElementById('leadSuccess').style.display = 'block';

                    console.log('✅ Lead captured:', leadData);
                    console.log('📊 Total leads captured:', leads.length);
                });
            }
        });
    </script>
</body>

</html>